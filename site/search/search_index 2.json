{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Meng\u5c0f\u7fbd\u7684\u8bfb\u4e66\u7b14\u8bb0 \u8bfb\u4e66\u8ba9\u81ea\u5df1\u53d8\u5f97\u66f4\u5f3a \u4e66\u5377\u591a\u60c5\u4f3c\u6545\u4eba\uff0c\u6668\u660f\u5fe7\u4e50\u6bcf\u76f8\u4eb2\u3002 \u773c\u524d\u76f4\u4e0b\u4e09\u5343\u5b57\uff0c\u80f8\u6b21\u5168\u65e0\u4e00\u70b9\u5c18\u3002 \u6d3b\u6c34\u6e90\u6d41\u968f\u5904\u6ee1\uff0c\u4e1c\u98ce\u82b1\u67f3\u9010\u65f6\u65b0\u3002 \u91d1\u978d\u7389\u52d2\u5bfb\u82b3\u5ba2\uff0c\u672a\u4fe1\u6211\u5e90\u522b\u6709\u6625\u3002","title":"Home"},{"location":"#meng","text":"\u8bfb\u4e66\u8ba9\u81ea\u5df1\u53d8\u5f97\u66f4\u5f3a \u4e66\u5377\u591a\u60c5\u4f3c\u6545\u4eba\uff0c\u6668\u660f\u5fe7\u4e50\u6bcf\u76f8\u4eb2\u3002 \u773c\u524d\u76f4\u4e0b\u4e09\u5343\u5b57\uff0c\u80f8\u6b21\u5168\u65e0\u4e00\u70b9\u5c18\u3002 \u6d3b\u6c34\u6e90\u6d41\u968f\u5904\u6ee1\uff0c\u4e1c\u98ce\u82b1\u67f3\u9010\u65f6\u65b0\u3002 \u91d1\u978d\u7389\u52d2\u5bfb\u82b3\u5ba2\uff0c\u672a\u4fe1\u6211\u5e90\u522b\u6709\u6625\u3002","title":"Meng\u5c0f\u7fbd\u7684\u8bfb\u4e66\u7b14\u8bb0"},{"location":"Cache/%E5%A4%9A%E7%BA%A7%E7%BC%93%E5%AD%98/","text":"\u591a\u7ea7\u7f13\u5b58 \u591a\u7ea7\u7f13\u5b58\u901a\u7528\u7684\u8bbe\u8ba1\u539f\u5219\uff1a\u53d8\u66f4\u5df2\u5206\u5e03\u5f0f\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u4e3a\u51c6\uff0c\u8bbf\u95ee\u4ee5\u8fdb\u7a0b\u5185\u7684\u7f13\u5b58\u7684\u6570\u636e\u4f18\u5148\u3002 \u7f13\u5b58\u98ce\u9669\u53ca\u5e94\u5bf9\u63aa\u65bd \u7f13\u5b58\u7a7f\u900f \u5bf9\u4e8e\u4e1a\u52a1\u903b\u8f91\u4e2d\u672c\u8eab\u5c31\u4e0d\u80fd\u907f\u514d\u7684\u7f13\u5b58\u7a7f\u900f \uff1a\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\uff0c\u5c06\u8fd4\u56de\u4e3a\u7a7a\u7684 key \u7ee7\u7eed\u8fdb\u884c\u7f13\u5b58\uff0c\u6548\u679c\u662f\u7f13\u5b58\u6700\u591a\u88ab\u7a7f\u900f\u4e00\u6b21\uff1b \u5bf9\u4e8e\u6076\u610f\u653b\u51fb\u5bfc\u81f4\u7684\u7f13\u5b58\u7a7f\u900f \uff1a\u8bbe\u7f6e\u5e03\u9686\u8fc7\u6ee4\u5668\uff08\u7b80\u5355\u6765\u8bb2\u5c31\u662f\u8bbe\u7f6e\u8bf7\u6c42\u96c6\u5408\u5339\u914d\uff09\u3002 \u7f13\u5b58\u51fb\u7a7f \u52a0\u9501\u540c\u6b65 \uff1a\u4ee5\u8bf7\u6c42\u8be5\u6570\u636e\u7684 Key \u503c\u4e3a\u9501\uff0c\u53ea\u5c06\u7b2c\u4e00\u6b21\u51fa\u73b0\u51fb\u7a7f\u7684\u4e8b\u4ef6\u8bf7\u6c42\u5230\u6570\u636e\u6e90\u4e2d\u53bb\uff0c\u4e4b\u540e\u66f4\u65b0\u7f13\u5b58\u540e\u518d\u83b7\u53d6\u5bf9\u5e94\u7684\u7f13\u5b58\u6570\u636e\uff1b \u70ed\u70b9\u6570\u636e\u8fdb\u884c\u81ea\u52a8\u5316\u66f4\u65b0 \uff1a\u5bf9\u7f13\u5b58\u8fdb\u884c\u52a8\u6001\u7684\u68c0\u6d4b\u5931\u6548\u53ca\u66f4\u65b0\uff0c\u505a\u5230\u81ea\u52a8\u5316\u7ba1\u7406\u7f13\u5b58\u3002 \u7f13\u5b58\u96ea\u5d29 \u63d0\u5347\u7f13\u5b58\u7cfb\u7edf\u53ef\u7528\u6027\uff0c\u5efa\u8bbe\u5206\u5e03\u5f0f\u7f13\u5b58\u7684\u96c6\u7fa4\uff1b \u542f\u7528\u900f\u660e\u591a\u7ea7\u7f13\u5b58\uff0c\u5404\u4e2a\u670d\u52a1\u8282\u70b9\u7684\u4e00\u7ea7\u7f13\u5b58\u4e2d\u7684\u6570\u636e\uff0c\u901a\u5e38\u4f1a\u5177\u6709\u4e0d\u4e00\u6837\u7684\u52a0\u8f7d\u65f6\u95f4\uff0c\u8fd9\u6837\u505a\u4e5f\u5c31\u5206\u6563\u4e86\u5b83\u4eec\u7684\u8fc7\u671f\u65f6\u95f4\uff1b \u5c06\u7f13\u5b58\u7684\u751f\u5b58\u671f\u4ece\u56fa\u5b9a\u65f6\u95f4\u6539\u4e3a\u4e00\u4e2a\u65f6\u95f4\u6bb5\u5185\u7684\u968f\u673a\u65f6\u95f4\u3002 \u7f13\u5b58\u6c61\u67d3 \u7f13\u5b58\u6c61\u67d3\u591a\u6570\u662f\u56e0\u4e3a\u5f00\u53d1\u8005\u66f4\u65b0\u7f13\u5b58\u4e0d\u89c4\u8303\u9020\u6210\u7684\u3002\u3002\u3002\u3002 Cache Aside \u6a21\u5f0f \u8bfb\u6570\u636e\u65f6\uff0c\u5148\u8bfb\u7f13\u5b58\uff0c\u7f13\u5b58\u6ca1\u6709\u7684\u8bdd\uff0c\u518d\u8bfb\u6570\u636e\u6e90\uff0c\u7136\u540e\u5c06\u6570\u636e\u653e\u5165\u7f13\u5b58\uff0c\u518d\u54cd\u5e94\u8bf7\u6c42\u3002 \u5199\u6570\u636e\u65f6\uff0c\u5148\u5199\u6570\u636e\u6e90\uff0c\u7136\u540e\u5931\u6548\uff08\u800c\u4e0d\u662f\u66f4\u65b0\uff09\u6389\u7f13\u5b58\u3002","title":"\u591a\u7ea7\u7f13\u5b58"},{"location":"Cache/%E5%A4%9A%E7%BA%A7%E7%BC%93%E5%AD%98/#_1","text":"\u591a\u7ea7\u7f13\u5b58\u901a\u7528\u7684\u8bbe\u8ba1\u539f\u5219\uff1a\u53d8\u66f4\u5df2\u5206\u5e03\u5f0f\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u4e3a\u51c6\uff0c\u8bbf\u95ee\u4ee5\u8fdb\u7a0b\u5185\u7684\u7f13\u5b58\u7684\u6570\u636e\u4f18\u5148\u3002","title":"\u591a\u7ea7\u7f13\u5b58"},{"location":"Cache/%E5%A4%9A%E7%BA%A7%E7%BC%93%E5%AD%98/#_2","text":"\u7f13\u5b58\u7a7f\u900f \u5bf9\u4e8e\u4e1a\u52a1\u903b\u8f91\u4e2d\u672c\u8eab\u5c31\u4e0d\u80fd\u907f\u514d\u7684\u7f13\u5b58\u7a7f\u900f \uff1a\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\uff0c\u5c06\u8fd4\u56de\u4e3a\u7a7a\u7684 key \u7ee7\u7eed\u8fdb\u884c\u7f13\u5b58\uff0c\u6548\u679c\u662f\u7f13\u5b58\u6700\u591a\u88ab\u7a7f\u900f\u4e00\u6b21\uff1b \u5bf9\u4e8e\u6076\u610f\u653b\u51fb\u5bfc\u81f4\u7684\u7f13\u5b58\u7a7f\u900f \uff1a\u8bbe\u7f6e\u5e03\u9686\u8fc7\u6ee4\u5668\uff08\u7b80\u5355\u6765\u8bb2\u5c31\u662f\u8bbe\u7f6e\u8bf7\u6c42\u96c6\u5408\u5339\u914d\uff09\u3002 \u7f13\u5b58\u51fb\u7a7f \u52a0\u9501\u540c\u6b65 \uff1a\u4ee5\u8bf7\u6c42\u8be5\u6570\u636e\u7684 Key \u503c\u4e3a\u9501\uff0c\u53ea\u5c06\u7b2c\u4e00\u6b21\u51fa\u73b0\u51fb\u7a7f\u7684\u4e8b\u4ef6\u8bf7\u6c42\u5230\u6570\u636e\u6e90\u4e2d\u53bb\uff0c\u4e4b\u540e\u66f4\u65b0\u7f13\u5b58\u540e\u518d\u83b7\u53d6\u5bf9\u5e94\u7684\u7f13\u5b58\u6570\u636e\uff1b \u70ed\u70b9\u6570\u636e\u8fdb\u884c\u81ea\u52a8\u5316\u66f4\u65b0 \uff1a\u5bf9\u7f13\u5b58\u8fdb\u884c\u52a8\u6001\u7684\u68c0\u6d4b\u5931\u6548\u53ca\u66f4\u65b0\uff0c\u505a\u5230\u81ea\u52a8\u5316\u7ba1\u7406\u7f13\u5b58\u3002 \u7f13\u5b58\u96ea\u5d29 \u63d0\u5347\u7f13\u5b58\u7cfb\u7edf\u53ef\u7528\u6027\uff0c\u5efa\u8bbe\u5206\u5e03\u5f0f\u7f13\u5b58\u7684\u96c6\u7fa4\uff1b \u542f\u7528\u900f\u660e\u591a\u7ea7\u7f13\u5b58\uff0c\u5404\u4e2a\u670d\u52a1\u8282\u70b9\u7684\u4e00\u7ea7\u7f13\u5b58\u4e2d\u7684\u6570\u636e\uff0c\u901a\u5e38\u4f1a\u5177\u6709\u4e0d\u4e00\u6837\u7684\u52a0\u8f7d\u65f6\u95f4\uff0c\u8fd9\u6837\u505a\u4e5f\u5c31\u5206\u6563\u4e86\u5b83\u4eec\u7684\u8fc7\u671f\u65f6\u95f4\uff1b \u5c06\u7f13\u5b58\u7684\u751f\u5b58\u671f\u4ece\u56fa\u5b9a\u65f6\u95f4\u6539\u4e3a\u4e00\u4e2a\u65f6\u95f4\u6bb5\u5185\u7684\u968f\u673a\u65f6\u95f4\u3002 \u7f13\u5b58\u6c61\u67d3 \u7f13\u5b58\u6c61\u67d3\u591a\u6570\u662f\u56e0\u4e3a\u5f00\u53d1\u8005\u66f4\u65b0\u7f13\u5b58\u4e0d\u89c4\u8303\u9020\u6210\u7684\u3002\u3002\u3002\u3002 Cache Aside \u6a21\u5f0f \u8bfb\u6570\u636e\u65f6\uff0c\u5148\u8bfb\u7f13\u5b58\uff0c\u7f13\u5b58\u6ca1\u6709\u7684\u8bdd\uff0c\u518d\u8bfb\u6570\u636e\u6e90\uff0c\u7136\u540e\u5c06\u6570\u636e\u653e\u5165\u7f13\u5b58\uff0c\u518d\u54cd\u5e94\u8bf7\u6c42\u3002 \u5199\u6570\u636e\u65f6\uff0c\u5148\u5199\u6570\u636e\u6e90\uff0c\u7136\u540e\u5931\u6548\uff08\u800c\u4e0d\u662f\u66f4\u65b0\uff09\u6389\u7f13\u5b58\u3002","title":"\u7f13\u5b58\u98ce\u9669\u53ca\u5e94\u5bf9\u63aa\u65bd"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/","text":"\u5b9a\u65f6\u4efb\u52a1 Cron \u4efb\u52a1\u5b9a\u4e49 // \u5b9a\u65f6\u4efb\u52a1 type Cron struct { entries []*Entry // \u4efb\u52a1\u4e0a\u4e0b\u6587\u6570\u7ec4 chain Chain // \u4efb\u52a1\u88c5\u9970\uff0c\u600e\u4e48\u8ba9\u4efb\u52a1\u53bb\u6267\u884c stop chan struct{} // \u505c\u6b62\u4efb\u52a1\u4fe1\u53f7 add chan *Entry // \u6dfb\u52a0\u4efb\u52a1\u4fe1\u53f7 remove chan EntryID // \u79fb\u9664\u4efb\u52a1\u4fe1\u53f7 snapshot chan chan []Entry // \u4efb\u52a1\u5feb\u7167 running bool // \u662f\u5426\u5728\u8fd0\u884c logger Logger // \u4efb\u52a1\u65e5\u5fd7 runningMu sync.Mutex // \u4e92\u65a5\u9501 location *time.Location // \u5f53\u524d\u65f6\u95f4 parser ScheduleParser // \u89e3\u6790\u5668 nextID EntryID // \u4e0b\u4e00\u4e2a\u4efb\u52a1 ID jobWaiter sync.WaitGroup // \u4f18\u96c5\u9000\u51fa } \u4efb\u52a1\u4e0a\u4e0b\u6587\u6570\u7ec4 // \u4efb\u52a1\u4e0a\u4e0b\u6587\u6570\u7ec4 type Entry struct { ID EntryID // \u4efb\u52a1ID Schedule Schedule // \u8fdb\u5ea6\u8868 Next time.Time // \u4e0b\u4e00\u6b21\u5b9a\u65f6\u4efb\u52a1\u8fd0\u884c\u65f6\u95f4 Prev time.Time // \u6700\u540e\u4e00\u6b21\u8fd0\u884c\u4efb\u52a1\u7684\u65f6\u95f4 WrappedJob Job // \u5f53\u8ba1\u5212\u88ab\u6fc0\u6d3b\u662f\u8981\u8dd1\u7684\u4efb\u52a1 \u4fee\u9970\u4efb\u52a1 Job Job // \u7528\u6237\u672c\u8eab\u4efb\u52a1 } \u6267\u884c\u6d41\u7a0b func (c *Cron) run() { c.logger.Info(\"start\") // \u4e3a\u6bcf\u4e2a\u4efb\u52a1\u8ba1\u7b97\u4e0b\u4e00\u4e2a\u6fc0\u6d3b\u65f6\u95f4\u3002 now := c.now() for _, entry := range c.entries { entry.Next = entry.Schedule.Next(now) c.logger.Info(\"schedule\", \"now\", now, \"entry\", entry.ID, \"next\", entry.Next) } for { // \u786e\u5b9a\u8981\u8fd0\u884c\u7684\u4e0b\u4e00\u4e2a\u4efb\u52a1 sort.Sort(byTime(c.entries)) var timer *time.Timer if len(c.entries) == 0 || c.entries[0].Next.IsZero() { // \u5982\u679c\u8fd8\u6ca1\u6709\u6761\u76ee\uff0c\u53ea\u9700\u7761\u7720-\u5b83\u4ecd\u7136\u5904\u7406\u65b0\u6761\u76ee \u548c \u505c\u6b62\u8bf7\u6c42 timer = time.NewTimer(100000 * time.Hour) } else { // Sub \u5b50\u8fd4\u56de\u6301\u7eed\u65f6\u95f4\u5982\u679c\u7ed3\u679c\u8d85\u8fc7\u4e86\u53ef\u4ee5\u5b58\u50a8\u5728\u4e00\u4e2a\u6301\u7eed\u65f6\u95f4\u5185\u7684\u6700\u5927\u503c\uff08\u6216\u6700\u5c0f\u503c\uff09\uff0c\u5219\u5c06\u8fd4\u56de\u6700\u5927\uff08\u6216\u6700\u5c0f\uff09\u6301\u7eed\u65f6\u95f4\u3002 // \u8981\u8ba1\u7b97t-d\u7684\u6301\u7eed\u65f6\u95f4d\uff0c\u4f7f\u7528t\u3002\u6dfb\u52a0\uff08-D\uff09\u3002 timer = time.NewTimer(c.entries[0].Next.Sub(now)) } for { select { case now = <-timer.C: now = now.In(c.location) c.logger.Info(\"wake\", \"now\", now) // Run every entry whose next time was less than now for _, e := range c.entries { // \u96f6\u5ea6\u62a5\u544a\u662f\u5426\u4ee3\u8868\u96f6\u65f6\u95f4\u77ac\u95f4\uff0c if e.Next.After(now) || e.Next.IsZero() { break } // \u5f00\u542f\u4efb\u52a1 \u5c01\u88c5\u597d\u7684\u6267\u884c\u4efb\u52a1 c.startJob(e.WrappedJob) // \u5c06\u5199\u4e00\u4e2a\u4efb\u52a1\u653e\u5165\u4e0a\u4e0b\u6587 e.Prev = e.Next e.Next = e.Schedule.Next(now) c.logger.Info(\"run\", \"now\", now, \"entry\", e.ID, \"next\", e.Next) } break } } } // \u5f00\u542f\u4e00\u4e2a\u65b0\u7684 gourtine \u6267\u884c\u4efb\u52a1 func (c *Cron) startJob(j Job) { c.jobWaiter.Add(1) go func() { defer c.jobWaiter.Done() j.Run() }() } type Job interface { Run() } \u65f6\u95f4\u89c4\u5219 \u4e0eLinux \u4e2d crontab \u547d\u4ee4\u76f8\u4f3c\uff0c cron \u5e93\u652f\u6301\u7528 5 \u4e2a\u7a7a\u683c\u5206\u9694\u7684\u57df\u6765\u8868\u793a\u65f6\u95f4\u3002\u8fd9 5 \u4e2a\u57df\u542b\u4e49\u4f9d\u6b21\u4e3a\uff1a Minutes \uff1a\u5206\u949f\uff0c\u53d6\u503c\u8303\u56f4 [0-59] \uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26 * / , - \uff1b Hours \uff1a\u5c0f\u65f6\uff0c\u53d6\u503c\u8303\u56f4 [0-23] \uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26 * / , - \uff1b Day of month \uff1a\u6bcf\u6708\u7684\u7b2c\u51e0\u5929\uff0c\u53d6\u503c\u8303\u56f4 [1-31] \uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26 * / , - ? \uff1b Month \uff1a\u6708\uff0c\u53d6\u503c\u8303\u56f4 [1-12] \u6216\u8005\u4f7f\u7528\u6708\u4efd\u540d\u5b57\u7f29\u5199 [JAN-DEC] \uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26 * / , - \uff1b Day of week \uff1a\u5468\u5386\uff0c\u53d6\u503c\u8303\u56f4 [0-6] \u6216\u540d\u5b57\u7f29\u5199 [JUN-SAT] \uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26 * / , - ? \u3002 \u7279\u6b8a\u5b57\u7b26\u542b\u4e49\u5982\u4e0b\uff1a * \uff1a\u4f7f\u7528 * \u7684\u57df\u53ef\u4ee5\u5339\u914d\u4efb\u4f55\u503c\uff0c\u4f8b\u5982\u5c06\u6708\u4efd\u57df\uff08\u7b2c 4 \u4e2a\uff09\u8bbe\u7f6e\u4e3a * \uff0c\u8868\u793a\u6bcf\u4e2a\u6708\uff1b / \uff1a\u7528\u6765\u6307\u5b9a\u8303\u56f4\u7684 \u6b65\u957f \uff0c\u4f8b\u5982\u5c06\u5c0f\u65f6\u57df\uff08\u7b2c 2 \u4e2a\uff09\u8bbe\u7f6e\u4e3a 3-59/15 \u8868\u793a\u7b2c 3 \u5206\u949f\u89e6\u53d1\uff0c\u4ee5\u540e\u6bcf\u9694 15 \u5206\u949f\u89e6\u53d1\u4e00\u6b21\uff0c\u56e0\u6b64\u7b2c 2 \u6b21\u89e6\u53d1\u4e3a\u7b2c 18 \u5206\u949f\uff0c\u7b2c 3 \u6b21\u4e3a 33 \u5206\u949f\u3002\u3002\u3002\u76f4\u5230\u5206\u949f\u5927\u4e8e 59\uff1b , \uff1a\u7528\u6765\u5217\u4e3e\u4e00\u4e9b\u79bb\u6563\u7684\u503c\u548c\u591a\u4e2a\u8303\u56f4\uff0c\u4f8b\u5982\u5c06\u5468\u5386\u7684\u57df\uff08\u7b2c 5 \u4e2a\uff09\u8bbe\u7f6e\u4e3a MON,WED,FRI \u8868\u793a\u5468\u4e00\u3001\u4e09\u548c\u4e94\uff1b - \uff1a\u7528\u6765\u8868\u793a\u8303\u56f4\uff0c\u4f8b\u5982\u5c06\u5c0f\u65f6\u7684\u57df\uff08\u7b2c 1 \u4e2a\uff09\u8bbe\u7f6e\u4e3a 9-17 \u8868\u793a\u4e0a\u5348 9 \u70b9\u5230\u4e0b\u5348 17 \u70b9\uff08\u5305\u62ec 9 \u548c 17\uff09\uff1b ? \uff1a\u53ea\u80fd\u7528\u5728\u6708\u5386\u548c\u5468\u5386\u7684\u57df\u4e2d\uff0c\u7528\u6765\u4ee3\u66ff * \uff0c\u8868\u793a\u6bcf\u6708/\u5468\u7684\u4efb\u610f\u4e00\u5929\u3002 \u9884\u5b9a\u4e49\u65f6\u95f4\u89c4\u5219 @yearly \uff1a\u4e5f\u53ef\u4ee5\u5199\u4f5c @annually \uff0c\u8868\u793a\u6bcf\u5e74\u7b2c\u4e00\u5929\u7684 0 \u70b9\u3002\u7b49\u4ef7\u4e8e 0 0 1 1 * \uff1b @monthly \uff1a\u8868\u793a\u6bcf\u6708\u7b2c\u4e00\u5929\u7684 0 \u70b9\u3002\u7b49\u4ef7\u4e8e 0 0 1 * * \uff1b @weekly \uff1a\u8868\u793a\u6bcf\u5468\u7b2c\u4e00\u5929\u7684 0 \u70b9\uff0c\u6ce8\u610f\u7b2c\u4e00\u5929\u4e3a\u5468\u65e5\uff0c\u5373\u5468\u516d\u7ed3\u675f\uff0c\u5468\u65e5\u5f00\u59cb\u7684\u90a3\u4e2a 0 \u70b9\u3002\u7b49\u4ef7\u4e8e 0 0 * * 0 \uff1b @daily \uff1a\u4e5f\u53ef\u4ee5\u5199\u4f5c @midnight \uff0c\u8868\u793a\u6bcf\u5929 0 \u70b9\u3002\u7b49\u4ef7\u4e8e 0 0 * * * \uff1b @hourly \uff1a\u8868\u793a\u6bcf\u5c0f\u65f6\u7684\u5f00\u59cb\u3002\u7b49\u4ef7\u4e8e 0 * * * * \u3002 \u56fa\u5b9a\u65f6\u95f4\u89c4\u5219 @every <duration> \u65f6\u533a\u9009\u62e9 nyc, _ := time.LoadLocation(\"America/New_York\") c := cron.New(cron.WithLocation(nyc)) \u901a\u8fc7 time.loadLocation \u8bbe\u7f6e\u5f53\u524d\u65f6\u533a\uff0c\u5728\u542f\u52a8\u5b9a\u65f6\u5668\u7684\u65f6\u5019\u4f7f\u7528 cron.WithLocation() \u8bbe\u7f6e\u65f6\u533a\u65f6\u95f4\u3002 \u4efb\u52a1\u5305\u88c5 Recover func Recover(logger Logger) JobWrapper { return func(j Job) Job { return FuncJob(func() { defer func() { if r := recover(); r != nil { const size = 64 << 10 buf := make([]byte, size) buf = buf[:runtime.Stack(buf, false)] err, ok := r.(error) if !ok { err = fmt.Errorf(\"%v\", r) } logger.Error(err, \"panic\", \"stack\", \"...\\n\"+string(buf)) } }() j.Run() }) } } // \u5ef6\u8fdf\u4ecd\u7136\u8fd0\u884c // \u5e8f\u5217\u5316\u4f5c\u4e1a\uff0c\u5ef6\u8fdf\u540e\u7eed\u8fd0\u884c\u76f4\u5230 \u524d\u4e00\u4e2a\u662f\u5b8c\u6574\u7684\u3002\u4e00\u5206\u949f\u591a\u540e\u7684\u5de5\u4f5c \u6709\u5ef6\u8fdf\u767b\u5f55\u4fe1\u606f\u3002 func DelayIfStillRunning(logger Logger) JobWrapper { return func(j Job) Job { var mu sync.Mutex return FuncJob(func() { start := time.Now() mu.Lock() defer mu.Unlock() if dur := time.Since(start); dur > time.Minute { logger.Info(\"delay\", \"duration\", dur) } j.Run() }) } } // SkipifStillrunning \u5ef6\u8fdf\u8df3\u8fc7\u4e86\u4f5c\u4e1a\u8c03\u7528 // \u5982\u679c\u5148\u524d\u7684\u8c03\u7528\u4ecd\u5728\u8fd0\u884c\u3002\u5b83\u7684\u65e5\u5fd7\u8df3\u8fc7\u4e86\u7ed9\u5b9a\u7684Logger\u5728\u4fe1\u606f\u6c34\u5e73\u3002 func SkipIfStillRunning(logger Logger) JobWrapper { return func(j Job) Job { var ch = make(chan struct{}, 1) ch <- struct{}{} return FuncJob(func() { select { case v := <-ch: j.Run() ch <- v default: logger.Info(\"skip\") } }) } } \u6ce8\u610f DelayIfStillRunning \u4e0e SkipIfStillRunning \u662f\u6709\u672c\u8d28\u4e0a\u7684\u533a\u522b\u7684\uff0c\u524d\u8005 DelayIfStillRunning \u53ea\u8981\u65f6\u95f4\u8db3\u591f\u957f\uff0c\u6240\u6709\u7684\u4efb\u52a1\u90fd\u4f1a\u6309\u90e8\u5c31\u73ed\u5730\u5b8c\u6210\uff0c\u53ea\u662f\u53ef\u80fd\u524d\u4e00\u4e2a\u4efb\u52a1\u8017\u65f6\u8fc7\u957f\uff0c\u5bfc\u81f4\u540e\u4e00\u4e2a\u4efb\u52a1\u7684\u6267\u884c\u65f6\u95f4\u63a8\u8fdf\u4e86\u4e00\u70b9\u3002 SkipIfStillRunning \u4f1a\u8df3\u8fc7\u4e00\u4e9b\u6267\u884c\u3002 Recover \uff1a\u6355\u83b7\u5185\u90e8 Job \u4ea7\u751f\u7684 panic\uff1b DelayIfStillRunning \uff1a\u89e6\u53d1\u65f6\uff0c\u5982\u679c\u4e0a\u4e00\u6b21\u4efb\u52a1\u8fd8\u672a\u6267\u884c\u5b8c\u6210\uff08\u8017\u65f6\u592a\u957f\uff09\uff0c\u5219\u7b49\u5f85\u4e0a\u4e00\u6b21\u4efb\u52a1\u5b8c\u6210\u4e4b\u540e\u518d\u6267\u884c\uff1b SkipIfStillRunning \uff1a\u89e6\u53d1\u65f6\uff0c\u5982\u679c\u4e0a\u4e00\u6b21\u4efb\u52a1\u8fd8\u672a\u5b8c\u6210\uff0c\u5219\u8df3\u8fc7\u6b64\u6b21\u6267\u884c\u3002 Demo: func (d *delayJob) Run() { time.Sleep(2 * time.Second) d.count++ log.Printf(\"%d: hello world\\n\", d.count) } func main() { c := cron.New() _, _ = c.AddJob(\"@every 1s\", cron.NewChain(cron.SkipIfStillRunning(cron.DefaultLogger)).Then(&delayJob{})) c.Start() time.Sleep(10 * time.Second) } ~/go/src/GoWebDemo/studygolang/cron \ue0b0 \ue0a0 master \u271a \u25cf \ue0b0 go run demo.go 2020/09/04 16:16:03 1: hello world 2020/09/04 16:16:05 2: hello world 2020/09/04 16:16:08 3: hello world func (d *delayJob) Run() { time.Sleep(2 * time.Second) d.count++ log.Printf(\"%d: hello world\\n\", d.count) } func main() { c := cron.New() _, _ = c.AddJob(\"@every 1s\", cron.NewChain(cron.DelayIfStillRunning(cron.DefaultLogger)).Then(&delayJob{})) c.Start() time.Sleep(10 * time.Second) } ~/go/src/GoWebDemo/studygolang/cron \ue0b0 \ue0a0 master \u271a \u25cf \ue0b0 go run demo.go 2020/09/04 16:18:07 1: hello world 2020/09/04 16:18:09 2: hello world 2020/09/04 16:18:11 3: hello world 2020/09/04 16:18:13 4: hello world","title":"\u5b9a\u65f6\u4efb\u52a1 Cron"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/#cron","text":"","title":"\u5b9a\u65f6\u4efb\u52a1 Cron"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/#_1","text":"// \u5b9a\u65f6\u4efb\u52a1 type Cron struct { entries []*Entry // \u4efb\u52a1\u4e0a\u4e0b\u6587\u6570\u7ec4 chain Chain // \u4efb\u52a1\u88c5\u9970\uff0c\u600e\u4e48\u8ba9\u4efb\u52a1\u53bb\u6267\u884c stop chan struct{} // \u505c\u6b62\u4efb\u52a1\u4fe1\u53f7 add chan *Entry // \u6dfb\u52a0\u4efb\u52a1\u4fe1\u53f7 remove chan EntryID // \u79fb\u9664\u4efb\u52a1\u4fe1\u53f7 snapshot chan chan []Entry // \u4efb\u52a1\u5feb\u7167 running bool // \u662f\u5426\u5728\u8fd0\u884c logger Logger // \u4efb\u52a1\u65e5\u5fd7 runningMu sync.Mutex // \u4e92\u65a5\u9501 location *time.Location // \u5f53\u524d\u65f6\u95f4 parser ScheduleParser // \u89e3\u6790\u5668 nextID EntryID // \u4e0b\u4e00\u4e2a\u4efb\u52a1 ID jobWaiter sync.WaitGroup // \u4f18\u96c5\u9000\u51fa }","title":"\u4efb\u52a1\u5b9a\u4e49"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/#_2","text":"// \u4efb\u52a1\u4e0a\u4e0b\u6587\u6570\u7ec4 type Entry struct { ID EntryID // \u4efb\u52a1ID Schedule Schedule // \u8fdb\u5ea6\u8868 Next time.Time // \u4e0b\u4e00\u6b21\u5b9a\u65f6\u4efb\u52a1\u8fd0\u884c\u65f6\u95f4 Prev time.Time // \u6700\u540e\u4e00\u6b21\u8fd0\u884c\u4efb\u52a1\u7684\u65f6\u95f4 WrappedJob Job // \u5f53\u8ba1\u5212\u88ab\u6fc0\u6d3b\u662f\u8981\u8dd1\u7684\u4efb\u52a1 \u4fee\u9970\u4efb\u52a1 Job Job // \u7528\u6237\u672c\u8eab\u4efb\u52a1 }","title":"\u4efb\u52a1\u4e0a\u4e0b\u6587\u6570\u7ec4"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/#_3","text":"func (c *Cron) run() { c.logger.Info(\"start\") // \u4e3a\u6bcf\u4e2a\u4efb\u52a1\u8ba1\u7b97\u4e0b\u4e00\u4e2a\u6fc0\u6d3b\u65f6\u95f4\u3002 now := c.now() for _, entry := range c.entries { entry.Next = entry.Schedule.Next(now) c.logger.Info(\"schedule\", \"now\", now, \"entry\", entry.ID, \"next\", entry.Next) } for { // \u786e\u5b9a\u8981\u8fd0\u884c\u7684\u4e0b\u4e00\u4e2a\u4efb\u52a1 sort.Sort(byTime(c.entries)) var timer *time.Timer if len(c.entries) == 0 || c.entries[0].Next.IsZero() { // \u5982\u679c\u8fd8\u6ca1\u6709\u6761\u76ee\uff0c\u53ea\u9700\u7761\u7720-\u5b83\u4ecd\u7136\u5904\u7406\u65b0\u6761\u76ee \u548c \u505c\u6b62\u8bf7\u6c42 timer = time.NewTimer(100000 * time.Hour) } else { // Sub \u5b50\u8fd4\u56de\u6301\u7eed\u65f6\u95f4\u5982\u679c\u7ed3\u679c\u8d85\u8fc7\u4e86\u53ef\u4ee5\u5b58\u50a8\u5728\u4e00\u4e2a\u6301\u7eed\u65f6\u95f4\u5185\u7684\u6700\u5927\u503c\uff08\u6216\u6700\u5c0f\u503c\uff09\uff0c\u5219\u5c06\u8fd4\u56de\u6700\u5927\uff08\u6216\u6700\u5c0f\uff09\u6301\u7eed\u65f6\u95f4\u3002 // \u8981\u8ba1\u7b97t-d\u7684\u6301\u7eed\u65f6\u95f4d\uff0c\u4f7f\u7528t\u3002\u6dfb\u52a0\uff08-D\uff09\u3002 timer = time.NewTimer(c.entries[0].Next.Sub(now)) } for { select { case now = <-timer.C: now = now.In(c.location) c.logger.Info(\"wake\", \"now\", now) // Run every entry whose next time was less than now for _, e := range c.entries { // \u96f6\u5ea6\u62a5\u544a\u662f\u5426\u4ee3\u8868\u96f6\u65f6\u95f4\u77ac\u95f4\uff0c if e.Next.After(now) || e.Next.IsZero() { break } // \u5f00\u542f\u4efb\u52a1 \u5c01\u88c5\u597d\u7684\u6267\u884c\u4efb\u52a1 c.startJob(e.WrappedJob) // \u5c06\u5199\u4e00\u4e2a\u4efb\u52a1\u653e\u5165\u4e0a\u4e0b\u6587 e.Prev = e.Next e.Next = e.Schedule.Next(now) c.logger.Info(\"run\", \"now\", now, \"entry\", e.ID, \"next\", e.Next) } break } } } // \u5f00\u542f\u4e00\u4e2a\u65b0\u7684 gourtine \u6267\u884c\u4efb\u52a1 func (c *Cron) startJob(j Job) { c.jobWaiter.Add(1) go func() { defer c.jobWaiter.Done() j.Run() }() } type Job interface { Run() }","title":"\u6267\u884c\u6d41\u7a0b"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/#_4","text":"\u4e0eLinux \u4e2d crontab \u547d\u4ee4\u76f8\u4f3c\uff0c cron \u5e93\u652f\u6301\u7528 5 \u4e2a\u7a7a\u683c\u5206\u9694\u7684\u57df\u6765\u8868\u793a\u65f6\u95f4\u3002\u8fd9 5 \u4e2a\u57df\u542b\u4e49\u4f9d\u6b21\u4e3a\uff1a Minutes \uff1a\u5206\u949f\uff0c\u53d6\u503c\u8303\u56f4 [0-59] \uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26 * / , - \uff1b Hours \uff1a\u5c0f\u65f6\uff0c\u53d6\u503c\u8303\u56f4 [0-23] \uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26 * / , - \uff1b Day of month \uff1a\u6bcf\u6708\u7684\u7b2c\u51e0\u5929\uff0c\u53d6\u503c\u8303\u56f4 [1-31] \uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26 * / , - ? \uff1b Month \uff1a\u6708\uff0c\u53d6\u503c\u8303\u56f4 [1-12] \u6216\u8005\u4f7f\u7528\u6708\u4efd\u540d\u5b57\u7f29\u5199 [JAN-DEC] \uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26 * / , - \uff1b Day of week \uff1a\u5468\u5386\uff0c\u53d6\u503c\u8303\u56f4 [0-6] \u6216\u540d\u5b57\u7f29\u5199 [JUN-SAT] \uff0c\u652f\u6301\u7279\u6b8a\u5b57\u7b26 * / , - ? \u3002 \u7279\u6b8a\u5b57\u7b26\u542b\u4e49\u5982\u4e0b\uff1a * \uff1a\u4f7f\u7528 * \u7684\u57df\u53ef\u4ee5\u5339\u914d\u4efb\u4f55\u503c\uff0c\u4f8b\u5982\u5c06\u6708\u4efd\u57df\uff08\u7b2c 4 \u4e2a\uff09\u8bbe\u7f6e\u4e3a * \uff0c\u8868\u793a\u6bcf\u4e2a\u6708\uff1b / \uff1a\u7528\u6765\u6307\u5b9a\u8303\u56f4\u7684 \u6b65\u957f \uff0c\u4f8b\u5982\u5c06\u5c0f\u65f6\u57df\uff08\u7b2c 2 \u4e2a\uff09\u8bbe\u7f6e\u4e3a 3-59/15 \u8868\u793a\u7b2c 3 \u5206\u949f\u89e6\u53d1\uff0c\u4ee5\u540e\u6bcf\u9694 15 \u5206\u949f\u89e6\u53d1\u4e00\u6b21\uff0c\u56e0\u6b64\u7b2c 2 \u6b21\u89e6\u53d1\u4e3a\u7b2c 18 \u5206\u949f\uff0c\u7b2c 3 \u6b21\u4e3a 33 \u5206\u949f\u3002\u3002\u3002\u76f4\u5230\u5206\u949f\u5927\u4e8e 59\uff1b , \uff1a\u7528\u6765\u5217\u4e3e\u4e00\u4e9b\u79bb\u6563\u7684\u503c\u548c\u591a\u4e2a\u8303\u56f4\uff0c\u4f8b\u5982\u5c06\u5468\u5386\u7684\u57df\uff08\u7b2c 5 \u4e2a\uff09\u8bbe\u7f6e\u4e3a MON,WED,FRI \u8868\u793a\u5468\u4e00\u3001\u4e09\u548c\u4e94\uff1b - \uff1a\u7528\u6765\u8868\u793a\u8303\u56f4\uff0c\u4f8b\u5982\u5c06\u5c0f\u65f6\u7684\u57df\uff08\u7b2c 1 \u4e2a\uff09\u8bbe\u7f6e\u4e3a 9-17 \u8868\u793a\u4e0a\u5348 9 \u70b9\u5230\u4e0b\u5348 17 \u70b9\uff08\u5305\u62ec 9 \u548c 17\uff09\uff1b ? \uff1a\u53ea\u80fd\u7528\u5728\u6708\u5386\u548c\u5468\u5386\u7684\u57df\u4e2d\uff0c\u7528\u6765\u4ee3\u66ff * \uff0c\u8868\u793a\u6bcf\u6708/\u5468\u7684\u4efb\u610f\u4e00\u5929\u3002","title":"\u65f6\u95f4\u89c4\u5219"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/#_5","text":"@yearly \uff1a\u4e5f\u53ef\u4ee5\u5199\u4f5c @annually \uff0c\u8868\u793a\u6bcf\u5e74\u7b2c\u4e00\u5929\u7684 0 \u70b9\u3002\u7b49\u4ef7\u4e8e 0 0 1 1 * \uff1b @monthly \uff1a\u8868\u793a\u6bcf\u6708\u7b2c\u4e00\u5929\u7684 0 \u70b9\u3002\u7b49\u4ef7\u4e8e 0 0 1 * * \uff1b @weekly \uff1a\u8868\u793a\u6bcf\u5468\u7b2c\u4e00\u5929\u7684 0 \u70b9\uff0c\u6ce8\u610f\u7b2c\u4e00\u5929\u4e3a\u5468\u65e5\uff0c\u5373\u5468\u516d\u7ed3\u675f\uff0c\u5468\u65e5\u5f00\u59cb\u7684\u90a3\u4e2a 0 \u70b9\u3002\u7b49\u4ef7\u4e8e 0 0 * * 0 \uff1b @daily \uff1a\u4e5f\u53ef\u4ee5\u5199\u4f5c @midnight \uff0c\u8868\u793a\u6bcf\u5929 0 \u70b9\u3002\u7b49\u4ef7\u4e8e 0 0 * * * \uff1b @hourly \uff1a\u8868\u793a\u6bcf\u5c0f\u65f6\u7684\u5f00\u59cb\u3002\u7b49\u4ef7\u4e8e 0 * * * * \u3002","title":"\u9884\u5b9a\u4e49\u65f6\u95f4\u89c4\u5219"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/#_6","text":"@every <duration>","title":"\u56fa\u5b9a\u65f6\u95f4\u89c4\u5219"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/#_7","text":"nyc, _ := time.LoadLocation(\"America/New_York\") c := cron.New(cron.WithLocation(nyc)) \u901a\u8fc7 time.loadLocation \u8bbe\u7f6e\u5f53\u524d\u65f6\u533a\uff0c\u5728\u542f\u52a8\u5b9a\u65f6\u5668\u7684\u65f6\u5019\u4f7f\u7528 cron.WithLocation() \u8bbe\u7f6e\u65f6\u533a\u65f6\u95f4\u3002","title":"\u65f6\u533a\u9009\u62e9"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/#_8","text":"","title":"\u4efb\u52a1\u5305\u88c5"},{"location":"Golang/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%20Cron/#recover","text":"func Recover(logger Logger) JobWrapper { return func(j Job) Job { return FuncJob(func() { defer func() { if r := recover(); r != nil { const size = 64 << 10 buf := make([]byte, size) buf = buf[:runtime.Stack(buf, false)] err, ok := r.(error) if !ok { err = fmt.Errorf(\"%v\", r) } logger.Error(err, \"panic\", \"stack\", \"...\\n\"+string(buf)) } }() j.Run() }) } } // \u5ef6\u8fdf\u4ecd\u7136\u8fd0\u884c // \u5e8f\u5217\u5316\u4f5c\u4e1a\uff0c\u5ef6\u8fdf\u540e\u7eed\u8fd0\u884c\u76f4\u5230 \u524d\u4e00\u4e2a\u662f\u5b8c\u6574\u7684\u3002\u4e00\u5206\u949f\u591a\u540e\u7684\u5de5\u4f5c \u6709\u5ef6\u8fdf\u767b\u5f55\u4fe1\u606f\u3002 func DelayIfStillRunning(logger Logger) JobWrapper { return func(j Job) Job { var mu sync.Mutex return FuncJob(func() { start := time.Now() mu.Lock() defer mu.Unlock() if dur := time.Since(start); dur > time.Minute { logger.Info(\"delay\", \"duration\", dur) } j.Run() }) } } // SkipifStillrunning \u5ef6\u8fdf\u8df3\u8fc7\u4e86\u4f5c\u4e1a\u8c03\u7528 // \u5982\u679c\u5148\u524d\u7684\u8c03\u7528\u4ecd\u5728\u8fd0\u884c\u3002\u5b83\u7684\u65e5\u5fd7\u8df3\u8fc7\u4e86\u7ed9\u5b9a\u7684Logger\u5728\u4fe1\u606f\u6c34\u5e73\u3002 func SkipIfStillRunning(logger Logger) JobWrapper { return func(j Job) Job { var ch = make(chan struct{}, 1) ch <- struct{}{} return FuncJob(func() { select { case v := <-ch: j.Run() ch <- v default: logger.Info(\"skip\") } }) } } \u6ce8\u610f DelayIfStillRunning \u4e0e SkipIfStillRunning \u662f\u6709\u672c\u8d28\u4e0a\u7684\u533a\u522b\u7684\uff0c\u524d\u8005 DelayIfStillRunning \u53ea\u8981\u65f6\u95f4\u8db3\u591f\u957f\uff0c\u6240\u6709\u7684\u4efb\u52a1\u90fd\u4f1a\u6309\u90e8\u5c31\u73ed\u5730\u5b8c\u6210\uff0c\u53ea\u662f\u53ef\u80fd\u524d\u4e00\u4e2a\u4efb\u52a1\u8017\u65f6\u8fc7\u957f\uff0c\u5bfc\u81f4\u540e\u4e00\u4e2a\u4efb\u52a1\u7684\u6267\u884c\u65f6\u95f4\u63a8\u8fdf\u4e86\u4e00\u70b9\u3002 SkipIfStillRunning \u4f1a\u8df3\u8fc7\u4e00\u4e9b\u6267\u884c\u3002 Recover \uff1a\u6355\u83b7\u5185\u90e8 Job \u4ea7\u751f\u7684 panic\uff1b DelayIfStillRunning \uff1a\u89e6\u53d1\u65f6\uff0c\u5982\u679c\u4e0a\u4e00\u6b21\u4efb\u52a1\u8fd8\u672a\u6267\u884c\u5b8c\u6210\uff08\u8017\u65f6\u592a\u957f\uff09\uff0c\u5219\u7b49\u5f85\u4e0a\u4e00\u6b21\u4efb\u52a1\u5b8c\u6210\u4e4b\u540e\u518d\u6267\u884c\uff1b SkipIfStillRunning \uff1a\u89e6\u53d1\u65f6\uff0c\u5982\u679c\u4e0a\u4e00\u6b21\u4efb\u52a1\u8fd8\u672a\u5b8c\u6210\uff0c\u5219\u8df3\u8fc7\u6b64\u6b21\u6267\u884c\u3002 Demo: func (d *delayJob) Run() { time.Sleep(2 * time.Second) d.count++ log.Printf(\"%d: hello world\\n\", d.count) } func main() { c := cron.New() _, _ = c.AddJob(\"@every 1s\", cron.NewChain(cron.SkipIfStillRunning(cron.DefaultLogger)).Then(&delayJob{})) c.Start() time.Sleep(10 * time.Second) } ~/go/src/GoWebDemo/studygolang/cron \ue0b0 \ue0a0 master \u271a \u25cf \ue0b0 go run demo.go 2020/09/04 16:16:03 1: hello world 2020/09/04 16:16:05 2: hello world 2020/09/04 16:16:08 3: hello world func (d *delayJob) Run() { time.Sleep(2 * time.Second) d.count++ log.Printf(\"%d: hello world\\n\", d.count) } func main() { c := cron.New() _, _ = c.AddJob(\"@every 1s\", cron.NewChain(cron.DelayIfStillRunning(cron.DefaultLogger)).Then(&delayJob{})) c.Start() time.Sleep(10 * time.Second) } ~/go/src/GoWebDemo/studygolang/cron \ue0b0 \ue0a0 master \u271a \u25cf \ue0b0 go run demo.go 2020/09/04 16:18:07 1: hello world 2020/09/04 16:18:09 2: hello world 2020/09/04 16:18:11 3: hello world 2020/09/04 16:18:13 4: hello world","title":"Recover"},{"location":"Golang/%E6%9D%83%E9%99%90%E6%A0%91/","text":"// XMSCategory _ type XMSCategory struct { ID int64 `json:\"id\"` Name string `json:\"name\"` Level int64 `json:\"level\"` ParentID int64 `json:\"parentId\"` SerialType string `json:\"serialType\"` } type XMSCategoryChild struct { ID int64 `json:\"id\"` Name string `json:\"name\"` Level int64 `json:\"level\"` ParentID int64 `json:\"parentId\"` SerialType string `json:\"serialType\"` CategoryChild []*XMSCategoryChild } // \u83b7\u53d6\u6240\u6709\u5206\u7c7b func GetAllCategory() (perms []XMSCategoryChild) { child := XMSCategoryChild{0, \"all category\", 0, -1, \"\", []*XMSCategoryChild{}} err := getTreeNode(0, &child) if err != nil { return } perms = append(perms, child) return perms } // \u9012\u5f52\u83b7\u53d6\u5b50\u8282\u70b9 func getTreeNode(pId int64, treeNode *XMSCategoryChild) error { perms, err := getDataByPid(pId) //\u6839\u636e\u7236\u7ed3\u70b9Id\u67e5\u8be2\u6570\u636e\u8868\uff0c\u83b7\u53d6\u76f8\u5e94\u7684\u5b50\u7ed3\u70b9\u4fe1\u606f(\u4f7f\u7528gorm) if err != nil { return err } for i := 0; i < len(perms); i++ { child := XMSCategoryChild{ perms[i].ID, perms[i].Name, perms[i].Level, perms[i].ParentID, perms[i].SerialType, []*XMSCategoryChild{}, } treeNode.CategoryChild = append(treeNode.CategoryChild, &child) _ = getTreeNode(perms[i].ID, &child) } return err } func getDataByPid(pid int64) (result []*XMSCategoryChild, err error) { data, err := getCategoryChildData() if err != nil { return } for _, val := range data { if pid == val.ParentID { result = append(result, val) } } return } func getCategoryChildData() (tmpSliceData []*XMSCategoryChild, err error) { _, data, err1 := Category() if err1 != nil { err = err1.ToError() return } for _, value := range data { tmpData := &XMSCategoryChild{ ParentID: value.ParentID, ID: value.ID, Name: value.Name, Level: value.Level, SerialType: value.SerialType, } tmpSliceData = append(tmpSliceData, tmpData) } return }","title":"\u6743\u9650\u6811"},{"location":"Golang/%E7%B2%BE%E5%BA%A6%E8%AE%A1%E7%AE%97/%E7%B2%BE%E5%BA%A6%E8%AE%A1%E7%AE%97/","text":"\u7cbe\u5ea6\u8ba1\u7b97 \u622a\u53d6\u5c0f\u6570\u4f4d\u6570 // \u622a\u53d6\u5c0f\u6570\u4f4d\u6570 _ func floatRound(f float64, n int) (res float64) { format := \"%.\" + strconv.Itoa(n) + \"f\" res, _ = strconv.ParseFloat(fmt.Sprintf(format, f), 64) return }","title":"\u7cbe\u5ea6\u8ba1\u7b97"},{"location":"Golang/%E7%B2%BE%E5%BA%A6%E8%AE%A1%E7%AE%97/%E7%B2%BE%E5%BA%A6%E8%AE%A1%E7%AE%97/#_1","text":"","title":"\u7cbe\u5ea6\u8ba1\u7b97"},{"location":"Golang/%E7%B2%BE%E5%BA%A6%E8%AE%A1%E7%AE%97/%E7%B2%BE%E5%BA%A6%E8%AE%A1%E7%AE%97/#_2","text":"// \u622a\u53d6\u5c0f\u6570\u4f4d\u6570 _ func floatRound(f float64, n int) (res float64) { format := \"%.\" + strconv.Itoa(n) + \"f\" res, _ = strconv.ParseFloat(fmt.Sprintf(format, f), 64) return }","title":"\u622a\u53d6\u5c0f\u6570\u4f4d\u6570"},{"location":"MySQL/MySQL%20%E5%AE%9E%E6%88%9845%E8%AE%B2/05-%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E7%B4%A2%E5%BC%95/","text":"\u6df1\u5165\u6d45\u51fa\u7d22\u5f15 \u56de\u8868\uff1a\u56de\u5230\u4e3b\u952e\u7d22\u5f15\u6570\u641c\u7d22\u7684\u8fc7\u7a0b\u3002","title":"\u6df1\u5165\u6d45\u51fa\u7d22\u5f15"},{"location":"MySQL/MySQL%20%E5%AE%9E%E6%88%9845%E8%AE%B2/05-%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E7%B4%A2%E5%BC%95/#_1","text":"\u56de\u8868\uff1a\u56de\u5230\u4e3b\u952e\u7d22\u5f15\u6570\u641c\u7d22\u7684\u8fc7\u7a0b\u3002","title":"\u6df1\u5165\u6d45\u51fa\u7d22\u5f15"},{"location":"MySQL/MySQL%20%E5%AE%9E%E6%88%9845%E8%AE%B2/09-%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95%E7%9A%84%E9%80%89%E6%8B%A9/","text":"\u5dee\u522b \u524d\u63d0\uff1aMySQL InnoDB\u5f15\u64ce\u3002\u5728InnoDB\u4e2d\uff0c\u6bcf\u4e2a\u6570\u636e\u9875\u7684\u5927\u5c0f\u9ed8\u8ba4\u662f16KB\u3002 \u67e5\u8be2\u8fc7\u7a0b\uff1a \u666e\u901a\u7d22\u5f15\uff1a\u67e5\u8be2\u6ee1\u8db3\u6761\u4ef6\u7684\u7b2c\u4e00\u4e2a\u8bb0\u5f55\uff0c\u4e4b\u540e\u67e5\u627e\u63a5\u4e0b\u6765\u7684\u8bb0\u5f55\uff0c\u76f4\u5230\u67e5\u627e\u4e0d\u5230\u5bf9\u5e94\u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u8bb0\u5f55\uff1b \u552f\u4e00\u7d22\u5f15\uff1a\u67e5\u8be2\u6ee1\u8db3\u6761\u4ef6\u7684\u7b2c\u4e00\u6761\u8bb0\u5f55\uff0c\u8fd4\u56de\uff0c\uff08\u552f\u4e00\u7d22\u5f15\u552f\u4e00\u6027\uff09\u3002 \u4e0d\u8fc7\u5bf9\u4e8e\u8fd9\u79cd\u67e5\u8be2\uff0c\u6027\u80fd\u5dee\u8ddd\u662f\u5fae\u4e4e\u5176\u5fae\u7684\u3002 \u66f4\u65b0\u8fc7\u7a0b\uff1a \u5728\u66f4\u65b0\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u5b58\u5728\u6570\u636e\u9875\u7684\u6982\u5ff5\uff0c\u5b58\u5728\u6570\u636e\u9875\u672a\u547d\u4e2d\u5185\u5b58\uff0c\u9700\u8981\u4ece\u78c1\u76d8\u5199\u5165\u5230\u5185\u5b58\u4e2d\u64cd\u4f5c\u3002 \u4e24\u79cd\u60c5\u51b5\uff1a\u66f4\u65b0\u6570\u636e\u9875\u5728\u5185\u5b58\u4e2d\u548c\u4e0d\u5728\u5185\u5b58\u4e2d\u3002 \u9700\u8981\u66f4\u65b0\u7684\u8bb0\u5f55\u7684\u6570\u636e\u9875\u5728\u5185\u5b58\u4e2d \u552f\u4e00\u7d22\u5f15\uff1a\u67e5\u627e\u5bf9\u5e94\u7684\u6761\u4ef6\uff0c\u627e\u5230\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff0c\u5224\u65ad\u6709\u6ca1\u6709\u51b2\u7a81\uff0c\u63d2\u5165\u66f4\u65b0\u503c\uff0c\u7ed3\u675f\uff1b \u666e\u901a\u7d22\u5f15\uff1a\u67e5\u627e\u5bf9\u5e94\u7684\u6761\u4ef6\uff0c\u627e\u5230\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff0c\u63d2\u5165\u66f4\u65b0\u503c\uff0c\u7ed3\u675f\u3002 \u9700\u8981\u66f4\u65b0\u7684\u8bb0\u5f55\u7684\u6570\u636e\u9875\u4e0d\u5728\u5185\u5b58\u4e2d \u552f\u4e00\u7d22\u5f15\uff1a\u5c06\u9700\u8981\u53d8\u66f4\u65b0\u7684\u6570\u636e\u9875\u5199\u5165\u5185\u5b58\uff0c\u5224\u65ad\u6709\u65e0\u51b2\u7a81\uff0c\u63d2\u5165\u66f4\u65b0\u503c\uff0c\u7ed3\u675f\uff1b \u666e\u901a\u7d22\u5f15\uff1a\u5c06\u66f4\u65b0\u8bb0\u5f55\u8bb0\u5f55\u5728 change buffer \u4e2d\uff0c\u7ed3\u675f\u3002 \u5f53\u9700\u8981\u66f4\u65b0\u4e00\u4e2a\u6570\u636e\u9875\u65f6\uff0c\u5982\u679c\u6570\u636e\u9875\u5728\u5185\u5b58\u4e2d\u5c31\u76f4\u63a5\u66f4\u65b0\uff0c\u800c\u5982\u679c\u8fd9\u4e2a\u6570\u636e\u9875\u8fd8\u6ca1\u6709\u5728\u5185\u5b58\u4e2d\u7684\u8bdd\uff0c\u5728\u4e0d\u5f71\u54cd\u6570\u636e\u4e00\u81f4\u6027\u7684\u524d\u63d0\u4e0b\uff0cInooDB\u4f1a\u5c06\u8fd9\u4e9b\u66f4\u65b0\u64cd\u4f5c\u7f13\u5b58\u5728change buffer\u4e2d\uff0c\u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u4ece\u78c1\u76d8\u4e2d\u8bfb\u5165\u8fd9\u4e2a\u6570\u636e\u9875\u4e86\u3002\u5728\u4e0b\u6b21\u67e5\u8be2\u9700\u8981\u8bbf\u95ee\u8fd9\u4e2a\u6570\u636e\u9875\u7684\u65f6\u5019\uff0c\u5c06\u6570\u636e\u9875\u8bfb\u5165\u5185\u5b58\uff0c\u7136\u540e\u6267\u884cchange buffer\u4e2d\u4e0e\u8fd9\u4e2a\u9875\u6709\u5173\u7684\u64cd\u4f5c\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u5c31\u80fd\u4fdd\u8bc1\u8fd9\u4e2a\u6570\u636e\u903b\u8f91\u7684\u6b63\u786e\u6027\u3002 Change buffer \u5c06\u6570\u636e\u4ece\u78c1\u76d8\u8bfb\u5165\u5185\u5b58\u6d89\u53ca\u968f\u673aIO\u7684\u8bbf\u95ee\uff0c\u662f\u6570\u636e\u5e93\u91cc\u9762\u6210\u672c\u6700\u9ad8\u7684\u64cd\u4f5c\u4e4b\u4e00\u3002 \u5728\u4e1a\u52a1\u4e2d\uff0c\u5199\u591a\u8bfb\u5c11\u7684\u573a\u666f\u4f7f\u7528\u666e\u901a\u7d22\u5f15\u7684\u6027\u80fd\u4f18\u52bf\u662f\u975e\u5e38\u660e\u663e\u7684\u3002\u4f46\u662f\u5199\u5b8c\u7acb\u5373\u8bfb\u53d6\u7684\u8bdd\uff0c\u4f5c\u7528\u5c31\u662f\u76f8\u53cd\u7684\u3002 \u7ed3\u8bba\uff1a\u8003\u8651\u66f4\u65b0\u573a\u666f\u6bd4\u8f83\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u666e\u901a\u7d22\u5f15\u6bd4\u8f83\u597d\u3002 TODO\uff1a \u8fd9\u91cc\uff0c\u6211\u4eec\u5047\u8bbe\b\u5f53\u524dk\u7d22\u5f15\u6811\u7684\u72b6\u6001\uff0c\u67e5\u627e\u5230\u4f4d\u7f6e\u540e\uff0ck1\u6240\u5728\u7684\u6570\u636e\u9875\u5728\u5185\u5b58(InnoDB buffer pool)\u4e2d\uff0ck2\u6240\u5728\u7684\u6570\u636e\u9875\u4e0d\u5728\u5185\u5b58\u4e2d\u3002\u5982\u56fe2\u6240\u793a\u662f\u5e26change buffer\u7684\u66f4\u65b0\u72b6\u6001\u56fe\u3002","title":"09 \u666e\u901a\u7d22\u5f15\u4e0e\u552f\u4e00\u7d22\u5f15\u7684\u9009\u62e9"},{"location":"MySQL/MySQL%20%E5%AE%9E%E6%88%9845%E8%AE%B2/09-%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95%E7%9A%84%E9%80%89%E6%8B%A9/#_1","text":"\u524d\u63d0\uff1aMySQL InnoDB\u5f15\u64ce\u3002\u5728InnoDB\u4e2d\uff0c\u6bcf\u4e2a\u6570\u636e\u9875\u7684\u5927\u5c0f\u9ed8\u8ba4\u662f16KB\u3002","title":"\u5dee\u522b"},{"location":"MySQL/MySQL%20%E5%AE%9E%E6%88%9845%E8%AE%B2/09-%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95%E7%9A%84%E9%80%89%E6%8B%A9/#_2","text":"\u666e\u901a\u7d22\u5f15\uff1a\u67e5\u8be2\u6ee1\u8db3\u6761\u4ef6\u7684\u7b2c\u4e00\u4e2a\u8bb0\u5f55\uff0c\u4e4b\u540e\u67e5\u627e\u63a5\u4e0b\u6765\u7684\u8bb0\u5f55\uff0c\u76f4\u5230\u67e5\u627e\u4e0d\u5230\u5bf9\u5e94\u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u8bb0\u5f55\uff1b \u552f\u4e00\u7d22\u5f15\uff1a\u67e5\u8be2\u6ee1\u8db3\u6761\u4ef6\u7684\u7b2c\u4e00\u6761\u8bb0\u5f55\uff0c\u8fd4\u56de\uff0c\uff08\u552f\u4e00\u7d22\u5f15\u552f\u4e00\u6027\uff09\u3002 \u4e0d\u8fc7\u5bf9\u4e8e\u8fd9\u79cd\u67e5\u8be2\uff0c\u6027\u80fd\u5dee\u8ddd\u662f\u5fae\u4e4e\u5176\u5fae\u7684\u3002","title":"\u67e5\u8be2\u8fc7\u7a0b\uff1a"},{"location":"MySQL/MySQL%20%E5%AE%9E%E6%88%9845%E8%AE%B2/09-%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95%E7%9A%84%E9%80%89%E6%8B%A9/#_3","text":"\u5728\u66f4\u65b0\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u5b58\u5728\u6570\u636e\u9875\u7684\u6982\u5ff5\uff0c\u5b58\u5728\u6570\u636e\u9875\u672a\u547d\u4e2d\u5185\u5b58\uff0c\u9700\u8981\u4ece\u78c1\u76d8\u5199\u5165\u5230\u5185\u5b58\u4e2d\u64cd\u4f5c\u3002 \u4e24\u79cd\u60c5\u51b5\uff1a\u66f4\u65b0\u6570\u636e\u9875\u5728\u5185\u5b58\u4e2d\u548c\u4e0d\u5728\u5185\u5b58\u4e2d\u3002","title":"\u66f4\u65b0\u8fc7\u7a0b\uff1a"},{"location":"MySQL/MySQL%20%E5%AE%9E%E6%88%9845%E8%AE%B2/09-%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95%E7%9A%84%E9%80%89%E6%8B%A9/#_4","text":"\u552f\u4e00\u7d22\u5f15\uff1a\u67e5\u627e\u5bf9\u5e94\u7684\u6761\u4ef6\uff0c\u627e\u5230\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff0c\u5224\u65ad\u6709\u6ca1\u6709\u51b2\u7a81\uff0c\u63d2\u5165\u66f4\u65b0\u503c\uff0c\u7ed3\u675f\uff1b \u666e\u901a\u7d22\u5f15\uff1a\u67e5\u627e\u5bf9\u5e94\u7684\u6761\u4ef6\uff0c\u627e\u5230\u5bf9\u5e94\u7684\u4f4d\u7f6e\uff0c\u63d2\u5165\u66f4\u65b0\u503c\uff0c\u7ed3\u675f\u3002","title":"\u9700\u8981\u66f4\u65b0\u7684\u8bb0\u5f55\u7684\u6570\u636e\u9875\u5728\u5185\u5b58\u4e2d"},{"location":"MySQL/MySQL%20%E5%AE%9E%E6%88%9845%E8%AE%B2/09-%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95%E4%B8%8E%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95%E7%9A%84%E9%80%89%E6%8B%A9/#_5","text":"\u552f\u4e00\u7d22\u5f15\uff1a\u5c06\u9700\u8981\u53d8\u66f4\u65b0\u7684\u6570\u636e\u9875\u5199\u5165\u5185\u5b58\uff0c\u5224\u65ad\u6709\u65e0\u51b2\u7a81\uff0c\u63d2\u5165\u66f4\u65b0\u503c\uff0c\u7ed3\u675f\uff1b \u666e\u901a\u7d22\u5f15\uff1a\u5c06\u66f4\u65b0\u8bb0\u5f55\u8bb0\u5f55\u5728 change buffer \u4e2d\uff0c\u7ed3\u675f\u3002 \u5f53\u9700\u8981\u66f4\u65b0\u4e00\u4e2a\u6570\u636e\u9875\u65f6\uff0c\u5982\u679c\u6570\u636e\u9875\u5728\u5185\u5b58\u4e2d\u5c31\u76f4\u63a5\u66f4\u65b0\uff0c\u800c\u5982\u679c\u8fd9\u4e2a\u6570\u636e\u9875\u8fd8\u6ca1\u6709\u5728\u5185\u5b58\u4e2d\u7684\u8bdd\uff0c\u5728\u4e0d\u5f71\u54cd\u6570\u636e\u4e00\u81f4\u6027\u7684\u524d\u63d0\u4e0b\uff0cInooDB\u4f1a\u5c06\u8fd9\u4e9b\u66f4\u65b0\u64cd\u4f5c\u7f13\u5b58\u5728change buffer\u4e2d\uff0c\u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u4ece\u78c1\u76d8\u4e2d\u8bfb\u5165\u8fd9\u4e2a\u6570\u636e\u9875\u4e86\u3002\u5728\u4e0b\u6b21\u67e5\u8be2\u9700\u8981\u8bbf\u95ee\u8fd9\u4e2a\u6570\u636e\u9875\u7684\u65f6\u5019\uff0c\u5c06\u6570\u636e\u9875\u8bfb\u5165\u5185\u5b58\uff0c\u7136\u540e\u6267\u884cchange buffer\u4e2d\u4e0e\u8fd9\u4e2a\u9875\u6709\u5173\u7684\u64cd\u4f5c\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u5c31\u80fd\u4fdd\u8bc1\u8fd9\u4e2a\u6570\u636e\u903b\u8f91\u7684\u6b63\u786e\u6027\u3002 Change buffer \u5c06\u6570\u636e\u4ece\u78c1\u76d8\u8bfb\u5165\u5185\u5b58\u6d89\u53ca\u968f\u673aIO\u7684\u8bbf\u95ee\uff0c\u662f\u6570\u636e\u5e93\u91cc\u9762\u6210\u672c\u6700\u9ad8\u7684\u64cd\u4f5c\u4e4b\u4e00\u3002 \u5728\u4e1a\u52a1\u4e2d\uff0c\u5199\u591a\u8bfb\u5c11\u7684\u573a\u666f\u4f7f\u7528\u666e\u901a\u7d22\u5f15\u7684\u6027\u80fd\u4f18\u52bf\u662f\u975e\u5e38\u660e\u663e\u7684\u3002\u4f46\u662f\u5199\u5b8c\u7acb\u5373\u8bfb\u53d6\u7684\u8bdd\uff0c\u4f5c\u7528\u5c31\u662f\u76f8\u53cd\u7684\u3002 \u7ed3\u8bba\uff1a\u8003\u8651\u66f4\u65b0\u573a\u666f\u6bd4\u8f83\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u666e\u901a\u7d22\u5f15\u6bd4\u8f83\u597d\u3002 TODO\uff1a \u8fd9\u91cc\uff0c\u6211\u4eec\u5047\u8bbe\b\u5f53\u524dk\u7d22\u5f15\u6811\u7684\u72b6\u6001\uff0c\u67e5\u627e\u5230\u4f4d\u7f6e\u540e\uff0ck1\u6240\u5728\u7684\u6570\u636e\u9875\u5728\u5185\u5b58(InnoDB buffer pool)\u4e2d\uff0ck2\u6240\u5728\u7684\u6570\u636e\u9875\u4e0d\u5728\u5185\u5b58\u4e2d\u3002\u5982\u56fe2\u6240\u793a\u662f\u5e26change buffer\u7684\u66f4\u65b0\u72b6\u6001\u56fe\u3002","title":"\u9700\u8981\u66f4\u65b0\u7684\u8bb0\u5f55\u7684\u6570\u636e\u9875\u4e0d\u5728\u5185\u5b58\u4e2d"},{"location":"Project/%E4%BB%A3%E7%A0%81%E6%AE%B5/","text":"\u4ee3\u7801\u6bb5 \u65f6\u95f4\u70b9\u63a7\u5236 box.Countdown = 0 if !s.IsNilTime(curBox.AwardTime) { // \u5df2\u5168\u90e8\u9886\u53d6 box.Status = 4 box.Name = \"\u660e\u5929\u518d\u6765\" s.BoxFinished(mid, date) } else if now.Before(curBox.FinishTime) { // \u65f6\u95f4\u672a\u5230\uff0c box.Status = 1 box.Countdown = curBox.FinishTime.Unix() - now.Unix() } else { box.Status = 2 // \u53ef\u9886\u53d6 box.Name = \"\u53ef\u9886\u53d6\" } isNilTime \u7528\u6765\u5224\u65ad\u6d3b\u52a8\u65f6\u95f4\u662f\u5426\u7ed3\u675f func (s *ModelService) IsNilTime(t time.Time) bool { tStr := t.Format(\"2006-01-02 15:04:05\") s.LogEntity.WithField(\"is_nil_time\", tStr) return tStr == \"0001-01-01 00:00:00\" } now.Before \u65f6\u95f4\u5224\u65ad func (t Time) Before(u Time) bool { if t.wall&u.wall&hasMonotonic != 0 { return t.ext < u.ext } ts := t.sec() us := u.sec() return ts < us || ts == us && t.nsec() < u.nsec() } \u5206\u5e03\u5f0f\u9501\u5e94\u7528 \u4f7f\u7528\u573a\u666f \u4e3b\u8981\u662f\u9488\u5bf9\u4e8e\u7528\u6237\u64cd\u4f5c\u62bd\u5956\uff0c\u9632\u6b62\u591a\u6b21\u62bd\u5956\u3002 // \u7528\u6237\u52a0\u9501\uff0c\u9632\u6b62\u91cd\u653e\u591a\u62bd lock := common.NewRedisLocker(s.RedisK2, s.UserLockerKey(currentUserID)) if !lock.Lock() { err = xerror.NewXerr(fmt.Errorf(\"get redis lock fail\"), common.XErrInternel) return } defer func() { lock.Unlock() }() \u4e8b\u52a1\u5e94\u7528 err = s.Transaction(s.WriteDB, func(tx *xdb.XTx) (errTx error) { errTx = dao.AddK2AwardRecord(s.WriteDB, awardRecode) errTx = dao.UpdateK2Box(tx, s.ActivityID, k2boxid, currentUserID, map[string]interface{}{ \"award_time\": now, \"update_time\": now, \"status\": 2, }) return }) if err != nil { return } \u4e3b\u8981\u662f\u9488\u5bf9\u4e8e\u7528\u6237\u7684\u540c\u4e00\u4e2a\u4e8b\u4ef6\u8fdb\u884c\u7684\u591a\u8868 CURD \u64cd\u4f5c\u3002 fallthrough \u8fd9\u4e2a\u5c31\u662f\u7b80\u5355\u7684\u8ba9 switch \u68c0\u6d4b\u5230\u5f53\u524d case \u4ee3\u7801\u4e2d\u5b58\u5728\u6ca1\u6709\u903b\u8f91\u64cd\u4f5c\uff0c\u6709\u6b64\u5173\u952e\u5b57\uff0c\u76f4\u63a5\u6267\u884c\u4e0b\u4e00\u4e2a case\u3002 bingo \u62bd\u5956\u7ec6\u8282 // bingo \u5956\u6c60\u62bd\u5956 func (s *ModelService) getBingoPrize(code, floorCode string) (pi *bingo.DrawResponse, realCode string, isHonor bool, err error) // BingoResToDrawData \u5c06\u62bd\u5956\u7ed3\u679c\u8f6c\u6362\u4e3a\u63a5\u53e3\u8fd4\u56de\u7684\u7ed3\u6784 func (s *ModelService) BingoResToDrawData(rs *bingo.DrawResponse) (retData *m_hd.DrawData)","title":"\u4ee3\u7801\u6bb5"},{"location":"Project/%E4%BB%A3%E7%A0%81%E6%AE%B5/#_1","text":"","title":"\u4ee3\u7801\u6bb5"},{"location":"Project/%E4%BB%A3%E7%A0%81%E6%AE%B5/#_2","text":"box.Countdown = 0 if !s.IsNilTime(curBox.AwardTime) { // \u5df2\u5168\u90e8\u9886\u53d6 box.Status = 4 box.Name = \"\u660e\u5929\u518d\u6765\" s.BoxFinished(mid, date) } else if now.Before(curBox.FinishTime) { // \u65f6\u95f4\u672a\u5230\uff0c box.Status = 1 box.Countdown = curBox.FinishTime.Unix() - now.Unix() } else { box.Status = 2 // \u53ef\u9886\u53d6 box.Name = \"\u53ef\u9886\u53d6\" }","title":"\u65f6\u95f4\u70b9\u63a7\u5236"},{"location":"Project/%E4%BB%A3%E7%A0%81%E6%AE%B5/#isniltime","text":"\u7528\u6765\u5224\u65ad\u6d3b\u52a8\u65f6\u95f4\u662f\u5426\u7ed3\u675f func (s *ModelService) IsNilTime(t time.Time) bool { tStr := t.Format(\"2006-01-02 15:04:05\") s.LogEntity.WithField(\"is_nil_time\", tStr) return tStr == \"0001-01-01 00:00:00\" }","title":"isNilTime"},{"location":"Project/%E4%BB%A3%E7%A0%81%E6%AE%B5/#nowbefore","text":"\u65f6\u95f4\u5224\u65ad func (t Time) Before(u Time) bool { if t.wall&u.wall&hasMonotonic != 0 { return t.ext < u.ext } ts := t.sec() us := u.sec() return ts < us || ts == us && t.nsec() < u.nsec() }","title":"now.Before"},{"location":"Project/%E4%BB%A3%E7%A0%81%E6%AE%B5/#_3","text":"","title":"\u5206\u5e03\u5f0f\u9501\u5e94\u7528"},{"location":"Project/%E4%BB%A3%E7%A0%81%E6%AE%B5/#_4","text":"\u4e3b\u8981\u662f\u9488\u5bf9\u4e8e\u7528\u6237\u64cd\u4f5c\u62bd\u5956\uff0c\u9632\u6b62\u591a\u6b21\u62bd\u5956\u3002 // \u7528\u6237\u52a0\u9501\uff0c\u9632\u6b62\u91cd\u653e\u591a\u62bd lock := common.NewRedisLocker(s.RedisK2, s.UserLockerKey(currentUserID)) if !lock.Lock() { err = xerror.NewXerr(fmt.Errorf(\"get redis lock fail\"), common.XErrInternel) return } defer func() { lock.Unlock() }()","title":"\u4f7f\u7528\u573a\u666f"},{"location":"Project/%E4%BB%A3%E7%A0%81%E6%AE%B5/#_5","text":"err = s.Transaction(s.WriteDB, func(tx *xdb.XTx) (errTx error) { errTx = dao.AddK2AwardRecord(s.WriteDB, awardRecode) errTx = dao.UpdateK2Box(tx, s.ActivityID, k2boxid, currentUserID, map[string]interface{}{ \"award_time\": now, \"update_time\": now, \"status\": 2, }) return }) if err != nil { return } \u4e3b\u8981\u662f\u9488\u5bf9\u4e8e\u7528\u6237\u7684\u540c\u4e00\u4e2a\u4e8b\u4ef6\u8fdb\u884c\u7684\u591a\u8868 CURD \u64cd\u4f5c\u3002","title":"\u4e8b\u52a1\u5e94\u7528"},{"location":"Project/%E4%BB%A3%E7%A0%81%E6%AE%B5/#fallthrough","text":"\u8fd9\u4e2a\u5c31\u662f\u7b80\u5355\u7684\u8ba9 switch \u68c0\u6d4b\u5230\u5f53\u524d case \u4ee3\u7801\u4e2d\u5b58\u5728\u6ca1\u6709\u903b\u8f91\u64cd\u4f5c\uff0c\u6709\u6b64\u5173\u952e\u5b57\uff0c\u76f4\u63a5\u6267\u884c\u4e0b\u4e00\u4e2a case\u3002","title":"fallthrough"},{"location":"Project/%E4%BB%A3%E7%A0%81%E6%AE%B5/#bingo","text":"// bingo \u5956\u6c60\u62bd\u5956 func (s *ModelService) getBingoPrize(code, floorCode string) (pi *bingo.DrawResponse, realCode string, isHonor bool, err error) // BingoResToDrawData \u5c06\u62bd\u5956\u7ed3\u679c\u8f6c\u6362\u4e3a\u63a5\u53e3\u8fd4\u56de\u7684\u7ed3\u6784 func (s *ModelService) BingoResToDrawData(rs *bingo.DrawResponse) (retData *m_hd.DrawData)","title":"bingo \u62bd\u5956\u7ec6\u8282"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/","text":"Redis \u8bbe\u8ba1\u4e0e\u5b9e\u73b0 \u9605\u8bfb\u7b14\u8bb0 \u8fd9\u4e2a\u662f\u6211\u57282021 \u5e74\u7684\u8bfb\u4e66\u7b14\u8bb0\uff0c\u628a\u91cd\u8981\u7684\u4fe1\u606f\u63d0\u70bc\u5230\u6b64\u5904 \u65f6\u95f4\uff1a2020\u5e7401\u670801\u65e5 \uff5e \u81f3\u4eca","title":"Redis \u8bbe\u8ba1\u4e0e\u5b9e\u73b0 \u9605\u8bfb\u7b14\u8bb0"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/#redis","text":"\u8fd9\u4e2a\u662f\u6211\u57282021 \u5e74\u7684\u8bfb\u4e66\u7b14\u8bb0\uff0c\u628a\u91cd\u8981\u7684\u4fe1\u606f\u63d0\u70bc\u5230\u6b64\u5904 \u65f6\u95f4\uff1a2020\u5e7401\u670801\u65e5 \uff5e \u81f3\u4eca","title":"Redis \u8bbe\u8ba1\u4e0e\u5b9e\u73b0 \u9605\u8bfb\u7b14\u8bb0"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.0-%E7%AE%80%E5%8D%95%E5%8A%A8%E6%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2/","text":"2.0 \u7b80\u5355\u52a8\u6001\u5b57\u7b26\u4e32 SDS \u5b9a\u4e49 Redis \u6ca1\u6709\u76f4\u63a5\u4f7f\u7528 C \u8bed\u8a00\u4f20\u7edf\u7684\u5b57\u7b26\u4e32\u8868\u793a\uff08\u4ee5\u7a7a\u5b57\u7b26\u7ed3\u5c3e\u7684\u5b57\u7b26\u6570\u7ec4\uff0c\u4ee5\u4e0b\u7b80\u79f0 C \u5b57\u7b26\u4e32\uff09\uff0c \u800c\u662f\u81ea\u5df1\u6784\u5efa\u4e86\u4e00\u79cd\u540d\u4e3a\u7b80\u5355\u52a8\u6001\u5b57\u7b26\u4e32\uff08simple dynamic string\uff0cSDS\uff09\u7684\u62bd\u8c61\u7c7b\u578b\uff0c \u5e76\u5c06 SDS \u7528\u4f5c Redis \u7684\u9ed8\u8ba4\u5b57\u7b26\u4e32\u8868\u793a\u3002 \u5f53 Redis \u9700\u8981\u7684\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u5b57\u9762\u91cf\uff0c \u800c\u662f\u4e00\u4e2a\u53ef\u4ee5\u88ab\u4fee\u6539\u7684\u5b57\u7b26\u4e32\u503c\u65f6\uff0c Redis \u5c31\u4f1a\u4f7f\u7528 SDS \u6765\u8868\u793a\u5b57\u7b26\u4e32\u503c\uff1a \u6bd4\u5982\u5728 Redis \u7684\u6570\u636e\u5e93\u91cc\u9762\uff0c \u5305\u542b\u5b57\u7b26\u4e32\u503c\u7684\u952e\u503c\u5bf9\u5728\u5e95\u5c42\u90fd\u662f\u7531 SDS \u5b9e\u73b0\u7684\u3002 Other \u9664\u4e86\u7528\u6765\u4fdd\u5b58\u6570\u636e\u5e93\u4e2d\u7684\u5b57\u7b26\u4e32\u503c\u4e4b\u5916\uff0c SDS \u8fd8\u88ab\u7528\u4f5c\u7f13\u51b2\u533a\uff08buffer\uff09 \uff1a AOF \u6a21\u5757\u4e2d\u7684 AOF \u7f13\u51b2\u533a\uff0c \u4ee5\u53ca\u5ba2\u6237\u7aef\u72b6\u6001\u4e2d\u7684\u8f93\u5165\u7f13\u51b2\u533a\uff0c \u90fd\u662f\u7531 SDS \u5b9e\u73b0\u7684\uff0c \u5728\u4e4b\u540e\u4ecb\u7ecd AOF \u6301\u4e45\u5316\u548c\u5ba2\u6237\u7aef\u72b6\u6001\u7684\u65f6\u5019\uff0c \u6211\u4eec\u4f1a\u770b\u5230 SDS \u5728\u8fd9\u4e24\u4e2a\u6a21\u5757\u4e2d\u7684\u5e94\u7528\u3002 \u4f8b\u5b50 \u5982\u679c\u5ba2\u6237\u7aef\u6267\u884c\u547d\u4ee4\uff1a redis> RPUSH fruits \"apple\" \"banana\" \"cherry\" (integer) 3 \u90a3\u4e48 Redis \u5c06\u5728\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u952e\u503c\u5bf9\uff0c \u5176\u4e2d\uff1a \u952e\u503c\u5bf9\u7684\u952e\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u5bf9\u8c61\uff0c \u5bf9\u8c61\u7684\u5e95\u5c42\u5b9e\u73b0\u662f\u4e00\u4e2a\u4fdd\u5b58\u4e86\u5b57\u7b26\u4e32 \"fruits\" \u7684 SDS \u3002 \u952e\u503c\u5bf9\u7684\u503c\u662f\u4e00\u4e2a\u5217\u8868\u5bf9\u8c61\uff0c \u5217\u8868\u5bf9\u8c61\u5305\u542b\u4e86\u4e09\u4e2a\u5b57\u7b26\u4e32\u5bf9\u8c61\uff0c \u8fd9\u4e09\u4e2a\u5b57\u7b26\u4e32\u5bf9\u8c61\u5206\u522b\u7531\u4e09\u4e2a SDS \u5b9e\u73b0\uff1a \u7b2c\u4e00\u4e2a SDS \u4fdd\u5b58\u7740\u5b57\u7b26\u4e32 \"apple\" \uff0c \u7b2c\u4e8c\u4e2a SDS \u4fdd\u5b58\u7740\u5b57\u7b26\u4e32 \"banana\" \uff0c \u7b2c\u4e09\u4e2a SDS \u4fdd\u5b58\u7740\u5b57\u7b26\u4e32 \"cherry\" \u3002","title":"2.0 \u7b80\u5355\u52a8\u6001\u5b57\u7b26\u4e32 SDS"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.0-%E7%AE%80%E5%8D%95%E5%8A%A8%E6%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2/#20-sds","text":"","title":"2.0 \u7b80\u5355\u52a8\u6001\u5b57\u7b26\u4e32 SDS"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.0-%E7%AE%80%E5%8D%95%E5%8A%A8%E6%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2/#_1","text":"Redis \u6ca1\u6709\u76f4\u63a5\u4f7f\u7528 C \u8bed\u8a00\u4f20\u7edf\u7684\u5b57\u7b26\u4e32\u8868\u793a\uff08\u4ee5\u7a7a\u5b57\u7b26\u7ed3\u5c3e\u7684\u5b57\u7b26\u6570\u7ec4\uff0c\u4ee5\u4e0b\u7b80\u79f0 C \u5b57\u7b26\u4e32\uff09\uff0c \u800c\u662f\u81ea\u5df1\u6784\u5efa\u4e86\u4e00\u79cd\u540d\u4e3a\u7b80\u5355\u52a8\u6001\u5b57\u7b26\u4e32\uff08simple dynamic string\uff0cSDS\uff09\u7684\u62bd\u8c61\u7c7b\u578b\uff0c \u5e76\u5c06 SDS \u7528\u4f5c Redis \u7684\u9ed8\u8ba4\u5b57\u7b26\u4e32\u8868\u793a\u3002 \u5f53 Redis \u9700\u8981\u7684\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u5b57\u9762\u91cf\uff0c \u800c\u662f\u4e00\u4e2a\u53ef\u4ee5\u88ab\u4fee\u6539\u7684\u5b57\u7b26\u4e32\u503c\u65f6\uff0c Redis \u5c31\u4f1a\u4f7f\u7528 SDS \u6765\u8868\u793a\u5b57\u7b26\u4e32\u503c\uff1a \u6bd4\u5982\u5728 Redis \u7684\u6570\u636e\u5e93\u91cc\u9762\uff0c \u5305\u542b\u5b57\u7b26\u4e32\u503c\u7684\u952e\u503c\u5bf9\u5728\u5e95\u5c42\u90fd\u662f\u7531 SDS \u5b9e\u73b0\u7684\u3002","title":"\u5b9a\u4e49"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.0-%E7%AE%80%E5%8D%95%E5%8A%A8%E6%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2/#other","text":"\u9664\u4e86\u7528\u6765\u4fdd\u5b58\u6570\u636e\u5e93\u4e2d\u7684\u5b57\u7b26\u4e32\u503c\u4e4b\u5916\uff0c SDS \u8fd8\u88ab\u7528\u4f5c\u7f13\u51b2\u533a\uff08buffer\uff09 \uff1a AOF \u6a21\u5757\u4e2d\u7684 AOF \u7f13\u51b2\u533a\uff0c \u4ee5\u53ca\u5ba2\u6237\u7aef\u72b6\u6001\u4e2d\u7684\u8f93\u5165\u7f13\u51b2\u533a\uff0c \u90fd\u662f\u7531 SDS \u5b9e\u73b0\u7684\uff0c \u5728\u4e4b\u540e\u4ecb\u7ecd AOF \u6301\u4e45\u5316\u548c\u5ba2\u6237\u7aef\u72b6\u6001\u7684\u65f6\u5019\uff0c \u6211\u4eec\u4f1a\u770b\u5230 SDS \u5728\u8fd9\u4e24\u4e2a\u6a21\u5757\u4e2d\u7684\u5e94\u7528\u3002","title":"Other"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.0-%E7%AE%80%E5%8D%95%E5%8A%A8%E6%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2/#_2","text":"\u5982\u679c\u5ba2\u6237\u7aef\u6267\u884c\u547d\u4ee4\uff1a redis> RPUSH fruits \"apple\" \"banana\" \"cherry\" (integer) 3 \u90a3\u4e48 Redis \u5c06\u5728\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u952e\u503c\u5bf9\uff0c \u5176\u4e2d\uff1a \u952e\u503c\u5bf9\u7684\u952e\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u5bf9\u8c61\uff0c \u5bf9\u8c61\u7684\u5e95\u5c42\u5b9e\u73b0\u662f\u4e00\u4e2a\u4fdd\u5b58\u4e86\u5b57\u7b26\u4e32 \"fruits\" \u7684 SDS \u3002 \u952e\u503c\u5bf9\u7684\u503c\u662f\u4e00\u4e2a\u5217\u8868\u5bf9\u8c61\uff0c \u5217\u8868\u5bf9\u8c61\u5305\u542b\u4e86\u4e09\u4e2a\u5b57\u7b26\u4e32\u5bf9\u8c61\uff0c \u8fd9\u4e09\u4e2a\u5b57\u7b26\u4e32\u5bf9\u8c61\u5206\u522b\u7531\u4e09\u4e2a SDS \u5b9e\u73b0\uff1a \u7b2c\u4e00\u4e2a SDS \u4fdd\u5b58\u7740\u5b57\u7b26\u4e32 \"apple\" \uff0c \u7b2c\u4e8c\u4e2a SDS \u4fdd\u5b58\u7740\u5b57\u7b26\u4e32 \"banana\" \uff0c \u7b2c\u4e09\u4e2a SDS \u4fdd\u5b58\u7740\u5b57\u7b26\u4e32 \"cherry\" \u3002","title":"\u4f8b\u5b50"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.2-SDS%20%E4%B8%8E%20C%20%E4%B8%B2%E7%9A%84%E5%8C%BA%E5%88%AB/","text":"2.1 SDS \u4e0e C \u4e32\u7684\u533a\u522b 1 \u5e38\u6570\u590d\u6742\u5ea6\u83b7\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6 \u56e0\u4e3a\u5b57\u7b26\u4e32\u952e\u5728\u5e95\u5c42\u4f7f\u7528 SDS \u6765\u5b9e\u73b0\uff0c \u6240\u4ee5\u5373\u4f7f\u6211\u4eec\u5bf9\u4e00\u4e2a\u975e\u5e38\u957f\u7684\u5b57\u7b26\u4e32\u952e\u53cd\u590d\u6267\u884c STRLEN \u547d\u4ee4\uff0c \u4e5f\u4e0d\u4f1a\u5bf9\u7cfb\u7edf\u6027\u80fd\u9020\u6210\u4efb\u4f55\u5f71\u54cd\uff0c \u56e0\u4e3a STRLEN \u547d\u4ee4\u7684\u590d\u6742\u5ea6\u4ec5\u4e3a O(1) \u3002 2 \u675c\u7edd\u7f13\u51b2\u533a\u6ea2\u51fa \u4e0e C \u5b57\u7b26\u4e32\u4e0d\u540c\uff0c SDS \u7684\u7a7a\u95f4\u5206\u914d\u7b56\u7565\u5b8c\u5168\u675c\u7edd\u4e86\u53d1\u751f\u7f13\u51b2\u533a\u6ea2\u51fa\u7684\u53ef\u80fd\u6027\uff1a \u5f53 SDS API \u9700\u8981\u5bf9 SDS \u8fdb\u884c\u4fee\u6539\u65f6\uff0c API \u4f1a\u5148\u68c0\u67e5 SDS \u7684\u7a7a\u95f4\u662f\u5426\u6ee1\u8db3\u4fee\u6539\u6240\u9700\u7684\u8981\u6c42\uff0c \u5982\u679c\u4e0d\u6ee1\u8db3\u7684\u8bdd\uff0c API \u4f1a\u81ea\u52a8\u5c06 SDS \u7684\u7a7a\u95f4\u6269\u5c55\u81f3\u6267\u884c\u4fee\u6539\u6240\u9700\u7684\u5927\u5c0f\uff0c \u7136\u540e\u624d\u6267\u884c\u5b9e\u9645\u7684\u4fee\u6539\u64cd\u4f5c\uff0c \u6240\u4ee5\u4f7f\u7528 SDS \u65e2\u4e0d\u9700\u8981\u624b\u52a8\u4fee\u6539 SDS \u7684\u7a7a\u95f4\u5927\u5c0f\uff0c \u4e5f\u4e0d\u4f1a\u51fa\u73b0\u524d\u9762\u6240\u8bf4\u7684\u7f13\u51b2\u533a\u6ea2\u51fa\u95ee\u9898\u3002 SDS \u7684 API \u91cc\u9762\u4e5f\u6709\u4e00\u4e2a\u7528\u4e8e\u6267\u884c\u62fc\u63a5\u64cd\u4f5c\u7684 sdscat \u51fd\u6570 3 \u51cf\u5c11\u4fee\u6539\u5b57\u7b26\u4e32\u65f6\u5e26\u6765\u7684\u5185\u5b58\u91cd\u5206\u914d\u6b21\u6570 \u56e0\u4e3a C \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u548c\u5e95\u5c42\u6570\u7ec4\u7684\u957f\u5ea6\u4e4b\u95f4\u5b58\u5728\u7740\u8fd9\u79cd\u5173\u8054\u6027\uff0c \u6240\u4ee5\u6bcf\u6b21\u589e\u957f\u6216\u8005\u7f29\u77ed\u4e00\u4e2a C \u5b57\u7b26\u4e32\uff0c \u7a0b\u5e8f\u90fd\u603b\u8981\u5bf9\u4fdd\u5b58\u8fd9\u4e2a C \u5b57\u7b26\u4e32\u7684\u6570\u7ec4\u8fdb\u884c\u4e00\u6b21\u5185\u5b58\u91cd\u5206\u914d\u64cd\u4f5c\uff1a \u5982\u679c\u7a0b\u5e8f\u6267\u884c\u7684\u662f\u589e\u957f\u5b57\u7b26\u4e32\u7684\u64cd\u4f5c\uff0c \u6bd4\u5982\u62fc\u63a5\u64cd\u4f5c\uff08append\uff09\uff0c \u90a3\u4e48\u5728\u6267\u884c\u8fd9\u4e2a\u64cd\u4f5c\u4e4b\u524d\uff0c \u7a0b\u5e8f\u9700\u8981\u5148\u901a\u8fc7\u5185\u5b58\u91cd\u5206\u914d\u6765\u6269\u5c55\u5e95\u5c42\u6570\u7ec4\u7684\u7a7a\u95f4\u5927\u5c0f \u2014\u2014 \u5982\u679c\u5fd8\u4e86\u8fd9\u4e00\u6b65\u5c31\u4f1a\u4ea7\u751f\u7f13\u51b2\u533a\u6ea2\u51fa \u3002 \u5982\u679c\u7a0b\u5e8f\u6267\u884c\u7684\u662f\u7f29\u77ed\u5b57\u7b26\u4e32\u7684\u64cd\u4f5c\uff0c \u6bd4\u5982\u622a\u65ad\u64cd\u4f5c\uff08trim\uff09\uff0c \u90a3\u4e48\u5728\u6267\u884c\u8fd9\u4e2a\u64cd\u4f5c\u4e4b\u540e\uff0c \u7a0b\u5e8f\u9700\u8981\u901a\u8fc7\u5185\u5b58\u91cd\u5206\u914d\u6765\u91ca\u653e\u5b57\u7b26\u4e32\u4e0d\u518d\u4f7f\u7528\u7684\u90a3\u90e8\u5206\u7a7a\u95f4 \u2014\u2014 \u5982\u679c\u5fd8\u4e86\u8fd9\u4e00\u6b65\u5c31\u4f1a\u4ea7\u751f\u5185\u5b58\u6cc4\u6f0f \u3002 \u56e0\u4e3a\u5185\u5b58\u91cd\u5206\u914d\u6d89\u53ca\u590d\u6742\u7684\u7b97\u6cd5\uff0c \u5e76\u4e14\u53ef\u80fd\u9700\u8981\u6267\u884c\u7cfb\u7edf\u8c03\u7528\uff0c \u6240\u4ee5\u5b83\u901a\u5e38\u662f\u4e00\u4e2a\u6bd4\u8f83\u8017\u65f6\u7684\u64cd\u4f5c\uff1a \u5728\u4e00\u822c\u7a0b\u5e8f\u4e2d\uff0c \u5982\u679c\u4fee\u6539\u5b57\u7b26\u4e32\u957f\u5ea6\u7684\u60c5\u51b5\u4e0d\u592a\u5e38\u51fa\u73b0\uff0c \u90a3\u4e48\u6bcf\u6b21\u4fee\u6539\u90fd\u6267\u884c\u4e00\u6b21\u5185\u5b58\u91cd\u5206\u914d\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002 \u4f46\u662f Redis \u4f5c\u4e3a\u6570\u636e\u5e93\uff0c \u7ecf\u5e38\u88ab\u7528\u4e8e\u901f\u5ea6\u8981\u6c42\u4e25\u82db\u3001\u6570\u636e\u88ab\u9891\u7e41\u4fee\u6539\u7684\u573a\u5408\uff0c \u5982\u679c\u6bcf\u6b21\u4fee\u6539\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u90fd\u9700\u8981\u6267\u884c\u4e00\u6b21\u5185\u5b58\u91cd\u5206\u914d\u7684\u8bdd\uff0c \u90a3\u4e48\u5149\u662f\u6267\u884c\u5185\u5b58\u91cd\u5206\u914d\u7684\u65f6\u95f4\u5c31\u4f1a\u5360\u53bb\u4fee\u6539\u5b57\u7b26\u4e32\u6240\u7528\u65f6\u95f4\u7684\u4e00\u5927\u90e8\u5206\uff0c \u5982\u679c\u8fd9\u79cd\u4fee\u6539\u9891\u7e41\u5730\u53d1\u751f\u7684\u8bdd\uff0c \u53ef\u80fd\u8fd8\u4f1a\u5bf9\u6027\u80fd\u9020\u6210\u5f71\u54cd\u3002 SDS \u901a\u8fc7\u672a\u4f7f\u7528\u7a7a\u95f4\u89e3\u9664\u4e86\u5b57\u7b26\u4e32\u957f\u5ea6\u548c\u5e95\u5c42\u6570\u7ec4\u957f\u5ea6\u4e4b\u95f4\u7684\u5173\u8054 \uff1a \u5728 SDS \u4e2d\uff0c buf \u6570\u7ec4\u7684\u957f\u5ea6\u4e0d\u4e00\u5b9a\u5c31\u662f\u5b57\u7b26\u6570\u91cf\u52a0\u4e00\uff0c \u6570\u7ec4\u91cc\u9762\u53ef\u4ee5\u5305\u542b\u672a\u4f7f\u7528\u7684\u5b57\u8282\uff0c \u800c\u8fd9\u4e9b\u5b57\u8282\u7684\u6570\u91cf\u5c31\u7531 SDS \u7684 free \u5c5e\u6027\u8bb0\u5f55\u3002 \u901a\u8fc7\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c SDS \u5b9e\u73b0\u4e86\u7a7a\u95f4\u9884\u5206\u914d\u548c\u60f0\u6027\u7a7a\u95f4\u91ca\u653e\u4e24\u79cd\u4f18\u5316\u7b56\u7565\u3002 3.1 \u7a7a\u95f4\u9884\u5206\u914d \u7a7a\u95f4\u9884\u5206\u914d\u7528\u4e8e\u4f18\u5316 SDS \u7684\u5b57\u7b26\u4e32\u589e\u957f\u64cd\u4f5c\uff1a \u5f53 SDS \u7684 API \u5bf9\u4e00\u4e2a SDS \u8fdb\u884c\u4fee\u6539\uff0c \u5e76\u4e14\u9700\u8981\u5bf9 SDS \u8fdb\u884c\u7a7a\u95f4\u6269\u5c55\u7684\u65f6\u5019\uff0c \u7a0b\u5e8f\u4e0d\u4ec5\u4f1a\u4e3a SDS \u5206\u914d\u4fee\u6539\u6240\u5fc5\u987b\u8981\u7684\u7a7a\u95f4\uff0c \u8fd8\u4f1a\u4e3a SDS \u5206\u914d\u989d\u5916\u7684\u672a\u4f7f\u7528\u7a7a\u95f4\u3002 \u5176\u4e2d\uff0c \u989d\u5916\u5206\u914d\u7684\u672a\u4f7f\u7528\u7a7a\u95f4\u6570\u91cf\u7531\u4ee5\u4e0b\u516c\u5f0f\u51b3\u5b9a\uff1a \u5982\u679c\u5bf9 SDS \u8fdb\u884c\u4fee\u6539\u4e4b\u540e\uff0c SDS \u7684\u957f\u5ea6\uff08\u4e5f\u5373\u662f len \u5c5e\u6027\u7684\u503c\uff09\u5c06\u5c0f\u4e8e 1 MB \uff0c \u90a3\u4e48\u7a0b\u5e8f\u5206\u914d\u548c len \u5c5e\u6027\u540c\u6837\u5927\u5c0f\u7684\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c \u8fd9\u65f6 SDS len \u5c5e\u6027\u7684\u503c\u5c06\u548c free \u5c5e\u6027\u7684\u503c\u76f8\u540c\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff0c \u5982\u679c\u8fdb\u884c\u4fee\u6539\u4e4b\u540e\uff0c SDS \u7684 len \u5c06\u53d8\u6210 13 \u5b57\u8282\uff0c \u90a3\u4e48\u7a0b\u5e8f\u4e5f\u4f1a\u5206\u914d 13 \u5b57\u8282\u7684\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c SDS \u7684 buf \u6570\u7ec4\u7684\u5b9e\u9645\u957f\u5ea6\u5c06\u53d8\u6210 13 + 13 + 1 = 27 \u5b57\u8282\uff08\u989d\u5916\u7684\u4e00\u5b57\u8282\u7528\u4e8e\u4fdd\u5b58\u7a7a\u5b57\u7b26\uff09\u3002 \u5982\u679c\u5bf9 SDS \u8fdb\u884c\u4fee\u6539\u4e4b\u540e\uff0c SDS \u7684\u957f\u5ea6\u5c06\u5927\u4e8e\u7b49\u4e8e 1 MB \uff0c \u90a3\u4e48\u7a0b\u5e8f\u4f1a\u5206\u914d 1 MB \u7684\u672a\u4f7f\u7528\u7a7a\u95f4\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff0c \u5982\u679c\u8fdb\u884c\u4fee\u6539\u4e4b\u540e\uff0c SDS \u7684 len \u5c06\u53d8\u6210 30 MB \uff0c \u90a3\u4e48\u7a0b\u5e8f\u4f1a\u5206\u914d 1 MB \u7684\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c SDS \u7684 buf \u6570\u7ec4\u7684\u5b9e\u9645\u957f\u5ea6\u5c06\u4e3a 30 MB + 1 MB + 1 byte \u3002 \u901a\u8fc7\u7a7a\u95f4\u9884\u5206\u914d\u7b56\u7565\uff0c Redis \u53ef\u4ee5\u51cf\u5c11\u8fde\u7eed\u6267\u884c\u5b57\u7b26\u4e32\u589e\u957f\u64cd\u4f5c\u6240\u9700\u7684\u5185\u5b58\u91cd\u5206\u914d\u6b21\u6570\u3002 \u5728\u6269\u5c55 SDS \u7a7a\u95f4\u4e4b\u524d\uff0c SDS API \u4f1a\u5148\u68c0\u67e5\u672a\u4f7f\u7528\u7a7a\u95f4\u662f\u5426\u8db3\u591f\uff0c \u5982\u679c\u8db3\u591f\u7684\u8bdd\uff0c API \u5c31\u4f1a\u76f4\u63a5\u4f7f\u7528\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c \u800c\u65e0\u987b\u6267\u884c\u5185\u5b58\u91cd\u5206\u914d\u3002 \u901a\u8fc7\u8fd9\u79cd\u9884\u5206\u914d\u7b56\u7565\uff0c SDS \u5c06\u8fde\u7eed\u589e\u957f N \u6b21\u5b57\u7b26\u4e32\u6240\u9700\u7684\u5185\u5b58\u91cd\u5206\u914d\u6b21\u6570\u4ece\u5fc5\u5b9a N \u6b21\u964d\u4f4e\u4e3a\u6700\u591a N \u6b21\u3002 3.2 \u60f0\u6027\u7a7a\u95f4\u91ca\u653e \u60f0\u6027\u7a7a\u95f4\u91ca\u653e\u7528\u4e8e\u4f18\u5316 SDS \u7684\u5b57\u7b26\u4e32\u7f29\u77ed\u64cd\u4f5c\uff1a \u5f53 SDS \u7684 API \u9700\u8981\u7f29\u77ed SDS \u4fdd\u5b58\u7684\u5b57\u7b26\u4e32\u65f6\uff0c \u7a0b\u5e8f\u5e76\u4e0d\u7acb\u5373\u4f7f\u7528\u5185\u5b58\u91cd\u5206\u914d\u6765\u56de\u6536\u7f29\u77ed\u540e\u591a\u51fa\u6765\u7684\u5b57\u8282\uff0c \u800c\u662f\u4f7f\u7528 free \u5c5e\u6027\u5c06\u8fd9\u4e9b\u5b57\u8282\u7684\u6570\u91cf\u8bb0\u5f55\u8d77\u6765\uff0c \u5e76\u7b49\u5f85\u5c06\u6765\u4f7f\u7528\u3002 \u901a\u8fc7\u60f0\u6027\u7a7a\u95f4\u91ca\u653e\u7b56\u7565\uff0c SDS \u907f\u514d\u4e86\u7f29\u77ed\u5b57\u7b26\u4e32\u65f6\u6240\u9700\u7684\u5185\u5b58\u91cd\u5206\u914d\u64cd\u4f5c\uff0c \u5e76\u4e3a\u5c06\u6765\u53ef\u80fd\u6709\u7684\u589e\u957f\u64cd\u4f5c\u63d0\u4f9b\u4e86\u4f18\u5316\u3002 \u4e0e\u6b64\u540c\u65f6\uff0c SDS \u4e5f\u63d0\u4f9b\u4e86\u76f8\u5e94\u7684 API \uff0c \u8ba9\u6211\u4eec\u53ef\u4ee5\u5728\u6709\u9700\u8981\u65f6\uff0c \u771f\u6b63\u5730\u91ca\u653e SDS \u91cc\u9762\u7684\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c \u6240\u4ee5\u4e0d\u7528\u62c5\u5fc3\u60f0\u6027\u7a7a\u95f4\u91ca\u653e\u7b56\u7565\u4f1a\u9020\u6210\u5185\u5b58\u6d6a\u8d39\u3002 4 \u4e8c\u8fdb\u5236\u5b89\u5168 C \u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u7b26\u5fc5\u987b\u7b26\u5408\u67d0\u79cd\u7f16\u7801\uff08\u6bd4\u5982 ASCII\uff09\uff0c \u5e76\u4e14\u9664\u4e86\u5b57\u7b26\u4e32\u7684\u672b\u5c3e\u4e4b\u5916\uff0c \u5b57\u7b26\u4e32\u91cc\u9762\u4e0d\u80fd\u5305\u542b\u7a7a\u5b57\u7b26\uff0c \u5426\u5219\u6700\u5148\u88ab\u7a0b\u5e8f\u8bfb\u5165\u7684\u7a7a\u5b57\u7b26\u5c06\u88ab\u8bef\u8ba4\u4e3a\u662f\u5b57\u7b26\u4e32\u7ed3\u5c3e \u2014\u2014 \u8fd9\u4e9b\u9650\u5236\u4f7f\u5f97 C \u5b57\u7b26\u4e32\u53ea\u80fd\u4fdd\u5b58\u6587\u672c\u6570\u636e\uff0c \u800c\u4e0d\u80fd\u4fdd\u5b58\u50cf\u56fe\u7247\u3001\u97f3\u9891\u3001\u89c6\u9891\u3001\u538b\u7f29\u6587\u4ef6\u8fd9\u6837\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002 SDS \u7684 API \u90fd\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\uff08binary-safe\uff09 \uff1a \u6240\u6709 SDS API \u90fd\u4f1a\u4ee5\u5904\u7406\u4e8c\u8fdb\u5236\u7684\u65b9\u5f0f\u6765\u5904\u7406 SDS \u5b58\u653e\u5728 buf \u6570\u7ec4\u91cc\u7684\u6570\u636e\uff0c \u7a0b\u5e8f\u4e0d\u4f1a\u5bf9\u5176\u4e2d\u7684\u6570\u636e\u505a\u4efb\u4f55\u9650\u5236\u3001\u8fc7\u6ee4\u3001\u6216\u8005\u5047\u8bbe \u2014\u2014 \u6570\u636e\u5728\u5199\u5165\u65f6\u662f\u4ec0\u4e48\u6837\u7684\uff0c \u5b83\u88ab\u8bfb\u53d6\u65f6\u5c31\u662f\u4ec0\u4e48\u6837\u3002 \u901a\u8fc7\u4f7f\u7528\u4e8c\u8fdb\u5236\u5b89\u5168\u7684 SDS \uff0c \u800c\u4e0d\u662f C \u5b57\u7b26\u4e32\uff0c \u4f7f\u5f97 Redis \u4e0d\u4ec5\u53ef\u4ee5\u4fdd\u5b58\u6587\u672c\u6570\u636e\uff0c \u8fd8\u53ef\u4ee5\u4fdd\u5b58\u4efb\u610f\u683c\u5f0f\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002 5 \u517c\u5bb9\u90e8\u5206 C \u5b57\u7b26\u4e32\u51fd\u6570 \u867d\u7136 SDS \u7684 API \u90fd\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\uff0c \u4f46\u5b83\u4eec\u4e00\u6837\u9075\u5faa C \u5b57\u7b26\u4e32\u4ee5\u7a7a\u5b57\u7b26\u7ed3\u5c3e\u7684\u60ef\u4f8b\uff1a \u8fd9\u4e9b API \u603b\u4f1a\u5c06 SDS \u4fdd\u5b58\u7684\u6570\u636e\u7684\u672b\u5c3e\u8bbe\u7f6e\u4e3a\u7a7a\u5b57\u7b26\uff0c \u5e76\u4e14\u603b\u4f1a\u5728\u4e3a buf \u6570\u7ec4\u5206\u914d\u7a7a\u95f4\u65f6\u591a\u5206\u914d\u4e00\u4e2a\u5b57\u8282\u6765\u5bb9\u7eb3\u8fd9\u4e2a\u7a7a\u5b57\u7b26\uff0c \u8fd9\u662f\u4e3a\u4e86\u8ba9\u90a3\u4e9b\u4fdd\u5b58\u6587\u672c\u6570\u636e\u7684 SDS \u53ef\u4ee5\u91cd\u7528\u4e00\u90e8\u5206 <string.h> \u5e93\u5b9a\u4e49\u7684\u51fd\u6570\u3002 \u603b\u7ed3 C \u5b57\u7b26\u4e32 SDS \u83b7\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6\u7684\u590d\u6742\u5ea6\u4e3a O(N) \u3002 \u83b7\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6\u7684\u590d\u6742\u5ea6\u4e3a O(1) \u3002 API \u662f\u4e0d\u5b89\u5168\u7684\uff0c\u53ef\u80fd\u4f1a\u9020\u6210\u7f13\u51b2\u533a\u6ea2\u51fa\u3002 API \u662f\u5b89\u5168\u7684\uff0c\u4e0d\u4f1a\u9020\u6210\u7f13\u51b2\u533a\u6ea2\u51fa\u3002 \u4fee\u6539\u5b57\u7b26\u4e32\u957f\u5ea6 N \u6b21\u5fc5\u7136\u9700\u8981\u6267\u884c N \u6b21\u5185\u5b58\u91cd\u5206\u914d\u3002 \u4fee\u6539\u5b57\u7b26\u4e32\u957f\u5ea6 N \u6b21\u6700\u591a\u9700\u8981\u6267\u884c N \u6b21\u5185\u5b58\u91cd\u5206\u914d\u3002 \u53ea\u80fd\u4fdd\u5b58\u6587\u672c\u6570\u636e\u3002 \u53ef\u4ee5\u4fdd\u5b58\u6587\u672c\u6216\u8005\u4e8c\u8fdb\u5236\u6570\u636e\u3002 \u53ef\u4ee5\u4f7f\u7528\u6240\u6709 <string.h> \u5e93\u4e2d\u7684\u51fd\u6570\u3002 \u53ef\u4ee5\u4f7f\u7528\u4e00\u90e8\u5206 <string.h> \u5e93\u4e2d\u7684\u51fd\u6570\u3002","title":"2.1 SDS \u4e0e C \u4e32\u7684\u533a\u522b"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.2-SDS%20%E4%B8%8E%20C%20%E4%B8%B2%E7%9A%84%E5%8C%BA%E5%88%AB/#21-sds-c","text":"","title":"2.1 SDS \u4e0e C \u4e32\u7684\u533a\u522b"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.2-SDS%20%E4%B8%8E%20C%20%E4%B8%B2%E7%9A%84%E5%8C%BA%E5%88%AB/#1","text":"\u56e0\u4e3a\u5b57\u7b26\u4e32\u952e\u5728\u5e95\u5c42\u4f7f\u7528 SDS \u6765\u5b9e\u73b0\uff0c \u6240\u4ee5\u5373\u4f7f\u6211\u4eec\u5bf9\u4e00\u4e2a\u975e\u5e38\u957f\u7684\u5b57\u7b26\u4e32\u952e\u53cd\u590d\u6267\u884c STRLEN \u547d\u4ee4\uff0c \u4e5f\u4e0d\u4f1a\u5bf9\u7cfb\u7edf\u6027\u80fd\u9020\u6210\u4efb\u4f55\u5f71\u54cd\uff0c \u56e0\u4e3a STRLEN \u547d\u4ee4\u7684\u590d\u6742\u5ea6\u4ec5\u4e3a O(1) \u3002","title":"1 \u5e38\u6570\u590d\u6742\u5ea6\u83b7\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.2-SDS%20%E4%B8%8E%20C%20%E4%B8%B2%E7%9A%84%E5%8C%BA%E5%88%AB/#2","text":"\u4e0e C \u5b57\u7b26\u4e32\u4e0d\u540c\uff0c SDS \u7684\u7a7a\u95f4\u5206\u914d\u7b56\u7565\u5b8c\u5168\u675c\u7edd\u4e86\u53d1\u751f\u7f13\u51b2\u533a\u6ea2\u51fa\u7684\u53ef\u80fd\u6027\uff1a \u5f53 SDS API \u9700\u8981\u5bf9 SDS \u8fdb\u884c\u4fee\u6539\u65f6\uff0c API \u4f1a\u5148\u68c0\u67e5 SDS \u7684\u7a7a\u95f4\u662f\u5426\u6ee1\u8db3\u4fee\u6539\u6240\u9700\u7684\u8981\u6c42\uff0c \u5982\u679c\u4e0d\u6ee1\u8db3\u7684\u8bdd\uff0c API \u4f1a\u81ea\u52a8\u5c06 SDS \u7684\u7a7a\u95f4\u6269\u5c55\u81f3\u6267\u884c\u4fee\u6539\u6240\u9700\u7684\u5927\u5c0f\uff0c \u7136\u540e\u624d\u6267\u884c\u5b9e\u9645\u7684\u4fee\u6539\u64cd\u4f5c\uff0c \u6240\u4ee5\u4f7f\u7528 SDS \u65e2\u4e0d\u9700\u8981\u624b\u52a8\u4fee\u6539 SDS \u7684\u7a7a\u95f4\u5927\u5c0f\uff0c \u4e5f\u4e0d\u4f1a\u51fa\u73b0\u524d\u9762\u6240\u8bf4\u7684\u7f13\u51b2\u533a\u6ea2\u51fa\u95ee\u9898\u3002 SDS \u7684 API \u91cc\u9762\u4e5f\u6709\u4e00\u4e2a\u7528\u4e8e\u6267\u884c\u62fc\u63a5\u64cd\u4f5c\u7684 sdscat \u51fd\u6570","title":"2 \u675c\u7edd\u7f13\u51b2\u533a\u6ea2\u51fa"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.2-SDS%20%E4%B8%8E%20C%20%E4%B8%B2%E7%9A%84%E5%8C%BA%E5%88%AB/#3","text":"\u56e0\u4e3a C \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u548c\u5e95\u5c42\u6570\u7ec4\u7684\u957f\u5ea6\u4e4b\u95f4\u5b58\u5728\u7740\u8fd9\u79cd\u5173\u8054\u6027\uff0c \u6240\u4ee5\u6bcf\u6b21\u589e\u957f\u6216\u8005\u7f29\u77ed\u4e00\u4e2a C \u5b57\u7b26\u4e32\uff0c \u7a0b\u5e8f\u90fd\u603b\u8981\u5bf9\u4fdd\u5b58\u8fd9\u4e2a C \u5b57\u7b26\u4e32\u7684\u6570\u7ec4\u8fdb\u884c\u4e00\u6b21\u5185\u5b58\u91cd\u5206\u914d\u64cd\u4f5c\uff1a \u5982\u679c\u7a0b\u5e8f\u6267\u884c\u7684\u662f\u589e\u957f\u5b57\u7b26\u4e32\u7684\u64cd\u4f5c\uff0c \u6bd4\u5982\u62fc\u63a5\u64cd\u4f5c\uff08append\uff09\uff0c \u90a3\u4e48\u5728\u6267\u884c\u8fd9\u4e2a\u64cd\u4f5c\u4e4b\u524d\uff0c \u7a0b\u5e8f\u9700\u8981\u5148\u901a\u8fc7\u5185\u5b58\u91cd\u5206\u914d\u6765\u6269\u5c55\u5e95\u5c42\u6570\u7ec4\u7684\u7a7a\u95f4\u5927\u5c0f \u2014\u2014 \u5982\u679c\u5fd8\u4e86\u8fd9\u4e00\u6b65\u5c31\u4f1a\u4ea7\u751f\u7f13\u51b2\u533a\u6ea2\u51fa \u3002 \u5982\u679c\u7a0b\u5e8f\u6267\u884c\u7684\u662f\u7f29\u77ed\u5b57\u7b26\u4e32\u7684\u64cd\u4f5c\uff0c \u6bd4\u5982\u622a\u65ad\u64cd\u4f5c\uff08trim\uff09\uff0c \u90a3\u4e48\u5728\u6267\u884c\u8fd9\u4e2a\u64cd\u4f5c\u4e4b\u540e\uff0c \u7a0b\u5e8f\u9700\u8981\u901a\u8fc7\u5185\u5b58\u91cd\u5206\u914d\u6765\u91ca\u653e\u5b57\u7b26\u4e32\u4e0d\u518d\u4f7f\u7528\u7684\u90a3\u90e8\u5206\u7a7a\u95f4 \u2014\u2014 \u5982\u679c\u5fd8\u4e86\u8fd9\u4e00\u6b65\u5c31\u4f1a\u4ea7\u751f\u5185\u5b58\u6cc4\u6f0f \u3002 \u56e0\u4e3a\u5185\u5b58\u91cd\u5206\u914d\u6d89\u53ca\u590d\u6742\u7684\u7b97\u6cd5\uff0c \u5e76\u4e14\u53ef\u80fd\u9700\u8981\u6267\u884c\u7cfb\u7edf\u8c03\u7528\uff0c \u6240\u4ee5\u5b83\u901a\u5e38\u662f\u4e00\u4e2a\u6bd4\u8f83\u8017\u65f6\u7684\u64cd\u4f5c\uff1a \u5728\u4e00\u822c\u7a0b\u5e8f\u4e2d\uff0c \u5982\u679c\u4fee\u6539\u5b57\u7b26\u4e32\u957f\u5ea6\u7684\u60c5\u51b5\u4e0d\u592a\u5e38\u51fa\u73b0\uff0c \u90a3\u4e48\u6bcf\u6b21\u4fee\u6539\u90fd\u6267\u884c\u4e00\u6b21\u5185\u5b58\u91cd\u5206\u914d\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002 \u4f46\u662f Redis \u4f5c\u4e3a\u6570\u636e\u5e93\uff0c \u7ecf\u5e38\u88ab\u7528\u4e8e\u901f\u5ea6\u8981\u6c42\u4e25\u82db\u3001\u6570\u636e\u88ab\u9891\u7e41\u4fee\u6539\u7684\u573a\u5408\uff0c \u5982\u679c\u6bcf\u6b21\u4fee\u6539\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u90fd\u9700\u8981\u6267\u884c\u4e00\u6b21\u5185\u5b58\u91cd\u5206\u914d\u7684\u8bdd\uff0c \u90a3\u4e48\u5149\u662f\u6267\u884c\u5185\u5b58\u91cd\u5206\u914d\u7684\u65f6\u95f4\u5c31\u4f1a\u5360\u53bb\u4fee\u6539\u5b57\u7b26\u4e32\u6240\u7528\u65f6\u95f4\u7684\u4e00\u5927\u90e8\u5206\uff0c \u5982\u679c\u8fd9\u79cd\u4fee\u6539\u9891\u7e41\u5730\u53d1\u751f\u7684\u8bdd\uff0c \u53ef\u80fd\u8fd8\u4f1a\u5bf9\u6027\u80fd\u9020\u6210\u5f71\u54cd\u3002 SDS \u901a\u8fc7\u672a\u4f7f\u7528\u7a7a\u95f4\u89e3\u9664\u4e86\u5b57\u7b26\u4e32\u957f\u5ea6\u548c\u5e95\u5c42\u6570\u7ec4\u957f\u5ea6\u4e4b\u95f4\u7684\u5173\u8054 \uff1a \u5728 SDS \u4e2d\uff0c buf \u6570\u7ec4\u7684\u957f\u5ea6\u4e0d\u4e00\u5b9a\u5c31\u662f\u5b57\u7b26\u6570\u91cf\u52a0\u4e00\uff0c \u6570\u7ec4\u91cc\u9762\u53ef\u4ee5\u5305\u542b\u672a\u4f7f\u7528\u7684\u5b57\u8282\uff0c \u800c\u8fd9\u4e9b\u5b57\u8282\u7684\u6570\u91cf\u5c31\u7531 SDS \u7684 free \u5c5e\u6027\u8bb0\u5f55\u3002 \u901a\u8fc7\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c SDS \u5b9e\u73b0\u4e86\u7a7a\u95f4\u9884\u5206\u914d\u548c\u60f0\u6027\u7a7a\u95f4\u91ca\u653e\u4e24\u79cd\u4f18\u5316\u7b56\u7565\u3002","title":"3 \u51cf\u5c11\u4fee\u6539\u5b57\u7b26\u4e32\u65f6\u5e26\u6765\u7684\u5185\u5b58\u91cd\u5206\u914d\u6b21\u6570"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.2-SDS%20%E4%B8%8E%20C%20%E4%B8%B2%E7%9A%84%E5%8C%BA%E5%88%AB/#31","text":"\u7a7a\u95f4\u9884\u5206\u914d\u7528\u4e8e\u4f18\u5316 SDS \u7684\u5b57\u7b26\u4e32\u589e\u957f\u64cd\u4f5c\uff1a \u5f53 SDS \u7684 API \u5bf9\u4e00\u4e2a SDS \u8fdb\u884c\u4fee\u6539\uff0c \u5e76\u4e14\u9700\u8981\u5bf9 SDS \u8fdb\u884c\u7a7a\u95f4\u6269\u5c55\u7684\u65f6\u5019\uff0c \u7a0b\u5e8f\u4e0d\u4ec5\u4f1a\u4e3a SDS \u5206\u914d\u4fee\u6539\u6240\u5fc5\u987b\u8981\u7684\u7a7a\u95f4\uff0c \u8fd8\u4f1a\u4e3a SDS \u5206\u914d\u989d\u5916\u7684\u672a\u4f7f\u7528\u7a7a\u95f4\u3002 \u5176\u4e2d\uff0c \u989d\u5916\u5206\u914d\u7684\u672a\u4f7f\u7528\u7a7a\u95f4\u6570\u91cf\u7531\u4ee5\u4e0b\u516c\u5f0f\u51b3\u5b9a\uff1a \u5982\u679c\u5bf9 SDS \u8fdb\u884c\u4fee\u6539\u4e4b\u540e\uff0c SDS \u7684\u957f\u5ea6\uff08\u4e5f\u5373\u662f len \u5c5e\u6027\u7684\u503c\uff09\u5c06\u5c0f\u4e8e 1 MB \uff0c \u90a3\u4e48\u7a0b\u5e8f\u5206\u914d\u548c len \u5c5e\u6027\u540c\u6837\u5927\u5c0f\u7684\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c \u8fd9\u65f6 SDS len \u5c5e\u6027\u7684\u503c\u5c06\u548c free \u5c5e\u6027\u7684\u503c\u76f8\u540c\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff0c \u5982\u679c\u8fdb\u884c\u4fee\u6539\u4e4b\u540e\uff0c SDS \u7684 len \u5c06\u53d8\u6210 13 \u5b57\u8282\uff0c \u90a3\u4e48\u7a0b\u5e8f\u4e5f\u4f1a\u5206\u914d 13 \u5b57\u8282\u7684\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c SDS \u7684 buf \u6570\u7ec4\u7684\u5b9e\u9645\u957f\u5ea6\u5c06\u53d8\u6210 13 + 13 + 1 = 27 \u5b57\u8282\uff08\u989d\u5916\u7684\u4e00\u5b57\u8282\u7528\u4e8e\u4fdd\u5b58\u7a7a\u5b57\u7b26\uff09\u3002 \u5982\u679c\u5bf9 SDS \u8fdb\u884c\u4fee\u6539\u4e4b\u540e\uff0c SDS \u7684\u957f\u5ea6\u5c06\u5927\u4e8e\u7b49\u4e8e 1 MB \uff0c \u90a3\u4e48\u7a0b\u5e8f\u4f1a\u5206\u914d 1 MB \u7684\u672a\u4f7f\u7528\u7a7a\u95f4\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff0c \u5982\u679c\u8fdb\u884c\u4fee\u6539\u4e4b\u540e\uff0c SDS \u7684 len \u5c06\u53d8\u6210 30 MB \uff0c \u90a3\u4e48\u7a0b\u5e8f\u4f1a\u5206\u914d 1 MB \u7684\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c SDS \u7684 buf \u6570\u7ec4\u7684\u5b9e\u9645\u957f\u5ea6\u5c06\u4e3a 30 MB + 1 MB + 1 byte \u3002 \u901a\u8fc7\u7a7a\u95f4\u9884\u5206\u914d\u7b56\u7565\uff0c Redis \u53ef\u4ee5\u51cf\u5c11\u8fde\u7eed\u6267\u884c\u5b57\u7b26\u4e32\u589e\u957f\u64cd\u4f5c\u6240\u9700\u7684\u5185\u5b58\u91cd\u5206\u914d\u6b21\u6570\u3002 \u5728\u6269\u5c55 SDS \u7a7a\u95f4\u4e4b\u524d\uff0c SDS API \u4f1a\u5148\u68c0\u67e5\u672a\u4f7f\u7528\u7a7a\u95f4\u662f\u5426\u8db3\u591f\uff0c \u5982\u679c\u8db3\u591f\u7684\u8bdd\uff0c API \u5c31\u4f1a\u76f4\u63a5\u4f7f\u7528\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c \u800c\u65e0\u987b\u6267\u884c\u5185\u5b58\u91cd\u5206\u914d\u3002 \u901a\u8fc7\u8fd9\u79cd\u9884\u5206\u914d\u7b56\u7565\uff0c SDS \u5c06\u8fde\u7eed\u589e\u957f N \u6b21\u5b57\u7b26\u4e32\u6240\u9700\u7684\u5185\u5b58\u91cd\u5206\u914d\u6b21\u6570\u4ece\u5fc5\u5b9a N \u6b21\u964d\u4f4e\u4e3a\u6700\u591a N \u6b21\u3002","title":"3.1 \u7a7a\u95f4\u9884\u5206\u914d"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.2-SDS%20%E4%B8%8E%20C%20%E4%B8%B2%E7%9A%84%E5%8C%BA%E5%88%AB/#32","text":"\u60f0\u6027\u7a7a\u95f4\u91ca\u653e\u7528\u4e8e\u4f18\u5316 SDS \u7684\u5b57\u7b26\u4e32\u7f29\u77ed\u64cd\u4f5c\uff1a \u5f53 SDS \u7684 API \u9700\u8981\u7f29\u77ed SDS \u4fdd\u5b58\u7684\u5b57\u7b26\u4e32\u65f6\uff0c \u7a0b\u5e8f\u5e76\u4e0d\u7acb\u5373\u4f7f\u7528\u5185\u5b58\u91cd\u5206\u914d\u6765\u56de\u6536\u7f29\u77ed\u540e\u591a\u51fa\u6765\u7684\u5b57\u8282\uff0c \u800c\u662f\u4f7f\u7528 free \u5c5e\u6027\u5c06\u8fd9\u4e9b\u5b57\u8282\u7684\u6570\u91cf\u8bb0\u5f55\u8d77\u6765\uff0c \u5e76\u7b49\u5f85\u5c06\u6765\u4f7f\u7528\u3002 \u901a\u8fc7\u60f0\u6027\u7a7a\u95f4\u91ca\u653e\u7b56\u7565\uff0c SDS \u907f\u514d\u4e86\u7f29\u77ed\u5b57\u7b26\u4e32\u65f6\u6240\u9700\u7684\u5185\u5b58\u91cd\u5206\u914d\u64cd\u4f5c\uff0c \u5e76\u4e3a\u5c06\u6765\u53ef\u80fd\u6709\u7684\u589e\u957f\u64cd\u4f5c\u63d0\u4f9b\u4e86\u4f18\u5316\u3002 \u4e0e\u6b64\u540c\u65f6\uff0c SDS \u4e5f\u63d0\u4f9b\u4e86\u76f8\u5e94\u7684 API \uff0c \u8ba9\u6211\u4eec\u53ef\u4ee5\u5728\u6709\u9700\u8981\u65f6\uff0c \u771f\u6b63\u5730\u91ca\u653e SDS \u91cc\u9762\u7684\u672a\u4f7f\u7528\u7a7a\u95f4\uff0c \u6240\u4ee5\u4e0d\u7528\u62c5\u5fc3\u60f0\u6027\u7a7a\u95f4\u91ca\u653e\u7b56\u7565\u4f1a\u9020\u6210\u5185\u5b58\u6d6a\u8d39\u3002","title":"3.2 \u60f0\u6027\u7a7a\u95f4\u91ca\u653e"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.2-SDS%20%E4%B8%8E%20C%20%E4%B8%B2%E7%9A%84%E5%8C%BA%E5%88%AB/#4","text":"C \u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u7b26\u5fc5\u987b\u7b26\u5408\u67d0\u79cd\u7f16\u7801\uff08\u6bd4\u5982 ASCII\uff09\uff0c \u5e76\u4e14\u9664\u4e86\u5b57\u7b26\u4e32\u7684\u672b\u5c3e\u4e4b\u5916\uff0c \u5b57\u7b26\u4e32\u91cc\u9762\u4e0d\u80fd\u5305\u542b\u7a7a\u5b57\u7b26\uff0c \u5426\u5219\u6700\u5148\u88ab\u7a0b\u5e8f\u8bfb\u5165\u7684\u7a7a\u5b57\u7b26\u5c06\u88ab\u8bef\u8ba4\u4e3a\u662f\u5b57\u7b26\u4e32\u7ed3\u5c3e \u2014\u2014 \u8fd9\u4e9b\u9650\u5236\u4f7f\u5f97 C \u5b57\u7b26\u4e32\u53ea\u80fd\u4fdd\u5b58\u6587\u672c\u6570\u636e\uff0c \u800c\u4e0d\u80fd\u4fdd\u5b58\u50cf\u56fe\u7247\u3001\u97f3\u9891\u3001\u89c6\u9891\u3001\u538b\u7f29\u6587\u4ef6\u8fd9\u6837\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002 SDS \u7684 API \u90fd\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\uff08binary-safe\uff09 \uff1a \u6240\u6709 SDS API \u90fd\u4f1a\u4ee5\u5904\u7406\u4e8c\u8fdb\u5236\u7684\u65b9\u5f0f\u6765\u5904\u7406 SDS \u5b58\u653e\u5728 buf \u6570\u7ec4\u91cc\u7684\u6570\u636e\uff0c \u7a0b\u5e8f\u4e0d\u4f1a\u5bf9\u5176\u4e2d\u7684\u6570\u636e\u505a\u4efb\u4f55\u9650\u5236\u3001\u8fc7\u6ee4\u3001\u6216\u8005\u5047\u8bbe \u2014\u2014 \u6570\u636e\u5728\u5199\u5165\u65f6\u662f\u4ec0\u4e48\u6837\u7684\uff0c \u5b83\u88ab\u8bfb\u53d6\u65f6\u5c31\u662f\u4ec0\u4e48\u6837\u3002 \u901a\u8fc7\u4f7f\u7528\u4e8c\u8fdb\u5236\u5b89\u5168\u7684 SDS \uff0c \u800c\u4e0d\u662f C \u5b57\u7b26\u4e32\uff0c \u4f7f\u5f97 Redis \u4e0d\u4ec5\u53ef\u4ee5\u4fdd\u5b58\u6587\u672c\u6570\u636e\uff0c \u8fd8\u53ef\u4ee5\u4fdd\u5b58\u4efb\u610f\u683c\u5f0f\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002","title":"4 \u4e8c\u8fdb\u5236\u5b89\u5168"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.2-SDS%20%E4%B8%8E%20C%20%E4%B8%B2%E7%9A%84%E5%8C%BA%E5%88%AB/#5-c","text":"\u867d\u7136 SDS \u7684 API \u90fd\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\uff0c \u4f46\u5b83\u4eec\u4e00\u6837\u9075\u5faa C \u5b57\u7b26\u4e32\u4ee5\u7a7a\u5b57\u7b26\u7ed3\u5c3e\u7684\u60ef\u4f8b\uff1a \u8fd9\u4e9b API \u603b\u4f1a\u5c06 SDS \u4fdd\u5b58\u7684\u6570\u636e\u7684\u672b\u5c3e\u8bbe\u7f6e\u4e3a\u7a7a\u5b57\u7b26\uff0c \u5e76\u4e14\u603b\u4f1a\u5728\u4e3a buf \u6570\u7ec4\u5206\u914d\u7a7a\u95f4\u65f6\u591a\u5206\u914d\u4e00\u4e2a\u5b57\u8282\u6765\u5bb9\u7eb3\u8fd9\u4e2a\u7a7a\u5b57\u7b26\uff0c \u8fd9\u662f\u4e3a\u4e86\u8ba9\u90a3\u4e9b\u4fdd\u5b58\u6587\u672c\u6570\u636e\u7684 SDS \u53ef\u4ee5\u91cd\u7528\u4e00\u90e8\u5206 <string.h> \u5e93\u5b9a\u4e49\u7684\u51fd\u6570\u3002","title":"5 \u517c\u5bb9\u90e8\u5206 C \u5b57\u7b26\u4e32\u51fd\u6570"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.2-SDS%20%E4%B8%8E%20C%20%E4%B8%B2%E7%9A%84%E5%8C%BA%E5%88%AB/#_1","text":"C \u5b57\u7b26\u4e32 SDS \u83b7\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6\u7684\u590d\u6742\u5ea6\u4e3a O(N) \u3002 \u83b7\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6\u7684\u590d\u6742\u5ea6\u4e3a O(1) \u3002 API \u662f\u4e0d\u5b89\u5168\u7684\uff0c\u53ef\u80fd\u4f1a\u9020\u6210\u7f13\u51b2\u533a\u6ea2\u51fa\u3002 API \u662f\u5b89\u5168\u7684\uff0c\u4e0d\u4f1a\u9020\u6210\u7f13\u51b2\u533a\u6ea2\u51fa\u3002 \u4fee\u6539\u5b57\u7b26\u4e32\u957f\u5ea6 N \u6b21\u5fc5\u7136\u9700\u8981\u6267\u884c N \u6b21\u5185\u5b58\u91cd\u5206\u914d\u3002 \u4fee\u6539\u5b57\u7b26\u4e32\u957f\u5ea6 N \u6b21\u6700\u591a\u9700\u8981\u6267\u884c N \u6b21\u5185\u5b58\u91cd\u5206\u914d\u3002 \u53ea\u80fd\u4fdd\u5b58\u6587\u672c\u6570\u636e\u3002 \u53ef\u4ee5\u4fdd\u5b58\u6587\u672c\u6216\u8005\u4e8c\u8fdb\u5236\u6570\u636e\u3002 \u53ef\u4ee5\u4f7f\u7528\u6240\u6709 <string.h> \u5e93\u4e2d\u7684\u51fd\u6570\u3002 \u53ef\u4ee5\u4f7f\u7528\u4e00\u90e8\u5206 <string.h> \u5e93\u4e2d\u7684\u51fd\u6570\u3002","title":"\u603b\u7ed3"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.3-SDS%20API/","text":"2.3 SDS API \u51fd\u6570 \u51fd\u6570 \u4f5c\u7528 \u65f6\u95f4\u590d\u6742\u5ea6 sdsnew \u521b\u5efa\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a C \u5b57\u7b26\u4e32\u7684 SDS \u3002 O(N) \uff0c N \u4e3a\u7ed9\u5b9a C \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 sdsempty \u521b\u5efa\u4e00\u4e2a\u4e0d\u5305\u542b\u4efb\u4f55\u5185\u5bb9\u7684\u7a7a SDS \u3002 O(1) sdsfree \u91ca\u653e\u7ed9\u5b9a\u7684 SDS \u3002 O(1) sdslen \u8fd4\u56de SDS \u7684\u5df2\u4f7f\u7528\u7a7a\u95f4\u5b57\u8282\u6570\u3002 \u8fd9\u4e2a\u503c\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6 SDS \u7684 len \u5c5e\u6027\u6765\u76f4\u63a5\u83b7\u5f97\uff0c \u590d\u6742\u5ea6\u4e3a O(1) \u3002 sdsavail \u8fd4\u56de SDS \u7684\u672a\u4f7f\u7528\u7a7a\u95f4\u5b57\u8282\u6570\u3002 \u8fd9\u4e2a\u503c\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6 SDS \u7684 free \u5c5e\u6027\u6765\u76f4\u63a5\u83b7\u5f97\uff0c \u590d\u6742\u5ea6\u4e3a O(1) \u3002 sdsdup \u521b\u5efa\u4e00\u4e2a\u7ed9\u5b9a SDS \u7684\u526f\u672c\uff08copy\uff09\u3002 O(N) \uff0c N \u4e3a\u7ed9\u5b9a SDS \u7684\u957f\u5ea6\u3002 sdsclear \u6e05\u7a7a SDS \u4fdd\u5b58\u7684\u5b57\u7b26\u4e32\u5185\u5bb9\u3002 \u56e0\u4e3a\u60f0\u6027\u7a7a\u95f4\u91ca\u653e\u7b56\u7565\uff0c\u590d\u6742\u5ea6\u4e3a O(1) \u3002 sdscat \u5c06\u7ed9\u5b9a C \u5b57\u7b26\u4e32\u62fc\u63a5\u5230 SDS \u5b57\u7b26\u4e32\u7684\u672b\u5c3e\u3002 O(N) \uff0c N \u4e3a\u88ab\u62fc\u63a5 C \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 sdscatsds \u5c06\u7ed9\u5b9a SDS \u5b57\u7b26\u4e32\u62fc\u63a5\u5230\u53e6\u4e00\u4e2a SDS \u5b57\u7b26\u4e32\u7684\u672b\u5c3e\u3002 O(N) \uff0c N \u4e3a\u88ab\u62fc\u63a5 SDS \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 sdscpy \u5c06\u7ed9\u5b9a\u7684 C \u5b57\u7b26\u4e32\u590d\u5236\u5230 SDS \u91cc\u9762\uff0c \u8986\u76d6 SDS \u539f\u6709\u7684\u5b57\u7b26\u4e32\u3002 O(N) \uff0c N \u4e3a\u88ab\u590d\u5236 C \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 sdsgrowzero \u7528\u7a7a\u5b57\u7b26\u5c06 SDS \u6269\u5c55\u81f3\u7ed9\u5b9a\u957f\u5ea6\u3002 O(N) \uff0c N \u4e3a\u6269\u5c55\u65b0\u589e\u7684\u5b57\u8282\u6570\u3002 sdsrange \u4fdd\u7559 SDS \u7ed9\u5b9a\u533a\u95f4\u5185\u7684\u6570\u636e\uff0c \u4e0d\u5728\u533a\u95f4\u5185\u7684\u6570\u636e\u4f1a\u88ab\u8986\u76d6\u6216\u6e05\u9664\u3002 O(N) \uff0c N \u4e3a\u88ab\u4fdd\u7559\u6570\u636e\u7684\u5b57\u8282\u6570\u3002 sdstrim \u63a5\u53d7\u4e00\u4e2a SDS \u548c\u4e00\u4e2a C \u5b57\u7b26\u4e32\u4f5c\u4e3a\u53c2\u6570\uff0c \u4ece SDS \u5de6\u53f3\u4e24\u7aef\u5206\u522b\u79fb\u9664\u6240\u6709\u5728 C \u5b57\u7b26\u4e32\u4e2d\u51fa\u73b0\u8fc7\u7684\u5b57\u7b26\u3002 O(M*N) \uff0c M \u4e3a SDS \u7684\u957f\u5ea6\uff0c N \u4e3a\u7ed9\u5b9a C \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 sdscmp \u5bf9\u6bd4\u4e24\u4e2a SDS \u5b57\u7b26\u4e32\u662f\u5426\u76f8\u540c\u3002 O(N) \uff0c N \u4e3a\u4e24\u4e2a SDS \u4e2d\u8f83\u77ed\u7684\u90a3\u4e2a SDS \u7684\u957f\u5ea6\u3002","title":"2.3 SDS API \u51fd\u6570"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.3-SDS%20API/#23-sds-api","text":"\u51fd\u6570 \u4f5c\u7528 \u65f6\u95f4\u590d\u6742\u5ea6 sdsnew \u521b\u5efa\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a C \u5b57\u7b26\u4e32\u7684 SDS \u3002 O(N) \uff0c N \u4e3a\u7ed9\u5b9a C \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 sdsempty \u521b\u5efa\u4e00\u4e2a\u4e0d\u5305\u542b\u4efb\u4f55\u5185\u5bb9\u7684\u7a7a SDS \u3002 O(1) sdsfree \u91ca\u653e\u7ed9\u5b9a\u7684 SDS \u3002 O(1) sdslen \u8fd4\u56de SDS \u7684\u5df2\u4f7f\u7528\u7a7a\u95f4\u5b57\u8282\u6570\u3002 \u8fd9\u4e2a\u503c\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6 SDS \u7684 len \u5c5e\u6027\u6765\u76f4\u63a5\u83b7\u5f97\uff0c \u590d\u6742\u5ea6\u4e3a O(1) \u3002 sdsavail \u8fd4\u56de SDS \u7684\u672a\u4f7f\u7528\u7a7a\u95f4\u5b57\u8282\u6570\u3002 \u8fd9\u4e2a\u503c\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6 SDS \u7684 free \u5c5e\u6027\u6765\u76f4\u63a5\u83b7\u5f97\uff0c \u590d\u6742\u5ea6\u4e3a O(1) \u3002 sdsdup \u521b\u5efa\u4e00\u4e2a\u7ed9\u5b9a SDS \u7684\u526f\u672c\uff08copy\uff09\u3002 O(N) \uff0c N \u4e3a\u7ed9\u5b9a SDS \u7684\u957f\u5ea6\u3002 sdsclear \u6e05\u7a7a SDS \u4fdd\u5b58\u7684\u5b57\u7b26\u4e32\u5185\u5bb9\u3002 \u56e0\u4e3a\u60f0\u6027\u7a7a\u95f4\u91ca\u653e\u7b56\u7565\uff0c\u590d\u6742\u5ea6\u4e3a O(1) \u3002 sdscat \u5c06\u7ed9\u5b9a C \u5b57\u7b26\u4e32\u62fc\u63a5\u5230 SDS \u5b57\u7b26\u4e32\u7684\u672b\u5c3e\u3002 O(N) \uff0c N \u4e3a\u88ab\u62fc\u63a5 C \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 sdscatsds \u5c06\u7ed9\u5b9a SDS \u5b57\u7b26\u4e32\u62fc\u63a5\u5230\u53e6\u4e00\u4e2a SDS \u5b57\u7b26\u4e32\u7684\u672b\u5c3e\u3002 O(N) \uff0c N \u4e3a\u88ab\u62fc\u63a5 SDS \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 sdscpy \u5c06\u7ed9\u5b9a\u7684 C \u5b57\u7b26\u4e32\u590d\u5236\u5230 SDS \u91cc\u9762\uff0c \u8986\u76d6 SDS \u539f\u6709\u7684\u5b57\u7b26\u4e32\u3002 O(N) \uff0c N \u4e3a\u88ab\u590d\u5236 C \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 sdsgrowzero \u7528\u7a7a\u5b57\u7b26\u5c06 SDS \u6269\u5c55\u81f3\u7ed9\u5b9a\u957f\u5ea6\u3002 O(N) \uff0c N \u4e3a\u6269\u5c55\u65b0\u589e\u7684\u5b57\u8282\u6570\u3002 sdsrange \u4fdd\u7559 SDS \u7ed9\u5b9a\u533a\u95f4\u5185\u7684\u6570\u636e\uff0c \u4e0d\u5728\u533a\u95f4\u5185\u7684\u6570\u636e\u4f1a\u88ab\u8986\u76d6\u6216\u6e05\u9664\u3002 O(N) \uff0c N \u4e3a\u88ab\u4fdd\u7559\u6570\u636e\u7684\u5b57\u8282\u6570\u3002 sdstrim \u63a5\u53d7\u4e00\u4e2a SDS \u548c\u4e00\u4e2a C \u5b57\u7b26\u4e32\u4f5c\u4e3a\u53c2\u6570\uff0c \u4ece SDS \u5de6\u53f3\u4e24\u7aef\u5206\u522b\u79fb\u9664\u6240\u6709\u5728 C \u5b57\u7b26\u4e32\u4e2d\u51fa\u73b0\u8fc7\u7684\u5b57\u7b26\u3002 O(M*N) \uff0c M \u4e3a SDS \u7684\u957f\u5ea6\uff0c N \u4e3a\u7ed9\u5b9a C \u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u3002 sdscmp \u5bf9\u6bd4\u4e24\u4e2a SDS \u5b57\u7b26\u4e32\u662f\u5426\u76f8\u540c\u3002 O(N) \uff0c N \u4e3a\u4e24\u4e2a SDS \u4e2d\u8f83\u77ed\u7684\u90a3\u4e2a SDS \u7684\u957f\u5ea6\u3002","title":"2.3 SDS API \u51fd\u6570"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/3.0-%E9%93%BE%E8%A1%A8/","text":"3 \u94fe\u8868 \u94fe\u8868\u63d0\u4f9b\u4e86\u9ad8\u6548\u7684\u8282\u70b9\u91cd\u6392\u80fd\u529b\uff0c \u4ee5\u53ca\u987a\u5e8f\u6027\u7684\u8282\u70b9\u8bbf\u95ee\u65b9\u5f0f\uff0c \u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u589e\u5220\u8282\u70b9\u6765\u7075\u6d3b\u5730\u8c03\u6574\u94fe\u8868\u7684\u957f\u5ea6\u3002 \u5217\u8868\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00\u5c31\u662f\u94fe\u8868 \uff1a \u5f53\u4e00\u4e2a\u5217\u8868\u952e\u5305\u542b\u4e86\u6570\u91cf\u6bd4\u8f83\u591a\u7684\u5143\u7d20\uff0c \u53c8\u6216\u8005\u5217\u8868\u4e2d\u5305\u542b\u7684\u5143\u7d20\u90fd\u662f\u6bd4\u8f83\u957f\u7684\u5b57\u7b26\u4e32\u65f6\uff0c Redis \u5c31\u4f1a\u4f7f\u7528\u94fe\u8868\u4f5c\u4e3a\u5217\u8868\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u3002 \u9664\u4e86\u94fe\u8868\u952e\u4e4b\u5916\uff0c \u53d1\u5e03\u4e0e\u8ba2\u9605\u3001\u6162\u67e5\u8be2\u3001\u76d1\u89c6\u5668\u7b49\u529f\u80fd\u4e5f\u7528\u5230\u4e86\u94fe\u8868\uff0c Redis \u670d\u52a1\u5668\u672c\u8eab\u8fd8\u4f7f\u7528\u94fe\u8868\u6765\u4fdd\u5b58\u591a\u4e2a\u5ba2\u6237\u7aef\u7684\u72b6\u6001\u4fe1\u606f\uff0c \u4ee5\u53ca\u4f7f\u7528\u94fe\u8868\u6765\u6784\u5efa\u5ba2\u6237\u7aef\u8f93\u51fa\u7f13\u51b2\u533a\uff08output buffer\uff09\uff0c \u672c\u4e66\u540e\u7eed\u7684\u7ae0\u8282\u5c06\u9646\u7eed\u5bf9\u8fd9\u4e9b\u94fe\u8868\u5e94\u7528\u8fdb\u884c\u4ecb\u7ecd\u3002 \u94fe\u8868\u88ab\u5e7f\u6cdb\u7528\u4e8e\u5b9e\u73b0 Redis \u7684\u5404\u79cd\u529f\u80fd\uff0c \u6bd4\u5982\u5217\u8868\u952e\uff0c \u53d1\u5e03\u4e0e\u8ba2\u9605\uff0c \u6162\u67e5\u8be2\uff0c \u76d1\u89c6\u5668\uff0c \u7b49\u7b49\u3002 \u6bcf\u4e2a\u94fe\u8868\u8282\u70b9\u7531\u4e00\u4e2a listNode \u7ed3\u6784\u6765\u8868\u793a\uff0c \u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u6307\u5411\u524d\u7f6e\u8282\u70b9\u548c\u540e\u7f6e\u8282\u70b9\u7684\u6307\u9488\uff0c \u6240\u4ee5 Redis \u7684\u94fe\u8868\u5b9e\u73b0\u662f\u53cc\u7aef\u94fe\u8868\u3002 \u6bcf\u4e2a\u94fe\u8868\u4f7f\u7528\u4e00\u4e2a list \u7ed3\u6784\u6765\u8868\u793a\uff0c \u8fd9\u4e2a\u7ed3\u6784\u5e26\u6709\u8868\u5934\u8282\u70b9\u6307\u9488\u3001\u8868\u5c3e\u8282\u70b9\u6307\u9488\u3001\u4ee5\u53ca\u94fe\u8868\u957f\u5ea6\u7b49\u4fe1\u606f\u3002 \u56e0\u4e3a\u94fe\u8868\u8868\u5934\u8282\u70b9\u7684\u524d\u7f6e\u8282\u70b9\u548c\u8868\u5c3e\u8282\u70b9\u7684\u540e\u7f6e\u8282\u70b9\u90fd\u6307\u5411 NULL \uff0c \u6240\u4ee5 Redis \u7684\u94fe\u8868\u5b9e\u73b0\u662f\u65e0\u73af\u94fe\u8868\u3002 \u901a\u8fc7\u4e3a\u94fe\u8868\u8bbe\u7f6e\u4e0d\u540c\u7684\u7c7b\u578b\u7279\u5b9a\u51fd\u6570\uff0c Redis \u7684\u94fe\u8868\u53ef\u4ee5\u7528\u4e8e\u4fdd\u5b58\u5404\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u3002","title":"3 \u94fe\u8868"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/3.0-%E9%93%BE%E8%A1%A8/#3","text":"\u94fe\u8868\u63d0\u4f9b\u4e86\u9ad8\u6548\u7684\u8282\u70b9\u91cd\u6392\u80fd\u529b\uff0c \u4ee5\u53ca\u987a\u5e8f\u6027\u7684\u8282\u70b9\u8bbf\u95ee\u65b9\u5f0f\uff0c \u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u589e\u5220\u8282\u70b9\u6765\u7075\u6d3b\u5730\u8c03\u6574\u94fe\u8868\u7684\u957f\u5ea6\u3002 \u5217\u8868\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00\u5c31\u662f\u94fe\u8868 \uff1a \u5f53\u4e00\u4e2a\u5217\u8868\u952e\u5305\u542b\u4e86\u6570\u91cf\u6bd4\u8f83\u591a\u7684\u5143\u7d20\uff0c \u53c8\u6216\u8005\u5217\u8868\u4e2d\u5305\u542b\u7684\u5143\u7d20\u90fd\u662f\u6bd4\u8f83\u957f\u7684\u5b57\u7b26\u4e32\u65f6\uff0c Redis \u5c31\u4f1a\u4f7f\u7528\u94fe\u8868\u4f5c\u4e3a\u5217\u8868\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u3002 \u9664\u4e86\u94fe\u8868\u952e\u4e4b\u5916\uff0c \u53d1\u5e03\u4e0e\u8ba2\u9605\u3001\u6162\u67e5\u8be2\u3001\u76d1\u89c6\u5668\u7b49\u529f\u80fd\u4e5f\u7528\u5230\u4e86\u94fe\u8868\uff0c Redis \u670d\u52a1\u5668\u672c\u8eab\u8fd8\u4f7f\u7528\u94fe\u8868\u6765\u4fdd\u5b58\u591a\u4e2a\u5ba2\u6237\u7aef\u7684\u72b6\u6001\u4fe1\u606f\uff0c \u4ee5\u53ca\u4f7f\u7528\u94fe\u8868\u6765\u6784\u5efa\u5ba2\u6237\u7aef\u8f93\u51fa\u7f13\u51b2\u533a\uff08output buffer\uff09\uff0c \u672c\u4e66\u540e\u7eed\u7684\u7ae0\u8282\u5c06\u9646\u7eed\u5bf9\u8fd9\u4e9b\u94fe\u8868\u5e94\u7528\u8fdb\u884c\u4ecb\u7ecd\u3002 \u94fe\u8868\u88ab\u5e7f\u6cdb\u7528\u4e8e\u5b9e\u73b0 Redis \u7684\u5404\u79cd\u529f\u80fd\uff0c \u6bd4\u5982\u5217\u8868\u952e\uff0c \u53d1\u5e03\u4e0e\u8ba2\u9605\uff0c \u6162\u67e5\u8be2\uff0c \u76d1\u89c6\u5668\uff0c \u7b49\u7b49\u3002 \u6bcf\u4e2a\u94fe\u8868\u8282\u70b9\u7531\u4e00\u4e2a listNode \u7ed3\u6784\u6765\u8868\u793a\uff0c \u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u6307\u5411\u524d\u7f6e\u8282\u70b9\u548c\u540e\u7f6e\u8282\u70b9\u7684\u6307\u9488\uff0c \u6240\u4ee5 Redis \u7684\u94fe\u8868\u5b9e\u73b0\u662f\u53cc\u7aef\u94fe\u8868\u3002 \u6bcf\u4e2a\u94fe\u8868\u4f7f\u7528\u4e00\u4e2a list \u7ed3\u6784\u6765\u8868\u793a\uff0c \u8fd9\u4e2a\u7ed3\u6784\u5e26\u6709\u8868\u5934\u8282\u70b9\u6307\u9488\u3001\u8868\u5c3e\u8282\u70b9\u6307\u9488\u3001\u4ee5\u53ca\u94fe\u8868\u957f\u5ea6\u7b49\u4fe1\u606f\u3002 \u56e0\u4e3a\u94fe\u8868\u8868\u5934\u8282\u70b9\u7684\u524d\u7f6e\u8282\u70b9\u548c\u8868\u5c3e\u8282\u70b9\u7684\u540e\u7f6e\u8282\u70b9\u90fd\u6307\u5411 NULL \uff0c \u6240\u4ee5 Redis \u7684\u94fe\u8868\u5b9e\u73b0\u662f\u65e0\u73af\u94fe\u8868\u3002 \u901a\u8fc7\u4e3a\u94fe\u8868\u8bbe\u7f6e\u4e0d\u540c\u7684\u7c7b\u578b\u7279\u5b9a\u51fd\u6570\uff0c Redis \u7684\u94fe\u8868\u53ef\u4ee5\u7528\u4e8e\u4fdd\u5b58\u5404\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u3002","title":"3 \u94fe\u8868"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/3.1-%E9%93%BE%E8%A1%A8%E5%92%8C%E9%93%BE%E8%A1%A8%E8%8A%82%E7%82%B9%E7%9A%84%E5%AE%9E%E7%8E%B0/","text":"3.1 \u94fe\u8868\u548c\u94fe\u8868\u8282\u70b9\u7684\u5b9e\u73b0 \u6bcf\u4e2a\u94fe\u8868\u8282\u70b9\u4f7f\u7528\u4e00\u4e2a adlist.h/listNode \u7ed3\u6784\u6765\u8868\u793a\uff1a typedef struct listNode { // \u524d\u7f6e\u8282\u70b9 struct listNode *prev; // \u540e\u7f6e\u8282\u70b9 struct listNode *next; // \u8282\u70b9\u7684\u503c void *value; } listNode; typedef struct list { // \u8868\u5934\u8282\u70b9 listNode *head; // \u8868\u5c3e\u8282\u70b9 listNode *tail; // \u94fe\u8868\u6240\u5305\u542b\u7684\u8282\u70b9\u6570\u91cf unsigned long len; // \u8282\u70b9\u503c\u590d\u5236\u51fd\u6570 void *(*dup)(void *ptr); // \u8282\u70b9\u503c\u91ca\u653e\u51fd\u6570 void (*free)(void *ptr); // \u8282\u70b9\u503c\u5bf9\u6bd4\u51fd\u6570 int (*match)(void *ptr, void *key); } list; Redis \u7684\u94fe\u8868\u5b9e\u73b0\u7684\u7279\u6027 \u53ef\u4ee5\u603b\u7ed3\u5982\u4e0b\uff1a \u53cc\u7aef\uff1a \u94fe\u8868\u8282\u70b9\u5e26\u6709 prev \u548c next \u6307\u9488\uff0c \u83b7\u53d6\u67d0\u4e2a\u8282\u70b9\u7684\u524d\u7f6e\u8282\u70b9\u548c\u540e\u7f6e\u8282\u70b9\u7684\u590d\u6742\u5ea6\u90fd\u662f O(1) \u3002 \u65e0\u73af\uff1a \u8868\u5934\u8282\u70b9\u7684 prev \u6307\u9488\u548c\u8868\u5c3e\u8282\u70b9\u7684 next \u6307\u9488\u90fd\u6307\u5411 NULL \uff0c \u5bf9\u94fe\u8868\u7684\u8bbf\u95ee\u4ee5 NULL \u4e3a\u7ec8\u70b9\u3002 \u5e26\u8868\u5934\u6307\u9488\u548c\u8868\u5c3e\u6307\u9488\uff1a \u901a\u8fc7 list \u7ed3\u6784\u7684 head \u6307\u9488\u548c tail \u6307\u9488\uff0c \u7a0b\u5e8f\u83b7\u53d6\u94fe\u8868\u7684\u8868\u5934\u8282\u70b9\u548c\u8868\u5c3e\u8282\u70b9\u7684\u590d\u6742\u5ea6\u4e3a O(1) \u3002 \u5e26\u94fe\u8868\u957f\u5ea6\u8ba1\u6570\u5668\uff1a \u7a0b\u5e8f\u4f7f\u7528 list \u7ed3\u6784\u7684 len \u5c5e\u6027\u6765\u5bf9 list \u6301\u6709\u7684\u94fe\u8868\u8282\u70b9\u8fdb\u884c\u8ba1\u6570\uff0c \u7a0b\u5e8f\u83b7\u53d6\u94fe\u8868\u4e2d\u8282\u70b9\u6570\u91cf\u7684\u590d\u6742\u5ea6\u4e3a O(1) \u3002 \u591a\u6001\uff1a \u94fe\u8868\u8282\u70b9\u4f7f\u7528 void* \u6307\u9488\u6765\u4fdd\u5b58\u8282\u70b9\u503c\uff0c \u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7 list \u7ed3\u6784\u7684 dup \u3001 free \u3001 match \u4e09\u4e2a\u5c5e\u6027\u4e3a\u8282\u70b9\u503c\u8bbe\u7f6e\u7c7b\u578b\u7279\u5b9a\u51fd\u6570\uff0c \u6240\u4ee5\u94fe\u8868\u53ef\u4ee5\u7528\u4e8e\u4fdd\u5b58\u5404\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u3002","title":"3.1 \u94fe\u8868\u548c\u94fe\u8868\u8282\u70b9\u7684\u5b9e\u73b0"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/3.1-%E9%93%BE%E8%A1%A8%E5%92%8C%E9%93%BE%E8%A1%A8%E8%8A%82%E7%82%B9%E7%9A%84%E5%AE%9E%E7%8E%B0/#31","text":"\u6bcf\u4e2a\u94fe\u8868\u8282\u70b9\u4f7f\u7528\u4e00\u4e2a adlist.h/listNode \u7ed3\u6784\u6765\u8868\u793a\uff1a typedef struct listNode { // \u524d\u7f6e\u8282\u70b9 struct listNode *prev; // \u540e\u7f6e\u8282\u70b9 struct listNode *next; // \u8282\u70b9\u7684\u503c void *value; } listNode; typedef struct list { // \u8868\u5934\u8282\u70b9 listNode *head; // \u8868\u5c3e\u8282\u70b9 listNode *tail; // \u94fe\u8868\u6240\u5305\u542b\u7684\u8282\u70b9\u6570\u91cf unsigned long len; // \u8282\u70b9\u503c\u590d\u5236\u51fd\u6570 void *(*dup)(void *ptr); // \u8282\u70b9\u503c\u91ca\u653e\u51fd\u6570 void (*free)(void *ptr); // \u8282\u70b9\u503c\u5bf9\u6bd4\u51fd\u6570 int (*match)(void *ptr, void *key); } list; Redis \u7684\u94fe\u8868\u5b9e\u73b0\u7684\u7279\u6027 \u53ef\u4ee5\u603b\u7ed3\u5982\u4e0b\uff1a \u53cc\u7aef\uff1a \u94fe\u8868\u8282\u70b9\u5e26\u6709 prev \u548c next \u6307\u9488\uff0c \u83b7\u53d6\u67d0\u4e2a\u8282\u70b9\u7684\u524d\u7f6e\u8282\u70b9\u548c\u540e\u7f6e\u8282\u70b9\u7684\u590d\u6742\u5ea6\u90fd\u662f O(1) \u3002 \u65e0\u73af\uff1a \u8868\u5934\u8282\u70b9\u7684 prev \u6307\u9488\u548c\u8868\u5c3e\u8282\u70b9\u7684 next \u6307\u9488\u90fd\u6307\u5411 NULL \uff0c \u5bf9\u94fe\u8868\u7684\u8bbf\u95ee\u4ee5 NULL \u4e3a\u7ec8\u70b9\u3002 \u5e26\u8868\u5934\u6307\u9488\u548c\u8868\u5c3e\u6307\u9488\uff1a \u901a\u8fc7 list \u7ed3\u6784\u7684 head \u6307\u9488\u548c tail \u6307\u9488\uff0c \u7a0b\u5e8f\u83b7\u53d6\u94fe\u8868\u7684\u8868\u5934\u8282\u70b9\u548c\u8868\u5c3e\u8282\u70b9\u7684\u590d\u6742\u5ea6\u4e3a O(1) \u3002 \u5e26\u94fe\u8868\u957f\u5ea6\u8ba1\u6570\u5668\uff1a \u7a0b\u5e8f\u4f7f\u7528 list \u7ed3\u6784\u7684 len \u5c5e\u6027\u6765\u5bf9 list \u6301\u6709\u7684\u94fe\u8868\u8282\u70b9\u8fdb\u884c\u8ba1\u6570\uff0c \u7a0b\u5e8f\u83b7\u53d6\u94fe\u8868\u4e2d\u8282\u70b9\u6570\u91cf\u7684\u590d\u6742\u5ea6\u4e3a O(1) \u3002 \u591a\u6001\uff1a \u94fe\u8868\u8282\u70b9\u4f7f\u7528 void* \u6307\u9488\u6765\u4fdd\u5b58\u8282\u70b9\u503c\uff0c \u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7 list \u7ed3\u6784\u7684 dup \u3001 free \u3001 match \u4e09\u4e2a\u5c5e\u6027\u4e3a\u8282\u70b9\u503c\u8bbe\u7f6e\u7c7b\u578b\u7279\u5b9a\u51fd\u6570\uff0c \u6240\u4ee5\u94fe\u8868\u53ef\u4ee5\u7528\u4e8e\u4fdd\u5b58\u5404\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u3002","title":"3.1 \u94fe\u8868\u548c\u94fe\u8868\u8282\u70b9\u7684\u5b9e\u73b0"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/3.2-%E9%93%BE%E8%A1%A8%E5%92%8C%E9%93%BE%E8%A1%A8%E8%8A%82%E7%82%B9%E7%9A%84%20API/","text":"\u94fe\u8868\u548c\u94fe\u8868\u8282\u70b9\u7684 API \u51fd\u6570 \u4f5c\u7528 \u65f6\u95f4\u590d\u6742\u5ea6 listSetDupMethod \u5c06\u7ed9\u5b9a\u7684\u51fd\u6570\u8bbe\u7f6e\u4e3a\u94fe\u8868\u7684\u8282\u70b9\u503c\u590d\u5236\u51fd\u6570\u3002 O(1) \u3002 listGetDupMethod \u8fd4\u56de\u94fe\u8868\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\u8282\u70b9\u503c\u590d\u5236\u51fd\u6570\u3002 \u590d\u5236\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 dup \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) listSetFreeMethod \u5c06\u7ed9\u5b9a\u7684\u51fd\u6570\u8bbe\u7f6e\u4e3a\u94fe\u8868\u7684\u8282\u70b9\u503c\u91ca\u653e\u51fd\u6570\u3002 O(1) \u3002 listGetFree \u8fd4\u56de\u94fe\u8868\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\u8282\u70b9\u503c\u91ca\u653e\u51fd\u6570\u3002 \u91ca\u653e\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 free \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) listSetMatchMethod \u5c06\u7ed9\u5b9a\u7684\u51fd\u6570\u8bbe\u7f6e\u4e3a\u94fe\u8868\u7684\u8282\u70b9\u503c\u5bf9\u6bd4\u51fd\u6570\u3002 O(1) listGetMatchMethod \u8fd4\u56de\u94fe\u8868\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\u8282\u70b9\u503c\u5bf9\u6bd4\u51fd\u6570\u3002 \u5bf9\u6bd4\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 match \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) listLength \u8fd4\u56de\u94fe\u8868\u7684\u957f\u5ea6\uff08\u5305\u542b\u4e86\u591a\u5c11\u4e2a\u8282\u70b9\uff09\u3002 \u94fe\u8868\u957f\u5ea6\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 len \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listFirst \u8fd4\u56de\u94fe\u8868\u7684\u8868\u5934\u8282\u70b9\u3002 \u8868\u5934\u8282\u70b9\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 head \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listLast \u8fd4\u56de\u94fe\u8868\u7684\u8868\u5c3e\u8282\u70b9\u3002 \u8868\u5c3e\u8282\u70b9\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 tail \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listPrevNode \u8fd4\u56de\u7ed9\u5b9a\u8282\u70b9\u7684\u524d\u7f6e\u8282\u70b9\u3002 \u524d\u7f6e\u8282\u70b9\u53ef\u4ee5\u901a\u8fc7\u8282\u70b9\u7684 prev \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listNextNode \u8fd4\u56de\u7ed9\u5b9a\u8282\u70b9\u7684\u540e\u7f6e\u8282\u70b9\u3002 \u540e\u7f6e\u8282\u70b9\u53ef\u4ee5\u901a\u8fc7\u8282\u70b9\u7684 next \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listNodeValue \u8fd4\u56de\u7ed9\u5b9a\u8282\u70b9\u76ee\u524d\u6b63\u5728\u4fdd\u5b58\u7684\u503c\u3002 \u8282\u70b9\u503c\u53ef\u4ee5\u901a\u8fc7\u8282\u70b9\u7684 value \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listCreate \u521b\u5efa\u4e00\u4e2a\u4e0d\u5305\u542b\u4efb\u4f55\u8282\u70b9\u7684\u65b0\u94fe\u8868\u3002 O(1) listAddNodeHead \u5c06\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u65b0\u8282\u70b9\u6dfb\u52a0\u5230\u7ed9\u5b9a\u94fe\u8868\u7684\u8868\u5934\u3002 O(1) listAddNodeTail \u5c06\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u65b0\u8282\u70b9\u6dfb\u52a0\u5230\u7ed9\u5b9a\u94fe\u8868\u7684\u8868\u5c3e\u3002 O(1) listInsertNode \u5c06\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u65b0\u8282\u70b9\u6dfb\u52a0\u5230\u7ed9\u5b9a\u8282\u70b9\u7684\u4e4b\u524d\u6216\u8005\u4e4b\u540e\u3002 O(1) listSearchKey \u67e5\u627e\u5e76\u8fd4\u56de\u94fe\u8868\u4e2d\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u8282\u70b9\u3002 O(N) \uff0c N \u4e3a\u94fe\u8868\u957f\u5ea6\u3002 listIndex \u8fd4\u56de\u94fe\u8868\u5728\u7ed9\u5b9a\u7d22\u5f15\u4e0a\u7684\u8282\u70b9\u3002 O(N) \uff0c N \u4e3a\u94fe\u8868\u957f\u5ea6\u3002 listDelNode \u4ece\u94fe\u8868\u4e2d\u5220\u9664\u7ed9\u5b9a\u8282\u70b9\u3002 O(1) \u3002 listRotate \u5c06\u94fe\u8868\u7684\u8868\u5c3e\u8282\u70b9\u5f39\u51fa\uff0c\u7136\u540e\u5c06\u88ab\u5f39\u51fa\u7684\u8282\u70b9\u63d2\u5165\u5230\u94fe\u8868\u7684\u8868\u5934\uff0c \u6210\u4e3a\u65b0\u7684\u8868\u5934\u8282\u70b9\u3002 O(1) listDup \u590d\u5236\u4e00\u4e2a\u7ed9\u5b9a\u94fe\u8868\u7684\u526f\u672c\u3002 O(N) \uff0c N \u4e3a\u94fe\u8868\u957f\u5ea6\u3002 listRelease \u91ca\u653e\u7ed9\u5b9a\u94fe\u8868\uff0c\u4ee5\u53ca\u94fe\u8868\u4e2d\u7684\u6240\u6709\u8282\u70b9\u3002 O(N) \uff0c N \u4e3a\u94fe\u8868\u957f\u5ea6\u3002","title":"\u94fe\u8868\u548c\u94fe\u8868\u8282\u70b9\u7684 API"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/3.2-%E9%93%BE%E8%A1%A8%E5%92%8C%E9%93%BE%E8%A1%A8%E8%8A%82%E7%82%B9%E7%9A%84%20API/#api","text":"\u51fd\u6570 \u4f5c\u7528 \u65f6\u95f4\u590d\u6742\u5ea6 listSetDupMethod \u5c06\u7ed9\u5b9a\u7684\u51fd\u6570\u8bbe\u7f6e\u4e3a\u94fe\u8868\u7684\u8282\u70b9\u503c\u590d\u5236\u51fd\u6570\u3002 O(1) \u3002 listGetDupMethod \u8fd4\u56de\u94fe\u8868\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\u8282\u70b9\u503c\u590d\u5236\u51fd\u6570\u3002 \u590d\u5236\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 dup \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) listSetFreeMethod \u5c06\u7ed9\u5b9a\u7684\u51fd\u6570\u8bbe\u7f6e\u4e3a\u94fe\u8868\u7684\u8282\u70b9\u503c\u91ca\u653e\u51fd\u6570\u3002 O(1) \u3002 listGetFree \u8fd4\u56de\u94fe\u8868\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\u8282\u70b9\u503c\u91ca\u653e\u51fd\u6570\u3002 \u91ca\u653e\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 free \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) listSetMatchMethod \u5c06\u7ed9\u5b9a\u7684\u51fd\u6570\u8bbe\u7f6e\u4e3a\u94fe\u8868\u7684\u8282\u70b9\u503c\u5bf9\u6bd4\u51fd\u6570\u3002 O(1) listGetMatchMethod \u8fd4\u56de\u94fe\u8868\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\u8282\u70b9\u503c\u5bf9\u6bd4\u51fd\u6570\u3002 \u5bf9\u6bd4\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 match \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) listLength \u8fd4\u56de\u94fe\u8868\u7684\u957f\u5ea6\uff08\u5305\u542b\u4e86\u591a\u5c11\u4e2a\u8282\u70b9\uff09\u3002 \u94fe\u8868\u957f\u5ea6\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 len \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listFirst \u8fd4\u56de\u94fe\u8868\u7684\u8868\u5934\u8282\u70b9\u3002 \u8868\u5934\u8282\u70b9\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 head \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listLast \u8fd4\u56de\u94fe\u8868\u7684\u8868\u5c3e\u8282\u70b9\u3002 \u8868\u5c3e\u8282\u70b9\u53ef\u4ee5\u901a\u8fc7\u94fe\u8868\u7684 tail \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listPrevNode \u8fd4\u56de\u7ed9\u5b9a\u8282\u70b9\u7684\u524d\u7f6e\u8282\u70b9\u3002 \u524d\u7f6e\u8282\u70b9\u53ef\u4ee5\u901a\u8fc7\u8282\u70b9\u7684 prev \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listNextNode \u8fd4\u56de\u7ed9\u5b9a\u8282\u70b9\u7684\u540e\u7f6e\u8282\u70b9\u3002 \u540e\u7f6e\u8282\u70b9\u53ef\u4ee5\u901a\u8fc7\u8282\u70b9\u7684 next \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listNodeValue \u8fd4\u56de\u7ed9\u5b9a\u8282\u70b9\u76ee\u524d\u6b63\u5728\u4fdd\u5b58\u7684\u503c\u3002 \u8282\u70b9\u503c\u53ef\u4ee5\u901a\u8fc7\u8282\u70b9\u7684 value \u5c5e\u6027\u76f4\u63a5\u83b7\u5f97\uff0c O(1) \u3002 listCreate \u521b\u5efa\u4e00\u4e2a\u4e0d\u5305\u542b\u4efb\u4f55\u8282\u70b9\u7684\u65b0\u94fe\u8868\u3002 O(1) listAddNodeHead \u5c06\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u65b0\u8282\u70b9\u6dfb\u52a0\u5230\u7ed9\u5b9a\u94fe\u8868\u7684\u8868\u5934\u3002 O(1) listAddNodeTail \u5c06\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u65b0\u8282\u70b9\u6dfb\u52a0\u5230\u7ed9\u5b9a\u94fe\u8868\u7684\u8868\u5c3e\u3002 O(1) listInsertNode \u5c06\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u65b0\u8282\u70b9\u6dfb\u52a0\u5230\u7ed9\u5b9a\u8282\u70b9\u7684\u4e4b\u524d\u6216\u8005\u4e4b\u540e\u3002 O(1) listSearchKey \u67e5\u627e\u5e76\u8fd4\u56de\u94fe\u8868\u4e2d\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u8282\u70b9\u3002 O(N) \uff0c N \u4e3a\u94fe\u8868\u957f\u5ea6\u3002 listIndex \u8fd4\u56de\u94fe\u8868\u5728\u7ed9\u5b9a\u7d22\u5f15\u4e0a\u7684\u8282\u70b9\u3002 O(N) \uff0c N \u4e3a\u94fe\u8868\u957f\u5ea6\u3002 listDelNode \u4ece\u94fe\u8868\u4e2d\u5220\u9664\u7ed9\u5b9a\u8282\u70b9\u3002 O(1) \u3002 listRotate \u5c06\u94fe\u8868\u7684\u8868\u5c3e\u8282\u70b9\u5f39\u51fa\uff0c\u7136\u540e\u5c06\u88ab\u5f39\u51fa\u7684\u8282\u70b9\u63d2\u5165\u5230\u94fe\u8868\u7684\u8868\u5934\uff0c \u6210\u4e3a\u65b0\u7684\u8868\u5934\u8282\u70b9\u3002 O(1) listDup \u590d\u5236\u4e00\u4e2a\u7ed9\u5b9a\u94fe\u8868\u7684\u526f\u672c\u3002 O(N) \uff0c N \u4e3a\u94fe\u8868\u957f\u5ea6\u3002 listRelease \u91ca\u653e\u7ed9\u5b9a\u94fe\u8868\uff0c\u4ee5\u53ca\u94fe\u8868\u4e2d\u7684\u6240\u6709\u8282\u70b9\u3002 O(N) \uff0c N \u4e3a\u94fe\u8868\u957f\u5ea6\u3002","title":"\u94fe\u8868\u548c\u94fe\u8868\u8282\u70b9\u7684 API"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.0-%E5%AD%97%E5%85%B8/","text":"\u5b57\u5178 \u5b57\u5178\uff0c \u53c8\u79f0\u7b26\u53f7\u8868\uff08symbol table\uff09\u3001\u5173\u8054\u6570\u7ec4\uff08associative array\uff09\u6216\u8005\u6620\u5c04\uff08map\uff09\uff0c \u662f\u4e00\u79cd\u7528\u4e8e\u4fdd\u5b58\u952e\u503c\u5bf9\uff08key-value pair\uff09\u7684\u62bd\u8c61\u6570\u636e\u7ed3\u6784\u3002 \u5728\u5b57\u5178\u4e2d\uff0c \u4e00\u4e2a\u952e\uff08key\uff09\u53ef\u4ee5\u548c\u4e00\u4e2a\u503c\uff08value\uff09\u8fdb\u884c\u5173\u8054\uff08\u6216\u8005\u8bf4\u5c06\u952e\u6620\u5c04\u4e3a\u503c\uff09\uff0c \u8fd9\u4e9b\u5173\u8054\u7684\u952e\u548c\u503c\u5c31\u88ab\u79f0\u4e3a\u952e\u503c\u5bf9\u3002 \u5b57\u5178\u4e2d\u7684\u6bcf\u4e2a\u952e\u90fd\u662f\u72ec\u4e00\u65e0\u4e8c\u7684\uff0c \u7a0b\u5e8f\u53ef\u4ee5\u5728\u5b57\u5178\u4e2d\u6839\u636e\u952e\u67e5\u627e\u4e0e\u4e4b\u5173\u8054\u7684\u503c\uff0c \u6216\u8005\u901a\u8fc7\u952e\u6765\u66f4\u65b0\u503c\uff0c \u53c8\u6216\u8005\u6839\u636e\u952e\u6765\u5220\u9664\u6574\u4e2a\u952e\u503c\u5bf9\uff0c \u7b49\u7b49\u3002 \u5b57\u5178\u8fd8\u662f\u54c8\u5e0c\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00 \uff1a \u5f53\u4e00\u4e2a\u54c8\u5e0c\u952e\u5305\u542b\u7684\u952e\u503c\u5bf9\u6bd4\u8f83\u591a\uff0c \u53c8\u6216\u8005\u952e\u503c\u5bf9\u4e2d\u7684\u5143\u7d20\u90fd\u662f\u6bd4\u8f83\u957f\u7684\u5b57\u7b26\u4e32\u65f6\uff0c Redis \u5c31\u4f1a\u4f7f\u7528\u5b57\u5178\u4f5c\u4e3a\u54c8\u5e0c\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u3002 4.1 \u5b9e\u73b0 Redis \u7684\u5b57\u5178\u4f7f\u7528\u54c8\u5e0c\u8868\u4f5c\u4e3a\u5e95\u5c42\u5b9e\u73b0 \uff0c \u4e00\u4e2a\u54c8\u5e0c\u8868\u91cc\u9762\u53ef\u4ee5\u6709\u591a\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\uff0c \u800c\u6bcf\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\u5c31\u4fdd\u5b58\u4e86\u5b57\u5178\u4e2d\u7684\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 \u63a5\u4e0b\u6765\u7684\u4e09\u4e2a\u5c0f\u8282\u5c06\u5206\u522b\u4ecb\u7ecd Redis \u7684\u54c8\u5e0c\u8868\u3001\u54c8\u5e0c\u8868\u8282\u70b9\u3001\u4ee5\u53ca\u5b57\u5178\u7684\u5b9e\u73b0\u3002 4.1.1 \u54c8\u5e0c\u8868 typedef struct dictht { // \u54c8\u5e0c\u8868\u6570\u7ec4 dictEntry **table; // \u54c8\u5e0c\u8868\u5927\u5c0f unsigned long size; // \u54c8\u5e0c\u8868\u5927\u5c0f\u63a9\u7801\uff0c\u7528\u4e8e\u8ba1\u7b97\u7d22\u5f15\u503c // \u603b\u662f\u7b49\u4e8e size - 1 unsigned long sizemask; // \u8be5\u54c8\u5e0c\u8868\u5df2\u6709\u8282\u70b9\u7684\u6570\u91cf unsigned long used; } dictht; table \u5c5e\u6027\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c \u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2a\u6307\u5411 dict.h/dictEntry \u7ed3\u6784\u7684\u6307\u9488\uff0c \u6bcf\u4e2a dictEntry \u7ed3\u6784\u4fdd\u5b58\u7740\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 size \u5c5e\u6027\u8bb0\u5f55\u4e86\u54c8\u5e0c\u8868\u7684\u5927\u5c0f\uff0c \u4e5f\u5373\u662f table \u6570\u7ec4\u7684\u5927\u5c0f\uff0c \u800c used \u5c5e\u6027\u5219\u8bb0\u5f55\u4e86\u54c8\u5e0c\u8868\u76ee\u524d\u5df2\u6709\u8282\u70b9\uff08\u952e\u503c\u5bf9\uff09\u7684\u6570\u91cf\u3002 sizemask \u5c5e\u6027\u7684\u503c\u603b\u662f\u7b49\u4e8e size - 1 \uff0c \u8fd9\u4e2a\u5c5e\u6027\u548c\u54c8\u5e0c\u503c\u4e00\u8d77\u51b3\u5b9a\u4e00\u4e2a\u952e\u5e94\u8be5\u88ab\u653e\u5230 table \u6570\u7ec4\u7684\u54ea\u4e2a\u7d22\u5f15\u4e0a\u9762\u3002 4.1.2 \u54c8\u5e0c\u8868\u8282\u70b9 \u54c8\u5e0c\u8868\u8282\u70b9\u4f7f\u7528 dictEntry \u7ed3\u6784\u8868\u793a\uff0c \u6bcf\u4e2a dictEntry \u7ed3\u6784\u90fd\u4fdd\u5b58\u7740\u4e00\u4e2a\u952e\u503c\u5bf9\uff1a typedef struct dictEntry { // \u952e void *key; // \u503c union { void *val; uint64_t u64; int64_t s64; } v; // \u6307\u5411\u4e0b\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\uff0c\u5f62\u6210\u94fe\u8868 struct dictEntry *next; } dictEntry; next \u5c5e\u6027\u662f\u6307\u5411\u53e6\u4e00\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\u7684\u6307\u9488\uff0c \u8fd9\u4e2a\u6307\u9488\u53ef\u4ee5\u5c06\u591a\u4e2a\u54c8\u5e0c\u503c\u76f8\u540c\u7684\u952e\u503c\u5bf9\u8fde\u63a5\u5728\u4e00\u6b21\uff0c \u4ee5\u6b64\u6765\u89e3\u51b3\u952e\u51b2\u7a81\uff08collision\uff09\u7684\u95ee\u9898\u3002 4.1.3 \u5b57\u5178 typedef struct dict { // \u7c7b\u578b\u7279\u5b9a\u51fd\u6570 dictType *type; // \u79c1\u6709\u6570\u636e void *privdata; // \u54c8\u5e0c\u8868 dictht ht[2]; // rehash \u7d22\u5f15 // \u5f53 rehash \u4e0d\u5728\u8fdb\u884c\u65f6\uff0c\u503c\u4e3a -1 int rehashidx; /* rehashing not in progress if rehashidx == -1 */ } dict; type \u5c5e\u6027\u548c privdata \u5c5e\u6027\u662f\u9488\u5bf9\u4e0d\u540c\u7c7b\u578b\u7684\u952e\u503c\u5bf9\uff0c \u4e3a\u521b\u5efa\u591a\u6001\u5b57\u5178\u800c\u8bbe\u7f6e\u7684\uff1a type \u5c5e\u6027\u662f\u4e00\u4e2a\u6307\u5411 dictType \u7ed3\u6784\u7684\u6307\u9488\uff0c \u6bcf\u4e2a dictType \u7ed3\u6784\u4fdd\u5b58\u4e86\u4e00\u7c07\u7528\u4e8e\u64cd\u4f5c\u7279\u5b9a\u7c7b\u578b\u952e\u503c\u5bf9\u7684\u51fd\u6570\uff0c Redis \u4f1a\u4e3a\u7528\u9014\u4e0d\u540c\u7684\u5b57\u5178\u8bbe\u7f6e\u4e0d\u540c\u7684\u7c7b\u578b\u7279\u5b9a\u51fd\u6570\u3002 \u800c privdata \u5c5e\u6027\u5219\u4fdd\u5b58\u4e86\u9700\u8981\u4f20\u7ed9\u90a3\u4e9b\u7c7b\u578b\u7279\u5b9a\u51fd\u6570\u7684\u53ef\u9009\u53c2\u6570\u3002 typedef struct dictType { // \u8ba1\u7b97\u54c8\u5e0c\u503c\u7684\u51fd\u6570 unsigned int (*hashFunction)(const void *key); // \u590d\u5236\u952e\u7684\u51fd\u6570 void *(*keyDup)(void *privdata, const void *key); // \u590d\u5236\u503c\u7684\u51fd\u6570 void *(*valDup)(void *privdata, const void *obj); // \u5bf9\u6bd4\u952e\u7684\u51fd\u6570 int (*keyCompare)(void *privdata, const void *key1, const void *key2); // \u9500\u6bc1\u952e\u7684\u51fd\u6570 void (*keyDestructor)(void *privdata, void *key); // \u9500\u6bc1\u503c\u7684\u51fd\u6570 void (*valDestructor)(void *privdata, void *obj); } dictType; ht \u5c5e\u6027\u662f\u4e00\u4e2a\u5305\u542b\u4e24\u4e2a\u9879\u7684\u6570\u7ec4\uff0c \u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u9879\u90fd\u662f\u4e00\u4e2a dictht \u54c8\u5e0c\u8868\uff0c \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c \u5b57\u5178\u53ea\u4f7f\u7528 ht[0] \u54c8\u5e0c\u8868\uff0c ht[1] \u54c8\u5e0c\u8868\u53ea\u4f1a\u5728\u5bf9 ht[0] \u54c8\u5e0c\u8868\u8fdb\u884c rehash \u65f6\u4f7f\u7528\u3002 \u9664\u4e86 ht[1] \u4e4b\u5916\uff0c \u53e6\u4e00\u4e2a\u548c rehash \u6709\u5173\u7684\u5c5e\u6027\u5c31\u662f rehashidx \uff1a \u5b83\u8bb0\u5f55\u4e86 rehash \u76ee\u524d\u7684\u8fdb\u5ea6\uff0c \u5982\u679c\u76ee\u524d\u6ca1\u6709\u5728\u8fdb\u884c rehash \uff0c \u90a3\u4e48\u5b83\u7684\u503c\u4e3a -1 \u3002 \u56fe 4-3 \u5c55\u793a\u4e86\u4e00\u4e2a\u666e\u901a\u72b6\u6001\u4e0b\uff08\u6ca1\u6709\u8fdb\u884c rehash\uff09\u7684\u5b57\u5178\uff1a","title":"\u5b57\u5178"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.0-%E5%AD%97%E5%85%B8/#_1","text":"\u5b57\u5178\uff0c \u53c8\u79f0\u7b26\u53f7\u8868\uff08symbol table\uff09\u3001\u5173\u8054\u6570\u7ec4\uff08associative array\uff09\u6216\u8005\u6620\u5c04\uff08map\uff09\uff0c \u662f\u4e00\u79cd\u7528\u4e8e\u4fdd\u5b58\u952e\u503c\u5bf9\uff08key-value pair\uff09\u7684\u62bd\u8c61\u6570\u636e\u7ed3\u6784\u3002 \u5728\u5b57\u5178\u4e2d\uff0c \u4e00\u4e2a\u952e\uff08key\uff09\u53ef\u4ee5\u548c\u4e00\u4e2a\u503c\uff08value\uff09\u8fdb\u884c\u5173\u8054\uff08\u6216\u8005\u8bf4\u5c06\u952e\u6620\u5c04\u4e3a\u503c\uff09\uff0c \u8fd9\u4e9b\u5173\u8054\u7684\u952e\u548c\u503c\u5c31\u88ab\u79f0\u4e3a\u952e\u503c\u5bf9\u3002 \u5b57\u5178\u4e2d\u7684\u6bcf\u4e2a\u952e\u90fd\u662f\u72ec\u4e00\u65e0\u4e8c\u7684\uff0c \u7a0b\u5e8f\u53ef\u4ee5\u5728\u5b57\u5178\u4e2d\u6839\u636e\u952e\u67e5\u627e\u4e0e\u4e4b\u5173\u8054\u7684\u503c\uff0c \u6216\u8005\u901a\u8fc7\u952e\u6765\u66f4\u65b0\u503c\uff0c \u53c8\u6216\u8005\u6839\u636e\u952e\u6765\u5220\u9664\u6574\u4e2a\u952e\u503c\u5bf9\uff0c \u7b49\u7b49\u3002 \u5b57\u5178\u8fd8\u662f\u54c8\u5e0c\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00 \uff1a \u5f53\u4e00\u4e2a\u54c8\u5e0c\u952e\u5305\u542b\u7684\u952e\u503c\u5bf9\u6bd4\u8f83\u591a\uff0c \u53c8\u6216\u8005\u952e\u503c\u5bf9\u4e2d\u7684\u5143\u7d20\u90fd\u662f\u6bd4\u8f83\u957f\u7684\u5b57\u7b26\u4e32\u65f6\uff0c Redis \u5c31\u4f1a\u4f7f\u7528\u5b57\u5178\u4f5c\u4e3a\u54c8\u5e0c\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u3002","title":"\u5b57\u5178"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.0-%E5%AD%97%E5%85%B8/#41","text":"Redis \u7684\u5b57\u5178\u4f7f\u7528\u54c8\u5e0c\u8868\u4f5c\u4e3a\u5e95\u5c42\u5b9e\u73b0 \uff0c \u4e00\u4e2a\u54c8\u5e0c\u8868\u91cc\u9762\u53ef\u4ee5\u6709\u591a\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\uff0c \u800c\u6bcf\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\u5c31\u4fdd\u5b58\u4e86\u5b57\u5178\u4e2d\u7684\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 \u63a5\u4e0b\u6765\u7684\u4e09\u4e2a\u5c0f\u8282\u5c06\u5206\u522b\u4ecb\u7ecd Redis \u7684\u54c8\u5e0c\u8868\u3001\u54c8\u5e0c\u8868\u8282\u70b9\u3001\u4ee5\u53ca\u5b57\u5178\u7684\u5b9e\u73b0\u3002","title":"4.1 \u5b9e\u73b0"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.0-%E5%AD%97%E5%85%B8/#411","text":"typedef struct dictht { // \u54c8\u5e0c\u8868\u6570\u7ec4 dictEntry **table; // \u54c8\u5e0c\u8868\u5927\u5c0f unsigned long size; // \u54c8\u5e0c\u8868\u5927\u5c0f\u63a9\u7801\uff0c\u7528\u4e8e\u8ba1\u7b97\u7d22\u5f15\u503c // \u603b\u662f\u7b49\u4e8e size - 1 unsigned long sizemask; // \u8be5\u54c8\u5e0c\u8868\u5df2\u6709\u8282\u70b9\u7684\u6570\u91cf unsigned long used; } dictht; table \u5c5e\u6027\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c \u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2a\u6307\u5411 dict.h/dictEntry \u7ed3\u6784\u7684\u6307\u9488\uff0c \u6bcf\u4e2a dictEntry \u7ed3\u6784\u4fdd\u5b58\u7740\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 size \u5c5e\u6027\u8bb0\u5f55\u4e86\u54c8\u5e0c\u8868\u7684\u5927\u5c0f\uff0c \u4e5f\u5373\u662f table \u6570\u7ec4\u7684\u5927\u5c0f\uff0c \u800c used \u5c5e\u6027\u5219\u8bb0\u5f55\u4e86\u54c8\u5e0c\u8868\u76ee\u524d\u5df2\u6709\u8282\u70b9\uff08\u952e\u503c\u5bf9\uff09\u7684\u6570\u91cf\u3002 sizemask \u5c5e\u6027\u7684\u503c\u603b\u662f\u7b49\u4e8e size - 1 \uff0c \u8fd9\u4e2a\u5c5e\u6027\u548c\u54c8\u5e0c\u503c\u4e00\u8d77\u51b3\u5b9a\u4e00\u4e2a\u952e\u5e94\u8be5\u88ab\u653e\u5230 table \u6570\u7ec4\u7684\u54ea\u4e2a\u7d22\u5f15\u4e0a\u9762\u3002","title":"4.1.1 \u54c8\u5e0c\u8868"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.0-%E5%AD%97%E5%85%B8/#412","text":"\u54c8\u5e0c\u8868\u8282\u70b9\u4f7f\u7528 dictEntry \u7ed3\u6784\u8868\u793a\uff0c \u6bcf\u4e2a dictEntry \u7ed3\u6784\u90fd\u4fdd\u5b58\u7740\u4e00\u4e2a\u952e\u503c\u5bf9\uff1a typedef struct dictEntry { // \u952e void *key; // \u503c union { void *val; uint64_t u64; int64_t s64; } v; // \u6307\u5411\u4e0b\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\uff0c\u5f62\u6210\u94fe\u8868 struct dictEntry *next; } dictEntry; next \u5c5e\u6027\u662f\u6307\u5411\u53e6\u4e00\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\u7684\u6307\u9488\uff0c \u8fd9\u4e2a\u6307\u9488\u53ef\u4ee5\u5c06\u591a\u4e2a\u54c8\u5e0c\u503c\u76f8\u540c\u7684\u952e\u503c\u5bf9\u8fde\u63a5\u5728\u4e00\u6b21\uff0c \u4ee5\u6b64\u6765\u89e3\u51b3\u952e\u51b2\u7a81\uff08collision\uff09\u7684\u95ee\u9898\u3002","title":"4.1.2 \u54c8\u5e0c\u8868\u8282\u70b9"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.0-%E5%AD%97%E5%85%B8/#413","text":"typedef struct dict { // \u7c7b\u578b\u7279\u5b9a\u51fd\u6570 dictType *type; // \u79c1\u6709\u6570\u636e void *privdata; // \u54c8\u5e0c\u8868 dictht ht[2]; // rehash \u7d22\u5f15 // \u5f53 rehash \u4e0d\u5728\u8fdb\u884c\u65f6\uff0c\u503c\u4e3a -1 int rehashidx; /* rehashing not in progress if rehashidx == -1 */ } dict; type \u5c5e\u6027\u548c privdata \u5c5e\u6027\u662f\u9488\u5bf9\u4e0d\u540c\u7c7b\u578b\u7684\u952e\u503c\u5bf9\uff0c \u4e3a\u521b\u5efa\u591a\u6001\u5b57\u5178\u800c\u8bbe\u7f6e\u7684\uff1a type \u5c5e\u6027\u662f\u4e00\u4e2a\u6307\u5411 dictType \u7ed3\u6784\u7684\u6307\u9488\uff0c \u6bcf\u4e2a dictType \u7ed3\u6784\u4fdd\u5b58\u4e86\u4e00\u7c07\u7528\u4e8e\u64cd\u4f5c\u7279\u5b9a\u7c7b\u578b\u952e\u503c\u5bf9\u7684\u51fd\u6570\uff0c Redis \u4f1a\u4e3a\u7528\u9014\u4e0d\u540c\u7684\u5b57\u5178\u8bbe\u7f6e\u4e0d\u540c\u7684\u7c7b\u578b\u7279\u5b9a\u51fd\u6570\u3002 \u800c privdata \u5c5e\u6027\u5219\u4fdd\u5b58\u4e86\u9700\u8981\u4f20\u7ed9\u90a3\u4e9b\u7c7b\u578b\u7279\u5b9a\u51fd\u6570\u7684\u53ef\u9009\u53c2\u6570\u3002 typedef struct dictType { // \u8ba1\u7b97\u54c8\u5e0c\u503c\u7684\u51fd\u6570 unsigned int (*hashFunction)(const void *key); // \u590d\u5236\u952e\u7684\u51fd\u6570 void *(*keyDup)(void *privdata, const void *key); // \u590d\u5236\u503c\u7684\u51fd\u6570 void *(*valDup)(void *privdata, const void *obj); // \u5bf9\u6bd4\u952e\u7684\u51fd\u6570 int (*keyCompare)(void *privdata, const void *key1, const void *key2); // \u9500\u6bc1\u952e\u7684\u51fd\u6570 void (*keyDestructor)(void *privdata, void *key); // \u9500\u6bc1\u503c\u7684\u51fd\u6570 void (*valDestructor)(void *privdata, void *obj); } dictType; ht \u5c5e\u6027\u662f\u4e00\u4e2a\u5305\u542b\u4e24\u4e2a\u9879\u7684\u6570\u7ec4\uff0c \u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u9879\u90fd\u662f\u4e00\u4e2a dictht \u54c8\u5e0c\u8868\uff0c \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c \u5b57\u5178\u53ea\u4f7f\u7528 ht[0] \u54c8\u5e0c\u8868\uff0c ht[1] \u54c8\u5e0c\u8868\u53ea\u4f1a\u5728\u5bf9 ht[0] \u54c8\u5e0c\u8868\u8fdb\u884c rehash \u65f6\u4f7f\u7528\u3002 \u9664\u4e86 ht[1] \u4e4b\u5916\uff0c \u53e6\u4e00\u4e2a\u548c rehash \u6709\u5173\u7684\u5c5e\u6027\u5c31\u662f rehashidx \uff1a \u5b83\u8bb0\u5f55\u4e86 rehash \u76ee\u524d\u7684\u8fdb\u5ea6\uff0c \u5982\u679c\u76ee\u524d\u6ca1\u6709\u5728\u8fdb\u884c rehash \uff0c \u90a3\u4e48\u5b83\u7684\u503c\u4e3a -1 \u3002 \u56fe 4-3 \u5c55\u793a\u4e86\u4e00\u4e2a\u666e\u901a\u72b6\u6001\u4e0b\uff08\u6ca1\u6709\u8fdb\u884c rehash\uff09\u7684\u5b57\u5178\uff1a","title":"4.1.3 \u5b57\u5178"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.2-%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/","text":"4.2 \u54c8\u5e0c\u7b97\u6cd5 Redis \u8ba1\u7b97\u54c8\u5e0c\u503c\u548c\u7d22\u5f15\u503c\u7684\u65b9\u6cd5\u5982\u4e0b\uff1a # \u4f7f\u7528\u5b57\u5178\u8bbe\u7f6e\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u8ba1\u7b97\u952e key \u7684\u54c8\u5e0c\u503c hash = dict->type->hashFunction(key); # \u4f7f\u7528\u54c8\u5e0c\u8868\u7684 sizemask \u5c5e\u6027\u548c\u54c8\u5e0c\u503c\uff0c\u8ba1\u7b97\u51fa\u7d22\u5f15\u503c # \u6839\u636e\u60c5\u51b5\u4e0d\u540c\uff0c ht[x] \u53ef\u4ee5\u662f ht[0] \u6216\u8005 ht[1] index = hash & dict->ht[x].sizemask; \u5f53\u5b57\u5178\u88ab\u7528\u4f5c\u6570\u636e\u5e93\u7684\u5e95\u5c42\u5b9e\u73b0\uff0c \u6216\u8005\u54c8\u5e0c\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u65f6\uff0c Redis \u4f7f\u7528 MurmurHash2 \u7b97\u6cd5\u6765\u8ba1\u7b97\u952e\u7684\u54c8\u5e0c\u503c\u3002 MurmurHash \u7b97\u6cd5\u6700\u521d\u7531 Austin Appleby \u4e8e 2008 \u5e74\u53d1\u660e\uff0c \u8fd9\u79cd\u7b97\u6cd5\u7684\u4f18\u70b9\u5728\u4e8e\uff0c \u5373\u4f7f\u8f93\u5165\u7684\u952e\u662f\u6709\u89c4\u5f8b\u7684\uff0c \u7b97\u6cd5\u4ecd\u80fd\u7ed9\u51fa\u4e00\u4e2a\u5f88\u597d\u7684\u968f\u673a\u5206\u5e03\u6027\uff0c \u5e76\u4e14\u7b97\u6cd5\u7684\u8ba1\u7b97\u901f\u5ea6\u4e5f\u975e\u5e38\u5feb\u3002","title":"4.2 \u54c8\u5e0c\u7b97\u6cd5"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.2-%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/#42","text":"Redis \u8ba1\u7b97\u54c8\u5e0c\u503c\u548c\u7d22\u5f15\u503c\u7684\u65b9\u6cd5\u5982\u4e0b\uff1a # \u4f7f\u7528\u5b57\u5178\u8bbe\u7f6e\u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u8ba1\u7b97\u952e key \u7684\u54c8\u5e0c\u503c hash = dict->type->hashFunction(key); # \u4f7f\u7528\u54c8\u5e0c\u8868\u7684 sizemask \u5c5e\u6027\u548c\u54c8\u5e0c\u503c\uff0c\u8ba1\u7b97\u51fa\u7d22\u5f15\u503c # \u6839\u636e\u60c5\u51b5\u4e0d\u540c\uff0c ht[x] \u53ef\u4ee5\u662f ht[0] \u6216\u8005 ht[1] index = hash & dict->ht[x].sizemask; \u5f53\u5b57\u5178\u88ab\u7528\u4f5c\u6570\u636e\u5e93\u7684\u5e95\u5c42\u5b9e\u73b0\uff0c \u6216\u8005\u54c8\u5e0c\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u65f6\uff0c Redis \u4f7f\u7528 MurmurHash2 \u7b97\u6cd5\u6765\u8ba1\u7b97\u952e\u7684\u54c8\u5e0c\u503c\u3002 MurmurHash \u7b97\u6cd5\u6700\u521d\u7531 Austin Appleby \u4e8e 2008 \u5e74\u53d1\u660e\uff0c \u8fd9\u79cd\u7b97\u6cd5\u7684\u4f18\u70b9\u5728\u4e8e\uff0c \u5373\u4f7f\u8f93\u5165\u7684\u952e\u662f\u6709\u89c4\u5f8b\u7684\uff0c \u7b97\u6cd5\u4ecd\u80fd\u7ed9\u51fa\u4e00\u4e2a\u5f88\u597d\u7684\u968f\u673a\u5206\u5e03\u6027\uff0c \u5e76\u4e14\u7b97\u6cd5\u7684\u8ba1\u7b97\u901f\u5ea6\u4e5f\u975e\u5e38\u5feb\u3002","title":"4.2 \u54c8\u5e0c\u7b97\u6cd5"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.3-%E8%A7%A3%E5%86%B3%E9%94%AE%E5%86%B2%E7%AA%81/","text":"4.3 \u89e3\u51b3\u952e\u51b2\u7a81 \u5f53\u6709\u4e24\u4e2a\u6216\u4ee5\u4e0a\u6570\u91cf\u7684\u952e\u88ab\u5206\u914d\u5230\u4e86\u54c8\u5e0c\u8868\u6570\u7ec4\u7684\u540c\u4e00\u4e2a\u7d22\u5f15\u4e0a\u9762\u65f6\uff0c \u6211\u4eec\u79f0\u8fd9\u4e9b\u952e\u53d1\u751f\u4e86\u51b2\u7a81\uff08collision\uff09\u3002 Redis \u7684\u54c8\u5e0c\u8868\u4f7f\u7528\u94fe\u5730\u5740\u6cd5\uff08separate chaining\uff09\u6765\u89e3\u51b3\u952e\u51b2\u7a81 \uff1a \u6bcf\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\u90fd\u6709\u4e00\u4e2a next \u6307\u9488\uff0c \u591a\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\u53ef\u4ee5\u7528 next \u6307\u9488\u6784\u6210\u4e00\u4e2a\u5355\u5411\u94fe\u8868\uff0c \u88ab\u5206\u914d\u5230\u540c\u4e00\u4e2a\u7d22\u5f15\u4e0a\u7684\u591a\u4e2a\u8282\u70b9\u53ef\u4ee5\u7528\u8fd9\u4e2a\u5355\u5411\u94fe\u8868\u8fde\u63a5\u8d77\u6765\uff0c \u8fd9\u5c31\u89e3\u51b3\u4e86\u952e\u51b2\u7a81\u7684\u95ee\u9898\u3002 \u56e0\u4e3a dictEntry \u8282\u70b9\u7ec4\u6210\u7684\u94fe\u8868\u6ca1\u6709\u6307\u5411\u94fe\u8868\u8868\u5c3e\u7684\u6307\u9488\uff0c \u6240\u4ee5\u4e3a\u4e86\u901f\u5ea6\u8003\u8651\uff0c \u7a0b\u5e8f\u603b\u662f\u5c06\u65b0\u8282\u70b9\u6dfb\u52a0\u5230\u94fe\u8868\u7684\u8868\u5934\u4f4d\u7f6e\uff08\u590d\u6742\u5ea6\u4e3a O(1)\uff09\uff0c \u6392\u5728\u5176\u4ed6\u5df2\u6709\u8282\u70b9\u7684\u524d\u9762\u3002","title":"4.3 \u89e3\u51b3\u952e\u51b2\u7a81"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.3-%E8%A7%A3%E5%86%B3%E9%94%AE%E5%86%B2%E7%AA%81/#43","text":"\u5f53\u6709\u4e24\u4e2a\u6216\u4ee5\u4e0a\u6570\u91cf\u7684\u952e\u88ab\u5206\u914d\u5230\u4e86\u54c8\u5e0c\u8868\u6570\u7ec4\u7684\u540c\u4e00\u4e2a\u7d22\u5f15\u4e0a\u9762\u65f6\uff0c \u6211\u4eec\u79f0\u8fd9\u4e9b\u952e\u53d1\u751f\u4e86\u51b2\u7a81\uff08collision\uff09\u3002 Redis \u7684\u54c8\u5e0c\u8868\u4f7f\u7528\u94fe\u5730\u5740\u6cd5\uff08separate chaining\uff09\u6765\u89e3\u51b3\u952e\u51b2\u7a81 \uff1a \u6bcf\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\u90fd\u6709\u4e00\u4e2a next \u6307\u9488\uff0c \u591a\u4e2a\u54c8\u5e0c\u8868\u8282\u70b9\u53ef\u4ee5\u7528 next \u6307\u9488\u6784\u6210\u4e00\u4e2a\u5355\u5411\u94fe\u8868\uff0c \u88ab\u5206\u914d\u5230\u540c\u4e00\u4e2a\u7d22\u5f15\u4e0a\u7684\u591a\u4e2a\u8282\u70b9\u53ef\u4ee5\u7528\u8fd9\u4e2a\u5355\u5411\u94fe\u8868\u8fde\u63a5\u8d77\u6765\uff0c \u8fd9\u5c31\u89e3\u51b3\u4e86\u952e\u51b2\u7a81\u7684\u95ee\u9898\u3002 \u56e0\u4e3a dictEntry \u8282\u70b9\u7ec4\u6210\u7684\u94fe\u8868\u6ca1\u6709\u6307\u5411\u94fe\u8868\u8868\u5c3e\u7684\u6307\u9488\uff0c \u6240\u4ee5\u4e3a\u4e86\u901f\u5ea6\u8003\u8651\uff0c \u7a0b\u5e8f\u603b\u662f\u5c06\u65b0\u8282\u70b9\u6dfb\u52a0\u5230\u94fe\u8868\u7684\u8868\u5934\u4f4d\u7f6e\uff08\u590d\u6742\u5ea6\u4e3a O(1)\uff09\uff0c \u6392\u5728\u5176\u4ed6\u5df2\u6709\u8282\u70b9\u7684\u524d\u9762\u3002","title":"4.3 \u89e3\u51b3\u952e\u51b2\u7a81"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.4-rehash/","text":"4.4 Rehash \u968f\u7740\u64cd\u4f5c\u7684\u4e0d\u65ad\u6267\u884c\uff0c \u54c8\u5e0c\u8868\u4fdd\u5b58\u7684\u952e\u503c\u5bf9\u4f1a\u9010\u6e10\u5730\u589e\u591a\u6216\u8005\u51cf\u5c11\uff0c \u4e3a\u4e86\u8ba9\u54c8\u5e0c\u8868\u7684\u8d1f\u8f7d\u56e0\u5b50\uff08load factor\uff09\u7ef4\u6301\u5728\u4e00\u4e2a\u5408\u7406\u7684\u8303\u56f4\u4e4b\u5185\uff0c \u5f53\u54c8\u5e0c\u8868\u4fdd\u5b58\u7684\u952e\u503c\u5bf9\u6570\u91cf\u592a\u591a\u6216\u8005\u592a\u5c11\u65f6\uff0c \u7a0b\u5e8f\u9700\u8981\u5bf9\u54c8\u5e0c\u8868\u7684\u5927\u5c0f\u8fdb\u884c\u76f8\u5e94\u7684\u6269\u5c55\u6216\u8005\u6536\u7f29\u3002 \u6269\u5c55\u548c\u6536\u7f29\u54c8\u5e0c\u8868\u7684\u5de5\u4f5c\u53ef\u4ee5 \u901a\u8fc7\u6267\u884c rehash \uff08\u91cd\u65b0\u6563\u5217\uff09\u64cd\u4f5c\u6765\u5b8c\u6210 \uff0c Redis \u5bf9\u5b57\u5178\u7684\u54c8\u5e0c\u8868\u6267\u884c rehash \u7684\u6b65\u9aa4\u5982\u4e0b\uff1a \u4e3a\u5b57\u5178\u7684 ht[1] \u54c8\u5e0c\u8868\u5206\u914d\u7a7a\u95f4\uff0c \u8fd9\u4e2a\u54c8\u5e0c\u8868\u7684\u7a7a\u95f4\u5927\u5c0f\u53d6\u51b3\u4e8e\u8981\u6267\u884c\u7684\u64cd\u4f5c\uff0c \u4ee5\u53ca ht[0] \u5f53\u524d\u5305\u542b\u7684\u952e\u503c\u5bf9\u6570\u91cf \uff08\u4e5f\u5373\u662f ht[0].used \u5c5e\u6027\u7684\u503c\uff09\uff1a \u5982\u679c\u6267\u884c\u7684\u662f\u6269\u5c55\u64cd\u4f5c\uff0c \u90a3\u4e48 ht[1] \u7684\u5927\u5c0f\u4e3a\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e ht[0].used * 2 \u7684 2^n \uff08 2 \u7684 n \u6b21\u65b9\u5e42\uff09\uff1b \u5982\u679c\u6267\u884c\u7684\u662f\u6536\u7f29\u64cd\u4f5c\uff0c \u90a3\u4e48 ht[1] \u7684\u5927\u5c0f\u4e3a\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e ht[0].used \u7684 2^n \u3002 \u5c06\u4fdd\u5b58\u5728 ht[0] \u4e2d\u7684\u6240\u6709\u952e\u503c\u5bf9 rehash \u5230 ht[1] \u4e0a\u9762\uff1a rehash \u6307\u7684\u662f\u91cd\u65b0\u8ba1\u7b97\u952e\u7684\u54c8\u5e0c\u503c\u548c\u7d22\u5f15\u503c\uff0c \u7136\u540e\u5c06\u952e\u503c\u5bf9\u653e\u7f6e\u5230 ht[1] \u54c8\u5e0c\u8868\u7684\u6307\u5b9a\u4f4d\u7f6e\u4e0a\u3002 \u5f53 ht[0] \u5305\u542b\u7684\u6240\u6709\u952e\u503c\u5bf9\u90fd\u8fc1\u79fb\u5230\u4e86 ht[1] \u4e4b\u540e \uff08 ht[0] \u53d8\u4e3a\u7a7a\u8868\uff09\uff0c \u91ca\u653e ht[0] \uff0c \u5c06 ht[1] \u8bbe\u7f6e\u4e3a ht[0] \uff0c \u5e76\u5728 ht[1] \u65b0\u521b\u5efa\u4e00\u4e2a\u7a7a\u767d\u54c8\u5e0c\u8868\uff0c \u4e3a\u4e0b\u4e00\u6b21 rehash \u505a\u51c6\u5907\u3002 \u54c8\u5e0c\u8868\u7684\u6269\u5c55\u4e0e\u6536\u7f29 \u5f53\u4ee5\u4e0b\u6761\u4ef6\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u88ab\u6ee1\u8db3\u65f6\uff0c \u7a0b\u5e8f\u4f1a\u81ea\u52a8\u5f00\u59cb\u5bf9\u54c8\u5e0c\u8868\u6267\u884c\u6269\u5c55\u64cd\u4f5c\uff1a \u670d\u52a1\u5668\u76ee\u524d\u6ca1\u6709\u5728\u6267\u884c BGSAVE \u547d\u4ee4\u6216\u8005 BGREWRITEAOF \u547d\u4ee4\uff0c \u5e76\u4e14\u54c8\u5e0c\u8868\u7684\u8d1f\u8f7d\u56e0\u5b50\u5927\u4e8e\u7b49\u4e8e 1 \uff1b \u670d\u52a1\u5668\u76ee\u524d\u6b63\u5728\u6267\u884c BGSAVE \u547d\u4ee4\u6216\u8005 BGREWRITEAOF \u547d\u4ee4\uff0c \u5e76\u4e14\u54c8\u5e0c\u8868\u7684\u8d1f\u8f7d\u56e0\u5b50\u5927\u4e8e\u7b49\u4e8e 0.5 \uff1b \u5176\u4e2d\u54c8\u5e0c\u8868\u7684\u8d1f\u8f7d\u56e0\u5b50\u53ef\u4ee5\u901a\u8fc7\u516c\u5f0f\uff1a # \u8d1f\u8f7d\u56e0\u5b50 = \u54c8\u5e0c\u8868\u5df2\u4fdd\u5b58\u8282\u70b9\u6570\u91cf / \u54c8\u5e0c\u8868\u5927\u5c0f load_factor = ht[0].used / ht[0].size \u6839\u636e BGSAVE \u547d\u4ee4\u6216 BGREWRITEAOF \u547d\u4ee4\u662f\u5426\u6b63\u5728\u6267\u884c\uff0c \u670d\u52a1\u5668\u6267\u884c\u6269\u5c55\u64cd\u4f5c\u6240\u9700\u7684\u8d1f\u8f7d\u56e0\u5b50\u5e76\u4e0d\u76f8\u540c\uff0c \u8fd9\u662f\u56e0\u4e3a\u5728\u6267\u884c BGSAVE \u547d\u4ee4\u6216 BGREWRITEAOF \u547d\u4ee4\u7684\u8fc7\u7a0b\u4e2d\uff0c Redis \u9700\u8981\u521b\u5efa\u5f53\u524d\u670d\u52a1\u5668\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\uff0c \u800c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u91c7\u7528\u5199\u65f6\u590d\u5236\uff08 copy-on-write \uff09\u6280\u672f\u6765\u4f18\u5316\u5b50\u8fdb\u7a0b\u7684\u4f7f\u7528\u6548\u7387\uff0c \u6240\u4ee5\u5728\u5b50\u8fdb\u7a0b\u5b58\u5728\u671f\u95f4\uff0c \u670d\u52a1\u5668\u4f1a\u63d0\u9ad8\u6267\u884c\u6269\u5c55\u64cd\u4f5c\u6240\u9700\u7684\u8d1f\u8f7d\u56e0\u5b50\uff0c \u4ece\u800c\u5c3d\u53ef\u80fd\u5730\u907f\u514d\u5728\u5b50\u8fdb\u7a0b\u5b58\u5728\u671f\u95f4\u8fdb\u884c\u54c8\u5e0c\u8868\u6269\u5c55\u64cd\u4f5c\uff0c \u8fd9\u53ef\u4ee5\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u5185\u5b58\u5199\u5165\u64cd\u4f5c\uff0c \u6700\u5927\u9650\u5ea6\u5730\u8282\u7ea6\u5185\u5b58\u3002 \u53e6\u4e00\u65b9\u9762\uff0c \u5f53\u54c8\u5e0c\u8868\u7684\u8d1f\u8f7d\u56e0\u5b50\u5c0f\u4e8e 0.1 \u65f6\uff0c \u7a0b\u5e8f\u81ea\u52a8\u5f00\u59cb\u5bf9\u54c8\u5e0c\u8868\u6267\u884c\u6536\u7f29\u64cd\u4f5c\u3002 \u6269\u5c55\u7b80\u5355\u7406\u89e3\u662f\u662f\u7ffb\u500d\u64cd\u4f5c\u3002","title":"4.4 Rehash"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.4-rehash/#44-rehash","text":"\u968f\u7740\u64cd\u4f5c\u7684\u4e0d\u65ad\u6267\u884c\uff0c \u54c8\u5e0c\u8868\u4fdd\u5b58\u7684\u952e\u503c\u5bf9\u4f1a\u9010\u6e10\u5730\u589e\u591a\u6216\u8005\u51cf\u5c11\uff0c \u4e3a\u4e86\u8ba9\u54c8\u5e0c\u8868\u7684\u8d1f\u8f7d\u56e0\u5b50\uff08load factor\uff09\u7ef4\u6301\u5728\u4e00\u4e2a\u5408\u7406\u7684\u8303\u56f4\u4e4b\u5185\uff0c \u5f53\u54c8\u5e0c\u8868\u4fdd\u5b58\u7684\u952e\u503c\u5bf9\u6570\u91cf\u592a\u591a\u6216\u8005\u592a\u5c11\u65f6\uff0c \u7a0b\u5e8f\u9700\u8981\u5bf9\u54c8\u5e0c\u8868\u7684\u5927\u5c0f\u8fdb\u884c\u76f8\u5e94\u7684\u6269\u5c55\u6216\u8005\u6536\u7f29\u3002 \u6269\u5c55\u548c\u6536\u7f29\u54c8\u5e0c\u8868\u7684\u5de5\u4f5c\u53ef\u4ee5 \u901a\u8fc7\u6267\u884c rehash \uff08\u91cd\u65b0\u6563\u5217\uff09\u64cd\u4f5c\u6765\u5b8c\u6210 \uff0c Redis \u5bf9\u5b57\u5178\u7684\u54c8\u5e0c\u8868\u6267\u884c rehash \u7684\u6b65\u9aa4\u5982\u4e0b\uff1a \u4e3a\u5b57\u5178\u7684 ht[1] \u54c8\u5e0c\u8868\u5206\u914d\u7a7a\u95f4\uff0c \u8fd9\u4e2a\u54c8\u5e0c\u8868\u7684\u7a7a\u95f4\u5927\u5c0f\u53d6\u51b3\u4e8e\u8981\u6267\u884c\u7684\u64cd\u4f5c\uff0c \u4ee5\u53ca ht[0] \u5f53\u524d\u5305\u542b\u7684\u952e\u503c\u5bf9\u6570\u91cf \uff08\u4e5f\u5373\u662f ht[0].used \u5c5e\u6027\u7684\u503c\uff09\uff1a \u5982\u679c\u6267\u884c\u7684\u662f\u6269\u5c55\u64cd\u4f5c\uff0c \u90a3\u4e48 ht[1] \u7684\u5927\u5c0f\u4e3a\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e ht[0].used * 2 \u7684 2^n \uff08 2 \u7684 n \u6b21\u65b9\u5e42\uff09\uff1b \u5982\u679c\u6267\u884c\u7684\u662f\u6536\u7f29\u64cd\u4f5c\uff0c \u90a3\u4e48 ht[1] \u7684\u5927\u5c0f\u4e3a\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e ht[0].used \u7684 2^n \u3002 \u5c06\u4fdd\u5b58\u5728 ht[0] \u4e2d\u7684\u6240\u6709\u952e\u503c\u5bf9 rehash \u5230 ht[1] \u4e0a\u9762\uff1a rehash \u6307\u7684\u662f\u91cd\u65b0\u8ba1\u7b97\u952e\u7684\u54c8\u5e0c\u503c\u548c\u7d22\u5f15\u503c\uff0c \u7136\u540e\u5c06\u952e\u503c\u5bf9\u653e\u7f6e\u5230 ht[1] \u54c8\u5e0c\u8868\u7684\u6307\u5b9a\u4f4d\u7f6e\u4e0a\u3002 \u5f53 ht[0] \u5305\u542b\u7684\u6240\u6709\u952e\u503c\u5bf9\u90fd\u8fc1\u79fb\u5230\u4e86 ht[1] \u4e4b\u540e \uff08 ht[0] \u53d8\u4e3a\u7a7a\u8868\uff09\uff0c \u91ca\u653e ht[0] \uff0c \u5c06 ht[1] \u8bbe\u7f6e\u4e3a ht[0] \uff0c \u5e76\u5728 ht[1] \u65b0\u521b\u5efa\u4e00\u4e2a\u7a7a\u767d\u54c8\u5e0c\u8868\uff0c \u4e3a\u4e0b\u4e00\u6b21 rehash \u505a\u51c6\u5907\u3002","title":"4.4 Rehash"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.4-rehash/#_1","text":"\u5f53\u4ee5\u4e0b\u6761\u4ef6\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u88ab\u6ee1\u8db3\u65f6\uff0c \u7a0b\u5e8f\u4f1a\u81ea\u52a8\u5f00\u59cb\u5bf9\u54c8\u5e0c\u8868\u6267\u884c\u6269\u5c55\u64cd\u4f5c\uff1a \u670d\u52a1\u5668\u76ee\u524d\u6ca1\u6709\u5728\u6267\u884c BGSAVE \u547d\u4ee4\u6216\u8005 BGREWRITEAOF \u547d\u4ee4\uff0c \u5e76\u4e14\u54c8\u5e0c\u8868\u7684\u8d1f\u8f7d\u56e0\u5b50\u5927\u4e8e\u7b49\u4e8e 1 \uff1b \u670d\u52a1\u5668\u76ee\u524d\u6b63\u5728\u6267\u884c BGSAVE \u547d\u4ee4\u6216\u8005 BGREWRITEAOF \u547d\u4ee4\uff0c \u5e76\u4e14\u54c8\u5e0c\u8868\u7684\u8d1f\u8f7d\u56e0\u5b50\u5927\u4e8e\u7b49\u4e8e 0.5 \uff1b \u5176\u4e2d\u54c8\u5e0c\u8868\u7684\u8d1f\u8f7d\u56e0\u5b50\u53ef\u4ee5\u901a\u8fc7\u516c\u5f0f\uff1a # \u8d1f\u8f7d\u56e0\u5b50 = \u54c8\u5e0c\u8868\u5df2\u4fdd\u5b58\u8282\u70b9\u6570\u91cf / \u54c8\u5e0c\u8868\u5927\u5c0f load_factor = ht[0].used / ht[0].size \u6839\u636e BGSAVE \u547d\u4ee4\u6216 BGREWRITEAOF \u547d\u4ee4\u662f\u5426\u6b63\u5728\u6267\u884c\uff0c \u670d\u52a1\u5668\u6267\u884c\u6269\u5c55\u64cd\u4f5c\u6240\u9700\u7684\u8d1f\u8f7d\u56e0\u5b50\u5e76\u4e0d\u76f8\u540c\uff0c \u8fd9\u662f\u56e0\u4e3a\u5728\u6267\u884c BGSAVE \u547d\u4ee4\u6216 BGREWRITEAOF \u547d\u4ee4\u7684\u8fc7\u7a0b\u4e2d\uff0c Redis \u9700\u8981\u521b\u5efa\u5f53\u524d\u670d\u52a1\u5668\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\uff0c \u800c\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u90fd\u91c7\u7528\u5199\u65f6\u590d\u5236\uff08 copy-on-write \uff09\u6280\u672f\u6765\u4f18\u5316\u5b50\u8fdb\u7a0b\u7684\u4f7f\u7528\u6548\u7387\uff0c \u6240\u4ee5\u5728\u5b50\u8fdb\u7a0b\u5b58\u5728\u671f\u95f4\uff0c \u670d\u52a1\u5668\u4f1a\u63d0\u9ad8\u6267\u884c\u6269\u5c55\u64cd\u4f5c\u6240\u9700\u7684\u8d1f\u8f7d\u56e0\u5b50\uff0c \u4ece\u800c\u5c3d\u53ef\u80fd\u5730\u907f\u514d\u5728\u5b50\u8fdb\u7a0b\u5b58\u5728\u671f\u95f4\u8fdb\u884c\u54c8\u5e0c\u8868\u6269\u5c55\u64cd\u4f5c\uff0c \u8fd9\u53ef\u4ee5\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u5185\u5b58\u5199\u5165\u64cd\u4f5c\uff0c \u6700\u5927\u9650\u5ea6\u5730\u8282\u7ea6\u5185\u5b58\u3002 \u53e6\u4e00\u65b9\u9762\uff0c \u5f53\u54c8\u5e0c\u8868\u7684\u8d1f\u8f7d\u56e0\u5b50\u5c0f\u4e8e 0.1 \u65f6\uff0c \u7a0b\u5e8f\u81ea\u52a8\u5f00\u59cb\u5bf9\u54c8\u5e0c\u8868\u6267\u884c\u6536\u7f29\u64cd\u4f5c\u3002 \u6269\u5c55\u7b80\u5355\u7406\u89e3\u662f\u662f\u7ffb\u500d\u64cd\u4f5c\u3002","title":"\u54c8\u5e0c\u8868\u7684\u6269\u5c55\u4e0e\u6536\u7f29"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.5-%E6%B8%90%E8%BF%9B%E5%BC%8F%20rehash/","text":"4.5 \u6e10\u8fdb\u5f0f rehash \u4e3a\u4e86\u907f\u514d rehash \u5bf9\u670d\u52a1\u5668\u6027\u80fd\u9020\u6210\u5f71\u54cd\uff0c \u670d\u52a1\u5668\u4e0d\u662f\u4e00\u6b21\u6027\u5c06 ht[0] \u91cc\u9762\u7684\u6240\u6709\u952e\u503c\u5bf9\u5168\u90e8 rehash \u5230 ht[1] \uff0c \u800c\u662f\u5206\u591a\u6b21\u3001\u6e10\u8fdb\u5f0f\u5730\u5c06 ht[0] \u91cc\u9762\u7684\u952e\u503c\u5bf9\u6162\u6162\u5730 rehash \u5230 ht[1] \u3002 \u4ee5\u4e0b\u662f\u54c8\u5e0c\u8868\u6e10\u8fdb\u5f0f rehash \u7684\u8be6\u7ec6\u6b65\u9aa4\uff1a \u4e3a ht[1] \u5206\u914d\u7a7a\u95f4\uff0c \u8ba9\u5b57\u5178\u540c\u65f6\u6301\u6709 ht[0] \u548c ht[1] \u4e24\u4e2a\u54c8\u5e0c\u8868\u3002 \u5728\u5b57\u5178\u4e2d\u7ef4\u6301\u4e00\u4e2a\u7d22\u5f15\u8ba1\u6570\u5668\u53d8\u91cf rehashidx \uff0c \u5e76\u5c06\u5b83\u7684\u503c\u8bbe\u7f6e\u4e3a 0 \uff0c \u8868\u793a rehash \u5de5\u4f5c\u6b63\u5f0f\u5f00\u59cb\u3002 \u5728 rehash \u8fdb\u884c\u671f\u95f4\uff0c \u6bcf\u6b21\u5bf9\u5b57\u5178\u6267\u884c\u6dfb\u52a0\u3001\u5220\u9664\u3001\u67e5\u627e\u6216\u8005\u66f4\u65b0\u64cd\u4f5c\u65f6\uff0c \u7a0b\u5e8f\u9664\u4e86\u6267\u884c\u6307\u5b9a\u7684\u64cd\u4f5c\u4ee5\u5916\uff0c \u8fd8\u4f1a\u987a\u5e26\u5c06 ht[0] \u54c8\u5e0c\u8868\u5728 rehashidx \u7d22\u5f15\u4e0a\u7684\u6240\u6709\u952e\u503c\u5bf9 rehash \u5230 ht[1] \uff0c \u5f53 rehash \u5de5\u4f5c\u5b8c\u6210\u4e4b\u540e\uff0c \u7a0b\u5e8f\u5c06 rehashidx \u5c5e\u6027\u7684\u503c\u589e\u4e00\u3002 \u968f\u7740\u5b57\u5178\u64cd\u4f5c\u7684\u4e0d\u65ad\u6267\u884c\uff0c \u6700\u7ec8\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u4e0a\uff0c ht[0] \u7684\u6240\u6709\u952e\u503c\u5bf9\u90fd\u4f1a\u88ab rehash \u81f3 ht[1] \uff0c \u8fd9\u65f6\u7a0b\u5e8f\u5c06 rehashidx \u5c5e\u6027\u7684\u503c\u8bbe\u4e3a -1 \uff0c \u8868\u793a rehash \u64cd\u4f5c\u5df2\u5b8c\u6210\u3002 \u6e10\u8fdb\u5f0f rehash \u6267\u884c\u671f\u95f4\u7684\u54c8\u5e0c\u8868\u64cd\u4f5c \u5728 rehash \u9636\u6bb5\uff0c\u4e00\u4e2a\u5b57\u5178\u4f1a\u51fa\u73b0\u4e24\u4e2a\u54c8\u5e0c\u8868\uff0c\u5bf9\u5b57\u5178\u7684\u589e\u5220\u67e5\u66f4\u64cd\u4f5c\u90fd\u4f1a\u5728\u53e6\u4e2a\u54c8\u5e0c\u8868\u8fdb\u884c\u64cd\u4f5c\u3002 \u6e10\u8fdb\u5f0f rehash \u7684\u597d\u5904\u662f\u53ef\u4ee5\u9010\u6b65\u8fdb\u884c\uff0c\u907f\u514d\u4e86 rehash \u54c8\u5e0c\u8868\u8fc7\u5927\u5bfc\u81f4\u670d\u52a1\u4e0d\u53ef\u7528\u3002","title":"4.5 \u6e10\u8fdb\u5f0f rehash"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.5-%E6%B8%90%E8%BF%9B%E5%BC%8F%20rehash/#45-rehash","text":"\u4e3a\u4e86\u907f\u514d rehash \u5bf9\u670d\u52a1\u5668\u6027\u80fd\u9020\u6210\u5f71\u54cd\uff0c \u670d\u52a1\u5668\u4e0d\u662f\u4e00\u6b21\u6027\u5c06 ht[0] \u91cc\u9762\u7684\u6240\u6709\u952e\u503c\u5bf9\u5168\u90e8 rehash \u5230 ht[1] \uff0c \u800c\u662f\u5206\u591a\u6b21\u3001\u6e10\u8fdb\u5f0f\u5730\u5c06 ht[0] \u91cc\u9762\u7684\u952e\u503c\u5bf9\u6162\u6162\u5730 rehash \u5230 ht[1] \u3002 \u4ee5\u4e0b\u662f\u54c8\u5e0c\u8868\u6e10\u8fdb\u5f0f rehash \u7684\u8be6\u7ec6\u6b65\u9aa4\uff1a \u4e3a ht[1] \u5206\u914d\u7a7a\u95f4\uff0c \u8ba9\u5b57\u5178\u540c\u65f6\u6301\u6709 ht[0] \u548c ht[1] \u4e24\u4e2a\u54c8\u5e0c\u8868\u3002 \u5728\u5b57\u5178\u4e2d\u7ef4\u6301\u4e00\u4e2a\u7d22\u5f15\u8ba1\u6570\u5668\u53d8\u91cf rehashidx \uff0c \u5e76\u5c06\u5b83\u7684\u503c\u8bbe\u7f6e\u4e3a 0 \uff0c \u8868\u793a rehash \u5de5\u4f5c\u6b63\u5f0f\u5f00\u59cb\u3002 \u5728 rehash \u8fdb\u884c\u671f\u95f4\uff0c \u6bcf\u6b21\u5bf9\u5b57\u5178\u6267\u884c\u6dfb\u52a0\u3001\u5220\u9664\u3001\u67e5\u627e\u6216\u8005\u66f4\u65b0\u64cd\u4f5c\u65f6\uff0c \u7a0b\u5e8f\u9664\u4e86\u6267\u884c\u6307\u5b9a\u7684\u64cd\u4f5c\u4ee5\u5916\uff0c \u8fd8\u4f1a\u987a\u5e26\u5c06 ht[0] \u54c8\u5e0c\u8868\u5728 rehashidx \u7d22\u5f15\u4e0a\u7684\u6240\u6709\u952e\u503c\u5bf9 rehash \u5230 ht[1] \uff0c \u5f53 rehash \u5de5\u4f5c\u5b8c\u6210\u4e4b\u540e\uff0c \u7a0b\u5e8f\u5c06 rehashidx \u5c5e\u6027\u7684\u503c\u589e\u4e00\u3002 \u968f\u7740\u5b57\u5178\u64cd\u4f5c\u7684\u4e0d\u65ad\u6267\u884c\uff0c \u6700\u7ec8\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u4e0a\uff0c ht[0] \u7684\u6240\u6709\u952e\u503c\u5bf9\u90fd\u4f1a\u88ab rehash \u81f3 ht[1] \uff0c \u8fd9\u65f6\u7a0b\u5e8f\u5c06 rehashidx \u5c5e\u6027\u7684\u503c\u8bbe\u4e3a -1 \uff0c \u8868\u793a rehash \u64cd\u4f5c\u5df2\u5b8c\u6210\u3002","title":"4.5 \u6e10\u8fdb\u5f0f rehash"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.5-%E6%B8%90%E8%BF%9B%E5%BC%8F%20rehash/#rehash","text":"\u5728 rehash \u9636\u6bb5\uff0c\u4e00\u4e2a\u5b57\u5178\u4f1a\u51fa\u73b0\u4e24\u4e2a\u54c8\u5e0c\u8868\uff0c\u5bf9\u5b57\u5178\u7684\u589e\u5220\u67e5\u66f4\u64cd\u4f5c\u90fd\u4f1a\u5728\u53e6\u4e2a\u54c8\u5e0c\u8868\u8fdb\u884c\u64cd\u4f5c\u3002 \u6e10\u8fdb\u5f0f rehash \u7684\u597d\u5904\u662f\u53ef\u4ee5\u9010\u6b65\u8fdb\u884c\uff0c\u907f\u514d\u4e86 rehash \u54c8\u5e0c\u8868\u8fc7\u5927\u5bfc\u81f4\u670d\u52a1\u4e0d\u53ef\u7528\u3002","title":"\u6e10\u8fdb\u5f0f rehash \u6267\u884c\u671f\u95f4\u7684\u54c8\u5e0c\u8868\u64cd\u4f5c"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.6-%E5%AD%97%E5%85%B8%20API/","text":"4.6 \u5b57\u5178 API \u51fd\u6570 \u4f5c\u7528 \u65f6\u95f4\u590d\u6742\u5ea6 dictCreate \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5b57\u5178\u3002 O(1) dictAdd \u5c06\u7ed9\u5b9a\u7684\u952e\u503c\u5bf9\u6dfb\u52a0\u5230\u5b57\u5178\u91cc\u9762\u3002 O(1) dictReplace \u5c06\u7ed9\u5b9a\u7684\u952e\u503c\u5bf9\u6dfb\u52a0\u5230\u5b57\u5178\u91cc\u9762\uff0c \u5982\u679c\u952e\u5df2\u7ecf\u5b58\u5728\u4e8e\u5b57\u5178\uff0c\u90a3\u4e48\u7528\u65b0\u503c\u53d6\u4ee3\u539f\u6709\u7684\u503c\u3002 O(1) dictFetchValue \u8fd4\u56de\u7ed9\u5b9a\u952e\u7684\u503c\u3002 O(1) dictGetRandomKey \u4ece\u5b57\u5178\u4e2d\u968f\u673a\u8fd4\u56de\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 O(1) dictDelete \u4ece\u5b57\u5178\u4e2d\u5220\u9664\u7ed9\u5b9a\u952e\u6240\u5bf9\u5e94\u7684\u952e\u503c\u5bf9\u3002 O(1) dictRelease \u91ca\u653e\u7ed9\u5b9a\u5b57\u5178\uff0c\u4ee5\u53ca\u5b57\u5178\u4e2d\u5305\u542b\u7684\u6240\u6709\u952e\u503c\u5bf9\u3002 O(N) \uff0c N \u4e3a\u5b57\u5178\u5305\u542b\u7684\u952e\u503c\u5bf9\u6570\u91cf\u3002","title":"4.6 \u5b57\u5178 API"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/4.6-%E5%AD%97%E5%85%B8%20API/#46-api","text":"\u51fd\u6570 \u4f5c\u7528 \u65f6\u95f4\u590d\u6742\u5ea6 dictCreate \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5b57\u5178\u3002 O(1) dictAdd \u5c06\u7ed9\u5b9a\u7684\u952e\u503c\u5bf9\u6dfb\u52a0\u5230\u5b57\u5178\u91cc\u9762\u3002 O(1) dictReplace \u5c06\u7ed9\u5b9a\u7684\u952e\u503c\u5bf9\u6dfb\u52a0\u5230\u5b57\u5178\u91cc\u9762\uff0c \u5982\u679c\u952e\u5df2\u7ecf\u5b58\u5728\u4e8e\u5b57\u5178\uff0c\u90a3\u4e48\u7528\u65b0\u503c\u53d6\u4ee3\u539f\u6709\u7684\u503c\u3002 O(1) dictFetchValue \u8fd4\u56de\u7ed9\u5b9a\u952e\u7684\u503c\u3002 O(1) dictGetRandomKey \u4ece\u5b57\u5178\u4e2d\u968f\u673a\u8fd4\u56de\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 O(1) dictDelete \u4ece\u5b57\u5178\u4e2d\u5220\u9664\u7ed9\u5b9a\u952e\u6240\u5bf9\u5e94\u7684\u952e\u503c\u5bf9\u3002 O(1) dictRelease \u91ca\u653e\u7ed9\u5b9a\u5b57\u5178\uff0c\u4ee5\u53ca\u5b57\u5178\u4e2d\u5305\u542b\u7684\u6240\u6709\u952e\u503c\u5bf9\u3002 O(N) \uff0c N \u4e3a\u5b57\u5178\u5305\u542b\u7684\u952e\u503c\u5bf9\u6570\u91cf\u3002","title":"4.6 \u5b57\u5178 API"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/5.0-%E8%B7%B3%E8%B7%83%E8%A1%A8/","text":"5.0 \u8df3\u8dc3\u8868 \u8df3\u8dc3\u8868\uff08skiplist\uff09\u662f\u4e00\u79cd\u6709\u5e8f\u6570\u636e\u7ed3\u6784\uff0c \u5b83\u901a\u8fc7\u5728\u6bcf\u4e2a\u8282\u70b9\u4e2d\u7ef4\u6301\u591a\u4e2a\u6307\u5411\u5176\u4ed6\u8282\u70b9\u7684\u6307\u9488\uff0c \u4ece\u800c\u8fbe\u5230\u5feb\u901f\u8bbf\u95ee\u8282\u70b9\u7684\u76ee\u7684\u3002 \u8df3\u8dc3\u8868 =\u300b \u6709\u5e8f\u96c6\u5408\u952e \u8df3\u8dc3\u8868\u5728 Redis \u4f7f\u7528\uff1a \u5b9e\u73b0\u6709\u5e8f\u96c6\u5408\u952e\uff1b \u5728\u96c6\u7fa4\u8282\u70b9\u4e2d\u4f5c\u4e3a\u5185\u90e8\u6570\u636e\u7ed3\u6784\u3002 \u8df3\u8dc3\u8868\u7684\u5b9e\u73b0 typedef struct zskiplistNode { robj *obj; // \u5206\u503c double score; // \u540e\u9000\u6307\u9488 struct zskiplistNode *backward; // \u5c42 struct zskiplistLevel { // \u524d\u8fdb\u6307\u9488 struct zskiplistNode *forward; // \u8de8\u5ea6 unsigned int span; } level[]; } zskiplistNode; typedef struct zskiplist { struct zskiplistNode *header, *tail; unsigned long length; int level; } zskiplist; zskiplist Struct header \uff1a\u6307\u5411\u8df3\u8dc3\u8868\u7684\u8868\u5934\u8282\u70b9\u3002 tail \uff1a\u6307\u5411\u8df3\u8dc3\u8868\u7684\u8868\u5c3e\u8282\u70b9\u3002 level \uff1a\u8bb0\u5f55\u76ee\u524d\u8df3\u8dc3\u8868\u5185\uff0c\u5c42\u6570\u6700\u5927\u7684\u90a3\u4e2a\u8282\u70b9\u7684\u5c42\u6570\uff08\u8868\u5934\u8282\u70b9\u7684\u5c42\u6570\u4e0d\u8ba1\u7b97\u5728\u5185\uff09\u3002 length \uff1a\u8bb0\u5f55\u8df3\u8dc3\u8868\u7684\u957f\u5ea6\uff0c\u4e5f\u5373\u662f\uff0c\u8df3\u8dc3\u8868\u76ee\u524d\u5305\u542b\u8282\u70b9\u7684\u6570\u91cf\uff08\u8868\u5934\u8282\u70b9\u4e0d\u8ba1\u7b97\u5728\u5185\uff09\u3002 \u603b\u7ed3 \u8df3\u8dc3\u8868\u662f\u6709\u5e8f\u96c6\u5408\u7684\u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00\uff0c \u9664\u6b64\u4e4b\u5916\u5b83\u5728 Redis \u4e2d\u6ca1\u6709\u5176\u4ed6\u5e94\u7528\u3002 Redis \u7684\u8df3\u8dc3\u8868\u5b9e\u73b0\u7531 zskiplist \u548c zskiplistNode \u4e24\u4e2a\u7ed3\u6784\u7ec4\u6210\uff0c \u5176\u4e2d zskiplist \u7528\u4e8e\u4fdd\u5b58\u8df3\u8dc3\u8868\u4fe1\u606f\uff08\u6bd4\u5982\u8868\u5934\u8282\u70b9\u3001\u8868\u5c3e\u8282\u70b9\u3001\u957f\u5ea6\uff09\uff0c \u800c zskiplistNode \u5219\u7528\u4e8e\u8868\u793a\u8df3\u8dc3\u8868\u8282\u70b9\u3002 \u6bcf\u4e2a\u8df3\u8dc3\u8868\u8282\u70b9\u7684\u5c42\u9ad8\u90fd\u662f 1 \u81f3 32 \u4e4b\u95f4\u7684\u968f\u673a\u6570\u3002 \u5728\u540c\u4e00\u4e2a\u8df3\u8dc3\u8868\u4e2d\uff0c \u591a\u4e2a\u8282\u70b9\u53ef\u4ee5\u5305\u542b\u76f8\u540c\u7684\u5206\u503c\uff0c \u4f46\u6bcf\u4e2a\u8282\u70b9\u7684\u6210\u5458\u5bf9\u8c61\u5fc5\u987b\u662f\u552f\u4e00\u7684\u3002 \u8df3\u8dc3\u8868\u4e2d\u7684\u8282\u70b9\u6309\u7167\u5206\u503c\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f\uff0c \u5f53\u5206\u503c\u76f8\u540c\u65f6\uff0c \u8282\u70b9\u6309\u7167\u6210\u5458\u5bf9\u8c61\u7684\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f\u3002","title":"5.0 \u8df3\u8dc3\u8868"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/5.0-%E8%B7%B3%E8%B7%83%E8%A1%A8/#50","text":"\u8df3\u8dc3\u8868\uff08skiplist\uff09\u662f\u4e00\u79cd\u6709\u5e8f\u6570\u636e\u7ed3\u6784\uff0c \u5b83\u901a\u8fc7\u5728\u6bcf\u4e2a\u8282\u70b9\u4e2d\u7ef4\u6301\u591a\u4e2a\u6307\u5411\u5176\u4ed6\u8282\u70b9\u7684\u6307\u9488\uff0c \u4ece\u800c\u8fbe\u5230\u5feb\u901f\u8bbf\u95ee\u8282\u70b9\u7684\u76ee\u7684\u3002 \u8df3\u8dc3\u8868 =\u300b \u6709\u5e8f\u96c6\u5408\u952e \u8df3\u8dc3\u8868\u5728 Redis \u4f7f\u7528\uff1a \u5b9e\u73b0\u6709\u5e8f\u96c6\u5408\u952e\uff1b \u5728\u96c6\u7fa4\u8282\u70b9\u4e2d\u4f5c\u4e3a\u5185\u90e8\u6570\u636e\u7ed3\u6784\u3002","title":"5.0 \u8df3\u8dc3\u8868"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/5.0-%E8%B7%B3%E8%B7%83%E8%A1%A8/#_1","text":"typedef struct zskiplistNode { robj *obj; // \u5206\u503c double score; // \u540e\u9000\u6307\u9488 struct zskiplistNode *backward; // \u5c42 struct zskiplistLevel { // \u524d\u8fdb\u6307\u9488 struct zskiplistNode *forward; // \u8de8\u5ea6 unsigned int span; } level[]; } zskiplistNode; typedef struct zskiplist { struct zskiplistNode *header, *tail; unsigned long length; int level; } zskiplist;","title":"\u8df3\u8dc3\u8868\u7684\u5b9e\u73b0"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/5.0-%E8%B7%B3%E8%B7%83%E8%A1%A8/#zskiplist-struct","text":"header \uff1a\u6307\u5411\u8df3\u8dc3\u8868\u7684\u8868\u5934\u8282\u70b9\u3002 tail \uff1a\u6307\u5411\u8df3\u8dc3\u8868\u7684\u8868\u5c3e\u8282\u70b9\u3002 level \uff1a\u8bb0\u5f55\u76ee\u524d\u8df3\u8dc3\u8868\u5185\uff0c\u5c42\u6570\u6700\u5927\u7684\u90a3\u4e2a\u8282\u70b9\u7684\u5c42\u6570\uff08\u8868\u5934\u8282\u70b9\u7684\u5c42\u6570\u4e0d\u8ba1\u7b97\u5728\u5185\uff09\u3002 length \uff1a\u8bb0\u5f55\u8df3\u8dc3\u8868\u7684\u957f\u5ea6\uff0c\u4e5f\u5373\u662f\uff0c\u8df3\u8dc3\u8868\u76ee\u524d\u5305\u542b\u8282\u70b9\u7684\u6570\u91cf\uff08\u8868\u5934\u8282\u70b9\u4e0d\u8ba1\u7b97\u5728\u5185\uff09\u3002","title":"zskiplist Struct"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/5.0-%E8%B7%B3%E8%B7%83%E8%A1%A8/#_2","text":"\u8df3\u8dc3\u8868\u662f\u6709\u5e8f\u96c6\u5408\u7684\u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00\uff0c \u9664\u6b64\u4e4b\u5916\u5b83\u5728 Redis \u4e2d\u6ca1\u6709\u5176\u4ed6\u5e94\u7528\u3002 Redis \u7684\u8df3\u8dc3\u8868\u5b9e\u73b0\u7531 zskiplist \u548c zskiplistNode \u4e24\u4e2a\u7ed3\u6784\u7ec4\u6210\uff0c \u5176\u4e2d zskiplist \u7528\u4e8e\u4fdd\u5b58\u8df3\u8dc3\u8868\u4fe1\u606f\uff08\u6bd4\u5982\u8868\u5934\u8282\u70b9\u3001\u8868\u5c3e\u8282\u70b9\u3001\u957f\u5ea6\uff09\uff0c \u800c zskiplistNode \u5219\u7528\u4e8e\u8868\u793a\u8df3\u8dc3\u8868\u8282\u70b9\u3002 \u6bcf\u4e2a\u8df3\u8dc3\u8868\u8282\u70b9\u7684\u5c42\u9ad8\u90fd\u662f 1 \u81f3 32 \u4e4b\u95f4\u7684\u968f\u673a\u6570\u3002 \u5728\u540c\u4e00\u4e2a\u8df3\u8dc3\u8868\u4e2d\uff0c \u591a\u4e2a\u8282\u70b9\u53ef\u4ee5\u5305\u542b\u76f8\u540c\u7684\u5206\u503c\uff0c \u4f46\u6bcf\u4e2a\u8282\u70b9\u7684\u6210\u5458\u5bf9\u8c61\u5fc5\u987b\u662f\u552f\u4e00\u7684\u3002 \u8df3\u8dc3\u8868\u4e2d\u7684\u8282\u70b9\u6309\u7167\u5206\u503c\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f\uff0c \u5f53\u5206\u503c\u76f8\u540c\u65f6\uff0c \u8282\u70b9\u6309\u7167\u6210\u5458\u5bf9\u8c61\u7684\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f\u3002","title":"\u603b\u7ed3"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.0-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88/","text":"6.0 \u6574\u6570\u96c6\u5408 \u6574\u6570\u96c6\u5408\uff08intset\uff09\u662f\u96c6\u5408\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00\uff1a \u5f53\u4e00\u4e2a\u96c6\u5408\u53ea\u5305\u542b\u6574\u6570\u503c\u5143\u7d20\uff0c \u5e76\u4e14\u8fd9\u4e2a\u96c6\u5408\u7684\u5143\u7d20\u6570\u91cf\u4e0d\u591a\u65f6\uff0c Redis \u5c31\u4f1a\u4f7f\u7528\u6574\u6570\u96c6\u5408\u4f5c\u4e3a\u96c6\u5408\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u3002 6.1 \u6574\u6570\u96c6\u5408\u7684\u5b9e\u73b0 typedef struct intset { // \u7f16\u7801\u65b9\u5f0f uint32_t encoding; // \u96c6\u5408\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf uint32_t length; // \u4fdd\u5b58\u5143\u7d20\u7684\u6570\u7ec4 int8_t contents[]; } intset; contents \u6570\u7ec4\u662f\u6574\u6570\u96c6\u5408\u7684\u5e95\u5c42\u5b9e\u73b0\uff1a \u6574\u6570\u96c6\u5408\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f contents \u6570\u7ec4\u7684\u4e00\u4e2a\u6570\u7ec4\u9879\uff08item\uff09\uff0c \u5404\u4e2a\u9879\u5728\u6570\u7ec4\u4e2d\u6309\u503c\u7684\u5927\u5c0f\u4ece\u5c0f\u5230\u5927\u6709\u5e8f\u5730\u6392\u5217\uff0c \u5e76\u4e14\u6570\u7ec4\u4e2d\u4e0d\u5305\u542b\u4efb\u4f55\u91cd\u590d\u9879\u3002 length \u5c5e\u6027\u8bb0\u5f55\u4e86\u6574\u6570\u96c6\u5408\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf\uff0c \u4e5f\u5373\u662f contents \u6570\u7ec4\u7684\u957f\u5ea6\u3002","title":"6.0 \u6574\u6570\u96c6\u5408"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.0-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88/#60","text":"\u6574\u6570\u96c6\u5408\uff08intset\uff09\u662f\u96c6\u5408\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00\uff1a \u5f53\u4e00\u4e2a\u96c6\u5408\u53ea\u5305\u542b\u6574\u6570\u503c\u5143\u7d20\uff0c \u5e76\u4e14\u8fd9\u4e2a\u96c6\u5408\u7684\u5143\u7d20\u6570\u91cf\u4e0d\u591a\u65f6\uff0c Redis \u5c31\u4f1a\u4f7f\u7528\u6574\u6570\u96c6\u5408\u4f5c\u4e3a\u96c6\u5408\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u3002","title":"6.0 \u6574\u6570\u96c6\u5408"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.0-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88/#61","text":"typedef struct intset { // \u7f16\u7801\u65b9\u5f0f uint32_t encoding; // \u96c6\u5408\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf uint32_t length; // \u4fdd\u5b58\u5143\u7d20\u7684\u6570\u7ec4 int8_t contents[]; } intset; contents \u6570\u7ec4\u662f\u6574\u6570\u96c6\u5408\u7684\u5e95\u5c42\u5b9e\u73b0\uff1a \u6574\u6570\u96c6\u5408\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f contents \u6570\u7ec4\u7684\u4e00\u4e2a\u6570\u7ec4\u9879\uff08item\uff09\uff0c \u5404\u4e2a\u9879\u5728\u6570\u7ec4\u4e2d\u6309\u503c\u7684\u5927\u5c0f\u4ece\u5c0f\u5230\u5927\u6709\u5e8f\u5730\u6392\u5217\uff0c \u5e76\u4e14\u6570\u7ec4\u4e2d\u4e0d\u5305\u542b\u4efb\u4f55\u91cd\u590d\u9879\u3002 length \u5c5e\u6027\u8bb0\u5f55\u4e86\u6574\u6570\u96c6\u5408\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf\uff0c \u4e5f\u5373\u662f contents \u6570\u7ec4\u7684\u957f\u5ea6\u3002","title":"6.1 \u6574\u6570\u96c6\u5408\u7684\u5b9e\u73b0"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.2-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88%E5%8D%87%E7%BA%A7/","text":"6.2 \u6574\u6570\u96c6\u5408\u5347\u7ea7 \u6bcf\u5f53\u6211\u4eec\u8981\u5c06\u4e00\u4e2a\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u6574\u6570\u96c6\u5408\u91cc\u9762\uff0c \u5e76\u4e14\u65b0\u5143\u7d20\u7684\u7c7b\u578b\u6bd4\u6574\u6570\u96c6\u5408\u73b0\u6709\u6240\u6709\u5143\u7d20\u7684\u7c7b\u578b\u90fd\u8981\u957f\u65f6\uff0c \u6574\u6570\u96c6\u5408\u9700\u8981\u5148\u8fdb\u884c\u5347\u7ea7\uff08upgrade\uff09\uff0c \u7136\u540e\u624d\u80fd\u5c06\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u6574\u6570\u96c6\u5408\u91cc\u9762\u3002 \u5347\u7ea7 \u5347\u7ea7\u6574\u6570\u96c6\u5408\u5e76\u6dfb\u52a0\u65b0\u5143\u7d20\u5171\u5206\u4e3a\u4e09\u6b65\u8fdb\u884c\uff1a \u6839\u636e\u65b0\u5143\u7d20\u7684\u7c7b\u578b\uff0c \u6269\u5c55\u6574\u6570\u96c6\u5408\u5e95\u5c42\u6570\u7ec4\u7684\u7a7a\u95f4\u5927\u5c0f\uff0c \u5e76\u4e3a\u65b0\u5143\u7d20\u5206\u914d\u7a7a\u95f4\u3002 \u5c06\u5e95\u5c42\u6570\u7ec4\u73b0\u6709\u7684\u6240\u6709\u5143\u7d20\u90fd\u8f6c\u6362\u6210\u4e0e\u65b0\u5143\u7d20\u76f8\u540c\u7684\u7c7b\u578b\uff0c \u5e76\u5c06\u7c7b\u578b\u8f6c\u6362\u540e\u7684\u5143\u7d20\u653e\u7f6e\u5230\u6b63\u786e\u7684\u4f4d\u4e0a\uff0c \u800c\u4e14\u5728\u653e\u7f6e\u5143\u7d20\u7684\u8fc7\u7a0b\u4e2d\uff0c \u9700\u8981\u7ee7\u7eed\u7ef4\u6301\u5e95\u5c42\u6570\u7ec4\u7684\u6709\u5e8f\u6027\u8d28\u4e0d\u53d8\u3002 \u5c06\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u5e95\u5c42\u6570\u7ec4\u91cc\u9762\u3002 \u5347\u7ea7\u4e4b\u540e\u65b0\u5143\u7d20\u7684\u6446\u653e\u4f4d\u7f6e \u56e0\u4e3a\u5f15\u53d1\u5347\u7ea7\u7684\u65b0\u5143\u7d20\u7684\u957f\u5ea6\u603b\u662f\u6bd4\u6574\u6570\u96c6\u5408\u73b0\u6709\u6240\u6709\u5143\u7d20\u7684\u957f\u5ea6\u90fd\u5927\uff0c \u6240\u4ee5\u8fd9\u4e2a\u65b0\u5143\u7d20\u7684\u503c\u8981\u4e48\u5c31\u5927\u4e8e\u6240\u6709\u73b0\u6709\u5143\u7d20\uff0c \u8981\u4e48\u5c31\u5c0f\u4e8e\u6240\u6709\u73b0\u6709\u5143\u7d20\uff1a \u5728\u65b0\u5143\u7d20\u5c0f\u4e8e\u6240\u6709\u73b0\u6709\u5143\u7d20\u7684\u60c5\u51b5\u4e0b\uff0c \u65b0\u5143\u7d20\u4f1a\u88ab\u653e\u7f6e\u5728\u5e95\u5c42\u6570\u7ec4\u7684\u6700\u5f00\u5934\uff08\u7d22\u5f15 0 \uff09\uff1b \u5728\u65b0\u5143\u7d20\u5927\u4e8e\u6240\u6709\u73b0\u6709\u5143\u7d20\u7684\u60c5\u51b5\u4e0b\uff0c \u65b0\u5143\u7d20\u4f1a\u88ab\u653e\u7f6e\u5728\u5e95\u5c42\u6570\u7ec4\u7684\u6700\u672b\u5c3e\uff08\u7d22\u5f15 length-1 \uff09\u3002 \u5347\u7ea7\u7684\u597d\u5904 \u63d0\u5347\u7075\u6d3b\u6027 \u8282\u7ea6\u5185\u5b58 \u63d0\u5347\u7075\u6d3b\u6027 \u56e0\u4e3a\u6574\u6570\u96c6\u5408\u53ef\u4ee5\u901a\u8fc7\u81ea\u52a8\u5347\u7ea7\u5e95\u5c42\u6570\u7ec4\u6765\u9002\u5e94\u65b0\u5143\u7d20\uff0c \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u968f\u610f\u5730\u5c06 int16_t \u3001 int32_t \u6216\u8005 int64_t \u7c7b\u578b\u7684\u6574\u6570\u6dfb\u52a0\u5230\u96c6\u5408\u4e2d\uff0c \u800c\u4e0d\u5fc5\u62c5\u5fc3\u51fa\u73b0\u7c7b\u578b\u9519\u8bef\uff0c \u8fd9\u79cd\u505a\u6cd5\u975e\u5e38\u7075\u6d3b\u3002 \u8282\u7ea6\u5185\u5b58 \u6574\u6570\u96c6\u5408\u73b0\u5728\u7684\u505a\u6cd5\u65e2\u53ef\u4ee5\u8ba9\u96c6\u5408\u80fd\u540c\u65f6\u4fdd\u5b58\u4e09\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u503c\uff0c \u53c8\u53ef\u4ee5\u786e\u4fdd\u5347\u7ea7\u64cd\u4f5c\u53ea\u4f1a\u5728\u6709\u9700\u8981\u7684\u65f6\u5019\u8fdb\u884c\uff0c \u8fd9\u53ef\u4ee5\u5c3d\u91cf\u8282\u7701\u5185\u5b58\u3002 \u964d\u7ea7 \u5bf9\u4e0d\u8d77\uff0c\uff0c\uff0c\uff0c \u6574\u6570\u96c6\u5408\u4e0d\u652f\u6301\u964d\u7ea7\u64cd\u4f5c \uff0c \u4e00\u65e6\u5bf9\u6570\u7ec4\u8fdb\u884c\u4e86\u5347\u7ea7\uff0c \u7f16\u7801\u5c31\u4f1a\u4e00\u76f4\u4fdd\u6301\u5347\u7ea7\u540e\u7684\u72b6\u6001\u3002","title":"6.2 \u6574\u6570\u96c6\u5408\u5347\u7ea7"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.2-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88%E5%8D%87%E7%BA%A7/#62","text":"\u6bcf\u5f53\u6211\u4eec\u8981\u5c06\u4e00\u4e2a\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u6574\u6570\u96c6\u5408\u91cc\u9762\uff0c \u5e76\u4e14\u65b0\u5143\u7d20\u7684\u7c7b\u578b\u6bd4\u6574\u6570\u96c6\u5408\u73b0\u6709\u6240\u6709\u5143\u7d20\u7684\u7c7b\u578b\u90fd\u8981\u957f\u65f6\uff0c \u6574\u6570\u96c6\u5408\u9700\u8981\u5148\u8fdb\u884c\u5347\u7ea7\uff08upgrade\uff09\uff0c \u7136\u540e\u624d\u80fd\u5c06\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u6574\u6570\u96c6\u5408\u91cc\u9762\u3002","title":"6.2 \u6574\u6570\u96c6\u5408\u5347\u7ea7"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.2-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88%E5%8D%87%E7%BA%A7/#_1","text":"\u5347\u7ea7\u6574\u6570\u96c6\u5408\u5e76\u6dfb\u52a0\u65b0\u5143\u7d20\u5171\u5206\u4e3a\u4e09\u6b65\u8fdb\u884c\uff1a \u6839\u636e\u65b0\u5143\u7d20\u7684\u7c7b\u578b\uff0c \u6269\u5c55\u6574\u6570\u96c6\u5408\u5e95\u5c42\u6570\u7ec4\u7684\u7a7a\u95f4\u5927\u5c0f\uff0c \u5e76\u4e3a\u65b0\u5143\u7d20\u5206\u914d\u7a7a\u95f4\u3002 \u5c06\u5e95\u5c42\u6570\u7ec4\u73b0\u6709\u7684\u6240\u6709\u5143\u7d20\u90fd\u8f6c\u6362\u6210\u4e0e\u65b0\u5143\u7d20\u76f8\u540c\u7684\u7c7b\u578b\uff0c \u5e76\u5c06\u7c7b\u578b\u8f6c\u6362\u540e\u7684\u5143\u7d20\u653e\u7f6e\u5230\u6b63\u786e\u7684\u4f4d\u4e0a\uff0c \u800c\u4e14\u5728\u653e\u7f6e\u5143\u7d20\u7684\u8fc7\u7a0b\u4e2d\uff0c \u9700\u8981\u7ee7\u7eed\u7ef4\u6301\u5e95\u5c42\u6570\u7ec4\u7684\u6709\u5e8f\u6027\u8d28\u4e0d\u53d8\u3002 \u5c06\u65b0\u5143\u7d20\u6dfb\u52a0\u5230\u5e95\u5c42\u6570\u7ec4\u91cc\u9762\u3002","title":"\u5347\u7ea7"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.2-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88%E5%8D%87%E7%BA%A7/#_2","text":"\u56e0\u4e3a\u5f15\u53d1\u5347\u7ea7\u7684\u65b0\u5143\u7d20\u7684\u957f\u5ea6\u603b\u662f\u6bd4\u6574\u6570\u96c6\u5408\u73b0\u6709\u6240\u6709\u5143\u7d20\u7684\u957f\u5ea6\u90fd\u5927\uff0c \u6240\u4ee5\u8fd9\u4e2a\u65b0\u5143\u7d20\u7684\u503c\u8981\u4e48\u5c31\u5927\u4e8e\u6240\u6709\u73b0\u6709\u5143\u7d20\uff0c \u8981\u4e48\u5c31\u5c0f\u4e8e\u6240\u6709\u73b0\u6709\u5143\u7d20\uff1a \u5728\u65b0\u5143\u7d20\u5c0f\u4e8e\u6240\u6709\u73b0\u6709\u5143\u7d20\u7684\u60c5\u51b5\u4e0b\uff0c \u65b0\u5143\u7d20\u4f1a\u88ab\u653e\u7f6e\u5728\u5e95\u5c42\u6570\u7ec4\u7684\u6700\u5f00\u5934\uff08\u7d22\u5f15 0 \uff09\uff1b \u5728\u65b0\u5143\u7d20\u5927\u4e8e\u6240\u6709\u73b0\u6709\u5143\u7d20\u7684\u60c5\u51b5\u4e0b\uff0c \u65b0\u5143\u7d20\u4f1a\u88ab\u653e\u7f6e\u5728\u5e95\u5c42\u6570\u7ec4\u7684\u6700\u672b\u5c3e\uff08\u7d22\u5f15 length-1 \uff09\u3002","title":"\u5347\u7ea7\u4e4b\u540e\u65b0\u5143\u7d20\u7684\u6446\u653e\u4f4d\u7f6e"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.2-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88%E5%8D%87%E7%BA%A7/#_3","text":"\u63d0\u5347\u7075\u6d3b\u6027 \u8282\u7ea6\u5185\u5b58","title":"\u5347\u7ea7\u7684\u597d\u5904"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.2-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88%E5%8D%87%E7%BA%A7/#_4","text":"\u56e0\u4e3a\u6574\u6570\u96c6\u5408\u53ef\u4ee5\u901a\u8fc7\u81ea\u52a8\u5347\u7ea7\u5e95\u5c42\u6570\u7ec4\u6765\u9002\u5e94\u65b0\u5143\u7d20\uff0c \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u968f\u610f\u5730\u5c06 int16_t \u3001 int32_t \u6216\u8005 int64_t \u7c7b\u578b\u7684\u6574\u6570\u6dfb\u52a0\u5230\u96c6\u5408\u4e2d\uff0c \u800c\u4e0d\u5fc5\u62c5\u5fc3\u51fa\u73b0\u7c7b\u578b\u9519\u8bef\uff0c \u8fd9\u79cd\u505a\u6cd5\u975e\u5e38\u7075\u6d3b\u3002","title":"\u63d0\u5347\u7075\u6d3b\u6027"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.2-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88%E5%8D%87%E7%BA%A7/#_5","text":"\u6574\u6570\u96c6\u5408\u73b0\u5728\u7684\u505a\u6cd5\u65e2\u53ef\u4ee5\u8ba9\u96c6\u5408\u80fd\u540c\u65f6\u4fdd\u5b58\u4e09\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u503c\uff0c \u53c8\u53ef\u4ee5\u786e\u4fdd\u5347\u7ea7\u64cd\u4f5c\u53ea\u4f1a\u5728\u6709\u9700\u8981\u7684\u65f6\u5019\u8fdb\u884c\uff0c \u8fd9\u53ef\u4ee5\u5c3d\u91cf\u8282\u7701\u5185\u5b58\u3002","title":"\u8282\u7ea6\u5185\u5b58"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.2-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88%E5%8D%87%E7%BA%A7/#_6","text":"\u5bf9\u4e0d\u8d77\uff0c\uff0c\uff0c\uff0c \u6574\u6570\u96c6\u5408\u4e0d\u652f\u6301\u964d\u7ea7\u64cd\u4f5c \uff0c \u4e00\u65e6\u5bf9\u6570\u7ec4\u8fdb\u884c\u4e86\u5347\u7ea7\uff0c \u7f16\u7801\u5c31\u4f1a\u4e00\u76f4\u4fdd\u6301\u5347\u7ea7\u540e\u7684\u72b6\u6001\u3002","title":"\u964d\u7ea7"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.3-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88API/","text":"6.3 \u6574\u6570\u96c6\u5408 API \u51fd\u6570 \u4f5c\u7528 \u65f6\u95f4\u590d\u6742\u5ea6 intsetNew \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6574\u6570\u96c6\u5408\u3002 O(1) intsetAdd \u5c06\u7ed9\u5b9a\u5143\u7d20\u6dfb\u52a0\u5230\u6574\u6570\u96c6\u5408\u91cc\u9762\u3002 O(N) intsetRemove \u4ece\u6574\u6570\u96c6\u5408\u4e2d\u79fb\u9664\u7ed9\u5b9a\u5143\u7d20\u3002 O(N) intsetFind \u68c0\u67e5\u7ed9\u5b9a\u503c\u662f\u5426\u5b58\u5728\u4e8e\u96c6\u5408\u3002 \u56e0\u4e3a\u5e95\u5c42\u6570\u7ec4\u6709\u5e8f\uff0c\u67e5\u627e\u53ef\u4ee5\u901a\u8fc7\u4e8c\u5206\u67e5\u627e\u6cd5\u6765\u8fdb\u884c\uff0c \u6240\u4ee5\u590d\u6742\u5ea6\u4e3a O(\\log N) \u3002 intsetRandom \u4ece\u6574\u6570\u96c6\u5408\u4e2d\u968f\u673a\u8fd4\u56de\u4e00\u4e2a\u5143\u7d20\u3002 O(1) intsetGet \u53d6\u51fa\u5e95\u5c42\u6570\u7ec4\u5728\u7ed9\u5b9a\u7d22\u5f15\u4e0a\u7684\u5143\u7d20\u3002 O(1) intsetLen \u8fd4\u56de\u6574\u6570\u96c6\u5408\u5305\u542b\u7684\u5143\u7d20\u4e2a\u6570\u3002 O(1) intsetBlobLen \u8fd4\u56de\u6574\u6570\u96c6\u5408\u5360\u7528\u7684\u5185\u5b58\u5b57\u8282\u6570\u3002 O(1)","title":"6.3 \u6574\u6570\u96c6\u5408 API"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/6.3-%E6%95%B4%E6%95%B0%E9%9B%86%E5%90%88API/#63-api","text":"\u51fd\u6570 \u4f5c\u7528 \u65f6\u95f4\u590d\u6742\u5ea6 intsetNew \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6574\u6570\u96c6\u5408\u3002 O(1) intsetAdd \u5c06\u7ed9\u5b9a\u5143\u7d20\u6dfb\u52a0\u5230\u6574\u6570\u96c6\u5408\u91cc\u9762\u3002 O(N) intsetRemove \u4ece\u6574\u6570\u96c6\u5408\u4e2d\u79fb\u9664\u7ed9\u5b9a\u5143\u7d20\u3002 O(N) intsetFind \u68c0\u67e5\u7ed9\u5b9a\u503c\u662f\u5426\u5b58\u5728\u4e8e\u96c6\u5408\u3002 \u56e0\u4e3a\u5e95\u5c42\u6570\u7ec4\u6709\u5e8f\uff0c\u67e5\u627e\u53ef\u4ee5\u901a\u8fc7\u4e8c\u5206\u67e5\u627e\u6cd5\u6765\u8fdb\u884c\uff0c \u6240\u4ee5\u590d\u6742\u5ea6\u4e3a O(\\log N) \u3002 intsetRandom \u4ece\u6574\u6570\u96c6\u5408\u4e2d\u968f\u673a\u8fd4\u56de\u4e00\u4e2a\u5143\u7d20\u3002 O(1) intsetGet \u53d6\u51fa\u5e95\u5c42\u6570\u7ec4\u5728\u7ed9\u5b9a\u7d22\u5f15\u4e0a\u7684\u5143\u7d20\u3002 O(1) intsetLen \u8fd4\u56de\u6574\u6570\u96c6\u5408\u5305\u542b\u7684\u5143\u7d20\u4e2a\u6570\u3002 O(1) intsetBlobLen \u8fd4\u56de\u6574\u6570\u96c6\u5408\u5360\u7528\u7684\u5185\u5b58\u5b57\u8282\u6570\u3002 O(1)","title":"6.3 \u6574\u6570\u96c6\u5408 API"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/7.0-%E5%8E%8B%E7%BC%A9%E5%88%97%E8%A1%A8/","text":"7.0 \u538b\u7f29\u5217\u8868 zipList \u538b\u7f29\u5217\u8868\u662f \u5217\u8868\u952e\u4e0e\u54c8\u5e0c\u952e \u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00\u3002 \u6784\u6210 \u5c5e\u6027 \u7c7b\u578b \u957f\u5ea6 \u7528\u9014 zlbytes uint32_t 4 \u5b57\u8282 \u8bb0\u5f55\u6574\u4e2a\u538b\u7f29\u5217\u8868\u5360\u7528\u7684\u5185\u5b58\u5b57\u8282\u6570\uff1a\u5728\u5bf9\u538b\u7f29\u5217\u8868\u8fdb\u884c\u5185\u5b58\u91cd\u5206\u914d\uff0c \u6216\u8005\u8ba1\u7b97 zlend \u7684\u4f4d\u7f6e\u65f6\u4f7f\u7528\u3002 zltail uint32_t 4 \u5b57\u8282 \u8bb0\u5f55\u538b\u7f29\u5217\u8868\u8868\u5c3e\u8282\u70b9\u8ddd\u79bb\u538b\u7f29\u5217\u8868\u7684\u8d77\u59cb\u5730\u5740\u6709\u591a\u5c11\u5b57\u8282\uff1a \u901a\u8fc7\u8fd9\u4e2a\u504f\u79fb\u91cf\uff0c\u7a0b\u5e8f\u65e0\u987b\u904d\u5386\u6574\u4e2a\u538b\u7f29\u5217\u8868\u5c31\u53ef\u4ee5\u786e\u5b9a\u8868\u5c3e\u8282\u70b9\u7684\u5730\u5740\u3002 zllen uint16_t 2 \u5b57\u8282 \u8bb0\u5f55\u4e86\u538b\u7f29\u5217\u8868\u5305\u542b\u7684\u8282\u70b9\u6570\u91cf\uff1a \u5f53\u8fd9\u4e2a\u5c5e\u6027\u7684\u503c\u5c0f\u4e8e UINT16_MAX \uff08 65535 \uff09\u65f6\uff0c \u8fd9\u4e2a\u5c5e\u6027\u7684\u503c\u5c31\u662f\u538b\u7f29\u5217\u8868\u5305\u542b\u8282\u70b9\u7684\u6570\u91cf\uff1b \u5f53\u8fd9\u4e2a\u503c\u7b49\u4e8e UINT16_MAX \u65f6\uff0c \u8282\u70b9\u7684\u771f\u5b9e\u6570\u91cf\u9700\u8981\u904d\u5386\u6574\u4e2a\u538b\u7f29\u5217\u8868\u624d\u80fd\u8ba1\u7b97\u5f97\u51fa\u3002 entryX \u5217\u8868\u8282\u70b9 \u4e0d\u5b9a \u538b\u7f29\u5217\u8868\u5305\u542b\u7684\u5404\u4e2a\u8282\u70b9\uff0c\u8282\u70b9\u7684\u957f\u5ea6\u7531\u8282\u70b9\u4fdd\u5b58\u7684\u5185\u5bb9\u51b3\u5b9a\u3002 zlend uint8_t 1 \u5b57\u8282 \u7279\u6b8a\u503c 0xFF \uff08\u5341\u8fdb\u5236 255 \uff09\uff0c\u7528\u4e8e\u6807\u8bb0\u538b\u7f29\u5217\u8868\u7684\u672b\u7aef\u3002 \u8282\u70b9\u6784\u6210 previous_entry_length previous_entry_length \u5c5e\u6027\u7684\u957f\u5ea6\u53ef\u4ee5\u662f 1 \u5b57\u8282\u6216\u8005 5 \u5b57\u8282\uff1a \u5982\u679c\u524d\u4e00\u8282\u70b9\u7684\u957f\u5ea6\u5c0f\u4e8e 254 \u5b57\u8282\uff0c \u90a3\u4e48 previous_entry_length \u5c5e\u6027\u7684\u957f\u5ea6\u4e3a 1 \u5b57\u8282\uff1a \u524d\u4e00\u8282\u70b9\u7684\u957f\u5ea6\u5c31\u4fdd\u5b58\u5728\u8fd9\u4e00\u4e2a\u5b57\u8282\u91cc\u9762\u3002 \u5982\u679c\u524d\u4e00\u8282\u70b9\u7684\u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e 254 \u5b57\u8282\uff0c \u90a3\u4e48 previous_entry_length \u5c5e\u6027\u7684\u957f\u5ea6\u4e3a 5 \u5b57\u8282\uff1a \u5176\u4e2d\u5c5e\u6027\u7684\u7b2c\u4e00\u5b57\u8282\u4f1a\u88ab\u8bbe\u7f6e\u4e3a 0xFE \uff08\u5341\u8fdb\u5236\u503c 254 \uff09\uff0c \u800c\u4e4b\u540e\u7684\u56db\u4e2a\u5b57\u8282\u5219\u7528\u4e8e\u4fdd\u5b58\u524d\u4e00\u8282\u70b9\u7684\u957f\u5ea6\u3002 0xFE ==> 254 0x05 == >5 \u538b\u7f29\u5217\u8868\u7684\u4ece\u8868\u5c3e\u5411\u8868\u5934\u904d\u5386\u64cd\u4f5c\u5c31\u662f\u4f7f\u7528\u8fd9\u4e00\u539f\u7406\u5b9e\u73b0\u7684\uff1a \u53ea\u8981\u6211\u4eec\u62e5\u6709\u4e86\u4e00\u4e2a\u6307\u5411\u67d0\u4e2a\u8282\u70b9\u8d77\u59cb\u5730\u5740\u7684\u6307\u9488\uff0c \u90a3\u4e48\u901a\u8fc7\u8fd9\u4e2a\u6307\u9488\u4ee5\u53ca\u8fd9\u4e2a\u8282\u70b9\u7684 previous_entry_length \u5c5e\u6027\uff0c \u7a0b\u5e8f\u5c31\u53ef\u4ee5\u4e00\u76f4\u5411\u524d\u4e00\u4e2a\u8282\u70b9\u56de\u6eaf\uff0c \u6700\u7ec8\u5230\u8fbe\u538b\u7f29\u5217\u8868\u7684\u8868\u5934\u8282\u70b9\u3002 encoding \u8bb0\u5f55\u4e86\u8282\u70b9\u7684 content \u5c5e\u6027\u6240\u4fdd\u5b58\u6570\u636e\u7684\u7c7b\u578b\u4ee5\u53ca\u957f\u5ea6 Content \u8282\u70b9\u7684 content \u5c5e\u6027\u8d1f\u8d23\u4fdd\u5b58\u8282\u70b9\u7684\u503c\uff0c \u8282\u70b9\u503c\u53ef\u4ee5\u662f\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\u6216\u8005\u6574\u6570\uff0c \u503c\u7684\u7c7b\u578b\u548c\u957f\u5ea6\u7531\u8282\u70b9\u7684 encoding \u5c5e\u6027\u51b3\u5b9a\u3002 \u8fde\u9501\u66f4\u65b0 \u6bcf\u4e2a\u8282\u70b9\u7684 previous_entry_length \u5c5e\u6027\u90fd\u8bb0\u5f55\u4e86\u524d\u4e00\u4e2a\u8282\u70b9\u7684\u957f\u5ea6 \u56e0\u4e3a\u8fde\u9501\u66f4\u65b0\u5728\u6700\u574f\u60c5\u51b5\u4e0b\u9700\u8981\u5bf9\u538b\u7f29\u5217\u8868\u6267\u884c N \u6b21\u7a7a\u95f4\u91cd\u5206\u914d\u64cd\u4f5c\uff0c \u800c\u6bcf\u6b21\u7a7a\u95f4\u91cd\u5206\u914d\u7684\u6700\u574f\u590d\u6742\u5ea6\u4e3a O(N) \uff0c \u6240\u4ee5\u8fde\u9501\u66f4\u65b0\u7684\u6700\u574f\u590d\u6742\u5ea6\u4e3a O(N^2) \u3002 \u5c3d\u7ba1\u8fde\u9501\u66f4\u65b0\u7684\u590d\u6742\u5ea6\u8f83\u9ad8\uff0c \u4f46\u5b83\u771f\u6b63\u9020\u6210\u6027\u80fd\u95ee\u9898\u7684\u51e0\u7387\u662f\u5f88\u4f4e\u7684\uff1a \u9996\u5148\uff0c \u538b\u7f29\u5217\u8868\u91cc\u8981\u6070\u597d\u6709\u591a\u4e2a\u8fde\u7eed\u7684\u3001\u957f\u5ea6\u4ecb\u4e8e 250 \u5b57\u8282\u81f3 253 \u5b57\u8282\u4e4b\u95f4\u7684\u8282\u70b9\uff0c \u8fde\u9501\u66f4\u65b0\u624d\u6709\u53ef\u80fd\u88ab\u5f15\u53d1\uff0c \u5728\u5b9e\u9645\u4e2d\uff0c \u8fd9\u79cd\u60c5\u51b5\u5e76\u4e0d\u591a\u89c1\uff1b \u5176\u6b21\uff0c \u5373\u4f7f\u51fa\u73b0\u8fde\u9501\u66f4\u65b0\uff0c \u4f46\u53ea\u8981\u88ab\u66f4\u65b0\u7684\u8282\u70b9\u6570\u91cf\u4e0d\u591a\uff0c \u5c31\u4e0d\u4f1a\u5bf9\u6027\u80fd\u9020\u6210\u4efb\u4f55\u5f71\u54cd\uff1a \u6bd4\u5982\u8bf4\uff0c \u5bf9\u4e09\u4e94\u4e2a\u8282\u70b9\u8fdb\u884c\u8fde\u9501\u66f4\u65b0\u662f\u7edd\u5bf9\u4e0d\u4f1a\u5f71\u54cd\u6027\u80fd\u7684\uff1b \u538b\u7f29\u5217\u8868 API \u51fd\u6570 \u4f5c\u7528 \u7b97\u6cd5\u590d\u6742\u5ea6 ziplistNew \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u538b\u7f29\u5217\u8868\u3002 O(1) ziplistPush \u521b\u5efa\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u65b0\u8282\u70b9\uff0c \u5e76\u5c06\u8fd9\u4e2a\u65b0\u8282\u70b9\u6dfb\u52a0\u5230\u538b\u7f29\u5217\u8868\u7684\u8868\u5934\u6216\u8005\u8868\u5c3e\u3002 \u5e73\u5747 O(N) \uff0c\u6700\u574f O(N^2) \u3002 ziplistInsert \u5c06\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u65b0\u8282\u70b9\u63d2\u5165\u5230\u7ed9\u5b9a\u8282\u70b9\u4e4b\u540e\u3002 \u5e73\u5747 O(N) \uff0c\u6700\u574f O(N^2) \u3002 ziplistIndex \u8fd4\u56de\u538b\u7f29\u5217\u8868\u7ed9\u5b9a\u7d22\u5f15\u4e0a\u7684\u8282\u70b9\u3002 O(N) ziplistFind \u5728\u538b\u7f29\u5217\u8868\u4e2d\u67e5\u627e\u5e76\u8fd4\u56de\u5305\u542b\u4e86\u7ed9\u5b9a\u503c\u7684\u8282\u70b9\u3002 \u56e0\u4e3a\u8282\u70b9\u7684\u503c\u53ef\u80fd\u662f\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\uff0c \u6240\u4ee5\u68c0\u67e5\u8282\u70b9\u503c\u548c\u7ed9\u5b9a\u503c\u662f\u5426\u76f8\u540c\u7684\u590d\u6742\u5ea6\u4e3a O(N) \uff0c \u800c\u67e5\u627e\u6574\u4e2a\u5217\u8868\u7684\u590d\u6742\u5ea6\u5219\u4e3a O(N^2) \u3002 ziplistNext \u8fd4\u56de\u7ed9\u5b9a\u8282\u70b9\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\u3002 O(1) ziplistPrev \u8fd4\u56de\u7ed9\u5b9a\u8282\u70b9\u7684\u524d\u4e00\u4e2a\u8282\u70b9\u3002 O(1) ziplistGet \u83b7\u53d6\u7ed9\u5b9a\u8282\u70b9\u6240\u4fdd\u5b58\u7684\u503c\u3002 O(1) ziplistDelete \u4ece\u538b\u7f29\u5217\u8868\u4e2d\u5220\u9664\u7ed9\u5b9a\u7684\u8282\u70b9\u3002 \u5e73\u5747 O(N) \uff0c\u6700\u574f O(N^2) \u3002 ziplistDeleteRange \u5220\u9664\u538b\u7f29\u5217\u8868\u5728\u7ed9\u5b9a\u7d22\u5f15\u4e0a\u7684\u8fde\u7eed\u591a\u4e2a\u8282\u70b9\u3002 \u5e73\u5747 O(N) \uff0c\u6700\u574f O(N^2) \u3002 ziplistBlobLen \u8fd4\u56de\u538b\u7f29\u5217\u8868\u76ee\u524d\u5360\u7528\u7684\u5185\u5b58\u5b57\u8282\u6570\u3002 O(1) ziplistLen \u8fd4\u56de\u538b\u7f29\u5217\u8868\u76ee\u524d\u5305\u542b\u7684\u8282\u70b9\u6570\u91cf\u3002 \u8282\u70b9\u6570\u91cf\u5c0f\u4e8e 65535 \u65f6 O(1) \uff0c \u5927\u4e8e 65535 \u65f6 O(N) \u3002 \u538b\u7f29\u5217\u8868\u662f\u4e00\u79cd\u4e3a\u8282\u7ea6\u5185\u5b58\u800c\u5f00\u53d1\u7684\u987a\u5e8f\u578b\u6570\u636e\u7ed3\u6784\u3002 \u538b\u7f29\u5217\u8868\u88ab\u7528\u4f5c\u5217\u8868\u952e\u548c\u54c8\u5e0c\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00\u3002 \u538b\u7f29\u5217\u8868\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u8282\u70b9\uff0c\u6bcf\u4e2a\u8282\u70b9\u53ef\u4ee5\u4fdd\u5b58\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\u6216\u8005\u6574\u6570\u503c\u3002 \u6dfb\u52a0\u65b0\u8282\u70b9\u5230\u538b\u7f29\u5217\u8868\uff0c \u6216\u8005\u4ece\u538b\u7f29\u5217\u8868\u4e2d\u5220\u9664\u8282\u70b9\uff0c \u53ef\u80fd\u4f1a\u5f15\u53d1\u8fde\u9501\u66f4\u65b0\u64cd\u4f5c\uff0c \u4f46\u8fd9\u79cd\u64cd\u4f5c\u51fa\u73b0\u7684\u51e0\u7387\u5e76\u4e0d\u9ad8\u3002","title":"7.0 \u538b\u7f29\u5217\u8868 zipList"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/7.0-%E5%8E%8B%E7%BC%A9%E5%88%97%E8%A1%A8/#70-ziplist","text":"\u538b\u7f29\u5217\u8868\u662f \u5217\u8868\u952e\u4e0e\u54c8\u5e0c\u952e \u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00\u3002","title":"7.0 \u538b\u7f29\u5217\u8868 zipList"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/7.0-%E5%8E%8B%E7%BC%A9%E5%88%97%E8%A1%A8/#_1","text":"\u5c5e\u6027 \u7c7b\u578b \u957f\u5ea6 \u7528\u9014 zlbytes uint32_t 4 \u5b57\u8282 \u8bb0\u5f55\u6574\u4e2a\u538b\u7f29\u5217\u8868\u5360\u7528\u7684\u5185\u5b58\u5b57\u8282\u6570\uff1a\u5728\u5bf9\u538b\u7f29\u5217\u8868\u8fdb\u884c\u5185\u5b58\u91cd\u5206\u914d\uff0c \u6216\u8005\u8ba1\u7b97 zlend \u7684\u4f4d\u7f6e\u65f6\u4f7f\u7528\u3002 zltail uint32_t 4 \u5b57\u8282 \u8bb0\u5f55\u538b\u7f29\u5217\u8868\u8868\u5c3e\u8282\u70b9\u8ddd\u79bb\u538b\u7f29\u5217\u8868\u7684\u8d77\u59cb\u5730\u5740\u6709\u591a\u5c11\u5b57\u8282\uff1a \u901a\u8fc7\u8fd9\u4e2a\u504f\u79fb\u91cf\uff0c\u7a0b\u5e8f\u65e0\u987b\u904d\u5386\u6574\u4e2a\u538b\u7f29\u5217\u8868\u5c31\u53ef\u4ee5\u786e\u5b9a\u8868\u5c3e\u8282\u70b9\u7684\u5730\u5740\u3002 zllen uint16_t 2 \u5b57\u8282 \u8bb0\u5f55\u4e86\u538b\u7f29\u5217\u8868\u5305\u542b\u7684\u8282\u70b9\u6570\u91cf\uff1a \u5f53\u8fd9\u4e2a\u5c5e\u6027\u7684\u503c\u5c0f\u4e8e UINT16_MAX \uff08 65535 \uff09\u65f6\uff0c \u8fd9\u4e2a\u5c5e\u6027\u7684\u503c\u5c31\u662f\u538b\u7f29\u5217\u8868\u5305\u542b\u8282\u70b9\u7684\u6570\u91cf\uff1b \u5f53\u8fd9\u4e2a\u503c\u7b49\u4e8e UINT16_MAX \u65f6\uff0c \u8282\u70b9\u7684\u771f\u5b9e\u6570\u91cf\u9700\u8981\u904d\u5386\u6574\u4e2a\u538b\u7f29\u5217\u8868\u624d\u80fd\u8ba1\u7b97\u5f97\u51fa\u3002 entryX \u5217\u8868\u8282\u70b9 \u4e0d\u5b9a \u538b\u7f29\u5217\u8868\u5305\u542b\u7684\u5404\u4e2a\u8282\u70b9\uff0c\u8282\u70b9\u7684\u957f\u5ea6\u7531\u8282\u70b9\u4fdd\u5b58\u7684\u5185\u5bb9\u51b3\u5b9a\u3002 zlend uint8_t 1 \u5b57\u8282 \u7279\u6b8a\u503c 0xFF \uff08\u5341\u8fdb\u5236 255 \uff09\uff0c\u7528\u4e8e\u6807\u8bb0\u538b\u7f29\u5217\u8868\u7684\u672b\u7aef\u3002","title":"\u6784\u6210"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/7.0-%E5%8E%8B%E7%BC%A9%E5%88%97%E8%A1%A8/#_2","text":"","title":"\u8282\u70b9\u6784\u6210"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/7.0-%E5%8E%8B%E7%BC%A9%E5%88%97%E8%A1%A8/#previous_entry_length","text":"previous_entry_length \u5c5e\u6027\u7684\u957f\u5ea6\u53ef\u4ee5\u662f 1 \u5b57\u8282\u6216\u8005 5 \u5b57\u8282\uff1a \u5982\u679c\u524d\u4e00\u8282\u70b9\u7684\u957f\u5ea6\u5c0f\u4e8e 254 \u5b57\u8282\uff0c \u90a3\u4e48 previous_entry_length \u5c5e\u6027\u7684\u957f\u5ea6\u4e3a 1 \u5b57\u8282\uff1a \u524d\u4e00\u8282\u70b9\u7684\u957f\u5ea6\u5c31\u4fdd\u5b58\u5728\u8fd9\u4e00\u4e2a\u5b57\u8282\u91cc\u9762\u3002 \u5982\u679c\u524d\u4e00\u8282\u70b9\u7684\u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e 254 \u5b57\u8282\uff0c \u90a3\u4e48 previous_entry_length \u5c5e\u6027\u7684\u957f\u5ea6\u4e3a 5 \u5b57\u8282\uff1a \u5176\u4e2d\u5c5e\u6027\u7684\u7b2c\u4e00\u5b57\u8282\u4f1a\u88ab\u8bbe\u7f6e\u4e3a 0xFE \uff08\u5341\u8fdb\u5236\u503c 254 \uff09\uff0c \u800c\u4e4b\u540e\u7684\u56db\u4e2a\u5b57\u8282\u5219\u7528\u4e8e\u4fdd\u5b58\u524d\u4e00\u8282\u70b9\u7684\u957f\u5ea6\u3002 0xFE ==> 254 0x05 == >5 \u538b\u7f29\u5217\u8868\u7684\u4ece\u8868\u5c3e\u5411\u8868\u5934\u904d\u5386\u64cd\u4f5c\u5c31\u662f\u4f7f\u7528\u8fd9\u4e00\u539f\u7406\u5b9e\u73b0\u7684\uff1a \u53ea\u8981\u6211\u4eec\u62e5\u6709\u4e86\u4e00\u4e2a\u6307\u5411\u67d0\u4e2a\u8282\u70b9\u8d77\u59cb\u5730\u5740\u7684\u6307\u9488\uff0c \u90a3\u4e48\u901a\u8fc7\u8fd9\u4e2a\u6307\u9488\u4ee5\u53ca\u8fd9\u4e2a\u8282\u70b9\u7684 previous_entry_length \u5c5e\u6027\uff0c \u7a0b\u5e8f\u5c31\u53ef\u4ee5\u4e00\u76f4\u5411\u524d\u4e00\u4e2a\u8282\u70b9\u56de\u6eaf\uff0c \u6700\u7ec8\u5230\u8fbe\u538b\u7f29\u5217\u8868\u7684\u8868\u5934\u8282\u70b9\u3002","title":"previous_entry_length"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/7.0-%E5%8E%8B%E7%BC%A9%E5%88%97%E8%A1%A8/#encoding","text":"\u8bb0\u5f55\u4e86\u8282\u70b9\u7684 content \u5c5e\u6027\u6240\u4fdd\u5b58\u6570\u636e\u7684\u7c7b\u578b\u4ee5\u53ca\u957f\u5ea6","title":"encoding"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/7.0-%E5%8E%8B%E7%BC%A9%E5%88%97%E8%A1%A8/#content","text":"\u8282\u70b9\u7684 content \u5c5e\u6027\u8d1f\u8d23\u4fdd\u5b58\u8282\u70b9\u7684\u503c\uff0c \u8282\u70b9\u503c\u53ef\u4ee5\u662f\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\u6216\u8005\u6574\u6570\uff0c \u503c\u7684\u7c7b\u578b\u548c\u957f\u5ea6\u7531\u8282\u70b9\u7684 encoding \u5c5e\u6027\u51b3\u5b9a\u3002","title":"Content"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/7.0-%E5%8E%8B%E7%BC%A9%E5%88%97%E8%A1%A8/#_3","text":"\u6bcf\u4e2a\u8282\u70b9\u7684 previous_entry_length \u5c5e\u6027\u90fd\u8bb0\u5f55\u4e86\u524d\u4e00\u4e2a\u8282\u70b9\u7684\u957f\u5ea6 \u56e0\u4e3a\u8fde\u9501\u66f4\u65b0\u5728\u6700\u574f\u60c5\u51b5\u4e0b\u9700\u8981\u5bf9\u538b\u7f29\u5217\u8868\u6267\u884c N \u6b21\u7a7a\u95f4\u91cd\u5206\u914d\u64cd\u4f5c\uff0c \u800c\u6bcf\u6b21\u7a7a\u95f4\u91cd\u5206\u914d\u7684\u6700\u574f\u590d\u6742\u5ea6\u4e3a O(N) \uff0c \u6240\u4ee5\u8fde\u9501\u66f4\u65b0\u7684\u6700\u574f\u590d\u6742\u5ea6\u4e3a O(N^2) \u3002 \u5c3d\u7ba1\u8fde\u9501\u66f4\u65b0\u7684\u590d\u6742\u5ea6\u8f83\u9ad8\uff0c \u4f46\u5b83\u771f\u6b63\u9020\u6210\u6027\u80fd\u95ee\u9898\u7684\u51e0\u7387\u662f\u5f88\u4f4e\u7684\uff1a \u9996\u5148\uff0c \u538b\u7f29\u5217\u8868\u91cc\u8981\u6070\u597d\u6709\u591a\u4e2a\u8fde\u7eed\u7684\u3001\u957f\u5ea6\u4ecb\u4e8e 250 \u5b57\u8282\u81f3 253 \u5b57\u8282\u4e4b\u95f4\u7684\u8282\u70b9\uff0c \u8fde\u9501\u66f4\u65b0\u624d\u6709\u53ef\u80fd\u88ab\u5f15\u53d1\uff0c \u5728\u5b9e\u9645\u4e2d\uff0c \u8fd9\u79cd\u60c5\u51b5\u5e76\u4e0d\u591a\u89c1\uff1b \u5176\u6b21\uff0c \u5373\u4f7f\u51fa\u73b0\u8fde\u9501\u66f4\u65b0\uff0c \u4f46\u53ea\u8981\u88ab\u66f4\u65b0\u7684\u8282\u70b9\u6570\u91cf\u4e0d\u591a\uff0c \u5c31\u4e0d\u4f1a\u5bf9\u6027\u80fd\u9020\u6210\u4efb\u4f55\u5f71\u54cd\uff1a \u6bd4\u5982\u8bf4\uff0c \u5bf9\u4e09\u4e94\u4e2a\u8282\u70b9\u8fdb\u884c\u8fde\u9501\u66f4\u65b0\u662f\u7edd\u5bf9\u4e0d\u4f1a\u5f71\u54cd\u6027\u80fd\u7684\uff1b","title":"\u8fde\u9501\u66f4\u65b0"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/7.0-%E5%8E%8B%E7%BC%A9%E5%88%97%E8%A1%A8/#api","text":"\u51fd\u6570 \u4f5c\u7528 \u7b97\u6cd5\u590d\u6742\u5ea6 ziplistNew \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u538b\u7f29\u5217\u8868\u3002 O(1) ziplistPush \u521b\u5efa\u4e00\u4e2a\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u65b0\u8282\u70b9\uff0c \u5e76\u5c06\u8fd9\u4e2a\u65b0\u8282\u70b9\u6dfb\u52a0\u5230\u538b\u7f29\u5217\u8868\u7684\u8868\u5934\u6216\u8005\u8868\u5c3e\u3002 \u5e73\u5747 O(N) \uff0c\u6700\u574f O(N^2) \u3002 ziplistInsert \u5c06\u5305\u542b\u7ed9\u5b9a\u503c\u7684\u65b0\u8282\u70b9\u63d2\u5165\u5230\u7ed9\u5b9a\u8282\u70b9\u4e4b\u540e\u3002 \u5e73\u5747 O(N) \uff0c\u6700\u574f O(N^2) \u3002 ziplistIndex \u8fd4\u56de\u538b\u7f29\u5217\u8868\u7ed9\u5b9a\u7d22\u5f15\u4e0a\u7684\u8282\u70b9\u3002 O(N) ziplistFind \u5728\u538b\u7f29\u5217\u8868\u4e2d\u67e5\u627e\u5e76\u8fd4\u56de\u5305\u542b\u4e86\u7ed9\u5b9a\u503c\u7684\u8282\u70b9\u3002 \u56e0\u4e3a\u8282\u70b9\u7684\u503c\u53ef\u80fd\u662f\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\uff0c \u6240\u4ee5\u68c0\u67e5\u8282\u70b9\u503c\u548c\u7ed9\u5b9a\u503c\u662f\u5426\u76f8\u540c\u7684\u590d\u6742\u5ea6\u4e3a O(N) \uff0c \u800c\u67e5\u627e\u6574\u4e2a\u5217\u8868\u7684\u590d\u6742\u5ea6\u5219\u4e3a O(N^2) \u3002 ziplistNext \u8fd4\u56de\u7ed9\u5b9a\u8282\u70b9\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\u3002 O(1) ziplistPrev \u8fd4\u56de\u7ed9\u5b9a\u8282\u70b9\u7684\u524d\u4e00\u4e2a\u8282\u70b9\u3002 O(1) ziplistGet \u83b7\u53d6\u7ed9\u5b9a\u8282\u70b9\u6240\u4fdd\u5b58\u7684\u503c\u3002 O(1) ziplistDelete \u4ece\u538b\u7f29\u5217\u8868\u4e2d\u5220\u9664\u7ed9\u5b9a\u7684\u8282\u70b9\u3002 \u5e73\u5747 O(N) \uff0c\u6700\u574f O(N^2) \u3002 ziplistDeleteRange \u5220\u9664\u538b\u7f29\u5217\u8868\u5728\u7ed9\u5b9a\u7d22\u5f15\u4e0a\u7684\u8fde\u7eed\u591a\u4e2a\u8282\u70b9\u3002 \u5e73\u5747 O(N) \uff0c\u6700\u574f O(N^2) \u3002 ziplistBlobLen \u8fd4\u56de\u538b\u7f29\u5217\u8868\u76ee\u524d\u5360\u7528\u7684\u5185\u5b58\u5b57\u8282\u6570\u3002 O(1) ziplistLen \u8fd4\u56de\u538b\u7f29\u5217\u8868\u76ee\u524d\u5305\u542b\u7684\u8282\u70b9\u6570\u91cf\u3002 \u8282\u70b9\u6570\u91cf\u5c0f\u4e8e 65535 \u65f6 O(1) \uff0c \u5927\u4e8e 65535 \u65f6 O(N) \u3002 \u538b\u7f29\u5217\u8868\u662f\u4e00\u79cd\u4e3a\u8282\u7ea6\u5185\u5b58\u800c\u5f00\u53d1\u7684\u987a\u5e8f\u578b\u6570\u636e\u7ed3\u6784\u3002 \u538b\u7f29\u5217\u8868\u88ab\u7528\u4f5c\u5217\u8868\u952e\u548c\u54c8\u5e0c\u952e\u7684\u5e95\u5c42\u5b9e\u73b0\u4e4b\u4e00\u3002 \u538b\u7f29\u5217\u8868\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u8282\u70b9\uff0c\u6bcf\u4e2a\u8282\u70b9\u53ef\u4ee5\u4fdd\u5b58\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\u6216\u8005\u6574\u6570\u503c\u3002 \u6dfb\u52a0\u65b0\u8282\u70b9\u5230\u538b\u7f29\u5217\u8868\uff0c \u6216\u8005\u4ece\u538b\u7f29\u5217\u8868\u4e2d\u5220\u9664\u8282\u70b9\uff0c \u53ef\u80fd\u4f1a\u5f15\u53d1\u8fde\u9501\u66f4\u65b0\u64cd\u4f5c\uff0c \u4f46\u8fd9\u79cd\u64cd\u4f5c\u51fa\u73b0\u7684\u51e0\u7387\u5e76\u4e0d\u9ad8\u3002","title":"\u538b\u7f29\u5217\u8868 API"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/8.0-%E5%AF%B9%E8%B1%A1/","text":"\u5bf9\u8c61 RedisObject typedef struct redisObject { // \u7c7b\u578b unsigned type:4; // \u7f16\u7801 unsigned encoding:4; // \u6307\u5411\u5e95\u5c42\u5b9e\u73b0\u6570\u636e\u7ed3\u6784\u7684\u6307\u9488 void *ptr; // ... } robj; Type \u7c7b\u578b\u5e38\u91cf \u5bf9\u8c61\u7684\u540d\u79f0 REDIS_STRING \u5b57\u7b26\u4e32\u5bf9\u8c61 REDIS_LIST \u5217\u8868\u5bf9\u8c61 REDIS_HASH \u54c8\u5e0c\u5bf9\u8c61 REDIS_SET \u96c6\u5408\u5bf9\u8c61 REDIS_ZSET \u6709\u5e8f\u96c6\u5408\u5bf9\u8c61 \u4e0d\u540c\u7c7b\u578b\u503c\u5bf9\u8c61\u7684 TYPE \u547d\u4ee4\u8f93\u51fa \u5bf9\u8c61 \u5bf9\u8c61 type \u5c5e\u6027\u7684\u503c TYPE \u547d\u4ee4\u7684\u8f93\u51fa \u5b57\u7b26\u4e32\u5bf9\u8c61 REDIS_STRING \"string\" \u5217\u8868\u5bf9\u8c61 REDIS_LIST \"list\" \u54c8\u5e0c\u5bf9\u8c61 REDIS_HASH \"hash\" \u96c6\u5408\u5bf9\u8c61 REDIS_SET \"set\" \u6709\u5e8f\u96c6\u5408\u5bf9\u8c61 REDIS_ZSET \"zset\"","title":"\u5bf9\u8c61"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/8.0-%E5%AF%B9%E8%B1%A1/#_1","text":"","title":"\u5bf9\u8c61"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/8.0-%E5%AF%B9%E8%B1%A1/#redisobject","text":"typedef struct redisObject { // \u7c7b\u578b unsigned type:4; // \u7f16\u7801 unsigned encoding:4; // \u6307\u5411\u5e95\u5c42\u5b9e\u73b0\u6570\u636e\u7ed3\u6784\u7684\u6307\u9488 void *ptr; // ... } robj;","title":"RedisObject"},{"location":"Redis%20%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/8.0-%E5%AF%B9%E8%B1%A1/#type","text":"\u7c7b\u578b\u5e38\u91cf \u5bf9\u8c61\u7684\u540d\u79f0 REDIS_STRING \u5b57\u7b26\u4e32\u5bf9\u8c61 REDIS_LIST \u5217\u8868\u5bf9\u8c61 REDIS_HASH \u54c8\u5e0c\u5bf9\u8c61 REDIS_SET \u96c6\u5408\u5bf9\u8c61 REDIS_ZSET \u6709\u5e8f\u96c6\u5408\u5bf9\u8c61 \u4e0d\u540c\u7c7b\u578b\u503c\u5bf9\u8c61\u7684 TYPE \u547d\u4ee4\u8f93\u51fa \u5bf9\u8c61 \u5bf9\u8c61 type \u5c5e\u6027\u7684\u503c TYPE \u547d\u4ee4\u7684\u8f93\u51fa \u5b57\u7b26\u4e32\u5bf9\u8c61 REDIS_STRING \"string\" \u5217\u8868\u5bf9\u8c61 REDIS_LIST \"list\" \u54c8\u5e0c\u5bf9\u8c61 REDIS_HASH \"hash\" \u96c6\u5408\u5bf9\u8c61 REDIS_SET \"set\" \u6709\u5e8f\u96c6\u5408\u5bf9\u8c61 REDIS_ZSET \"zset\"","title":"Type"},{"location":"Tools/vim-ide/","text":"Vim Go IDE \u901a\u8fc7\u914d\u7f6e\uff0c\u4f7f\u5f97 vim \u53ef\u4ee5\u770b\u8d77\u6765\u50cf ide \u4e00\u6837\u6765\u5f00\u53d1 Go \u3002 \u8bf4\u5b9e\u5728\u7684\uff0c\u5982\u679c\u559c\u597d\u6298\u817e\uff0c\u559c\u597d\u81ea\u5df1\u6765\u914d\u7f6e\u73af\u5883\uff0c\u53ef\u4ee5\u914d\u7f6e\u4e00\u4e0b\uff0c\u5982\u679c\u4e0d\u662f\u5f88\u719f\u7ec3 vi/vim \uff0c\u8fd8\u662f\u8e0f\u8e0f\u5b9e\u5b9e\u4f7f\u7528 IDE \u5427\uff0c\u6bd4\u5982 VSCode\uff08\u6211\u4e5f\u4f1a\u7528\uff09 \u3001 GoLand \u8fd8\u90fd\u662f\u4e0d\u9519\u7684\uff0c\u4e0d\u8fc7\u4f60\u8981\u662f\u770b\u5230\u4e86\u6211\u7684\u8fd9\u7bc7\u6587\u6863\uff0c\u5c31\u8bc1\u660e\u8fd8\u662f\u60f3\u8981\u6298\u817e\u4e00\u4e0b\uff0c\u4e0b\u9762\u5c31\u662f\u6211\u6298\u817e\u540e\u7684\u7ed3\u679c\u3002 \u672c\u914d\u7f6e\u662f\u5728 Ubuntu 18.04 \u4e0b\u5b8c\u6210\u7684\uff0c vim \u7248\u672c\u662f VIM - Vi IMproved 8.0 \uff0c\u5f00\u542f lantern \uff08\u4e0d\u8003\u8651\u7f51\u7edc\u4e0d\u901a\u7545\u7684\u60c5\u51b5\uff09 \u914d\u7f6e Go \u73af\u5883 \u5b89\u88c5 Go \u914d\u7f6e PATH \u53ca GOPATH Vim \u57fa\u672c\u914d\u7f6e \u63d2\u4ef6\u7ba1\u7406 \u5b89\u88c5\u63d2\u4ef6 \u914d\u7f6e\u63d2\u4ef6 \u63d2\u4ef6\u5220\u9664 \u63d2\u4ef6\u914d\u7f6e vim-go YouCompleteMe \u5176\u4ed6\u63d2\u4ef6 \u914d\u7f6e Go \u73af\u5883 \u65e2\u7136\u662f Go \u7684\u5f00\u53d1\u73af\u5883\uff0c\u7b2c\u4e00\u6b65\u5f53\u524d\u5c31\u662f\u51c6\u5907\u597d \u3002 \u5b89\u88c5 Go \u5230 golang.org \u5c06\u5b89\u88c5\u5305\u4e0b\u8f7d\uff0c\u5e76\u914d\u7f6e\u597d\u73af\u5883\uff0c \u63a8\u8350\u4f7f\u7528\u4e8c\u8fdb\u5236\u7248\u672c\uff0c\u4e0b\u8f7d\u5b8c\u6210\u540e\u76f4\u63a5\u89e3\u538b\u7f29\u5c31\u53ef\u4ee5\u4f7f\u7528\u3002\u5982\u679c\u65e0\u6cd5\u8bbf\u95ee go \u5b98\u7f51\uff0c\u53ef\u4ee5\u8003\u8651\u53bb golang.google.cn \u53bb\u4e0b\u8f7d\u3002 wget https://dl.google.com/go/go1.12.linux-amd64.tar.gz sudo tar xzvf go1.12.linux-amd64.tar.gz -C /usr/local/ \u914d\u7f6e PATH \u53ca GOPATH \u521b\u5efa Go \u7684\u5de5\u4f5c\u7a7a\u95f4\uff08\u76ee\u5f55\uff09 # \u8fd9\u662f\u9ed8\u8ba4\u7684\u4f4d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u6309\u7167\u9700\u6c42\u6307\u5b9a\u5230\u5176\u4ed6\u76ee\u5f55 mkdir -p $HOME/go/{bin,pkg,src} \u914d\u7f6e\u73af\u5883\u53d8\u91cf \u7528\u6237 vim \u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u6587 vim /etc/profile.d/go.sh \uff0c\u5199\u5165\u4e0b\u9762\u5185\u5bb9 export GOPATH=$HOME/go export GOROOT=/usr/local/go export PATH=$PATH:$GOROOT/bin:$GOPATH/bin Vim \u57fa\u672c\u914d\u7f6e \u6253\u5f00 vimrc \u6587\u4ef6 vim ~/.vimrc \uff0c\u5199\u5165\u4e0b\u9762\u914d\u7f6e \"============================================================================== \" vim \u5185\u7f6e\u914d\u7f6e \"============================================================================== \" \u8bbe\u7f6e vimrc \u4fee\u6539\u4fdd\u5b58\u540e\u7acb\u523b\u751f\u6548\uff0c\u4e0d\u7528\u5728\u91cd\u65b0\u6253\u5f00 \" \u5efa\u8bae\u914d\u7f6e\u5b8c\u6210\u540e\u5c06\u8fd9\u4e2a\u5173\u95ed autocmd BufWritePost $MYVIMRC source $MYVIMRC \" \u5173\u95ed\u517c\u5bb9\u6a21\u5f0f set nocompatible set nu \" \u8bbe\u7f6e\u884c\u53f7 set cursorline \"\u7a81\u51fa\u663e\u793a\u5f53\u524d\u884c \" set cursorcolumn \" \u7a81\u51fa\u663e\u793a\u5f53\u524d\u5217 set showmatch \" \u663e\u793a\u62ec\u53f7\u5339\u914d \" tab \u7f29\u8fdb set tabstop=4 \" \u8bbe\u7f6eTab\u957f\u5ea6\u4e3a4\u7a7a\u683c set shiftwidth=4 \" \u8bbe\u7f6e\u81ea\u52a8\u7f29\u8fdb\u957f\u5ea6\u4e3a4\u7a7a\u683c set autoindent \" \u7ee7\u627f\u524d\u4e00\u884c\u7684\u7f29\u8fdb\u65b9\u5f0f\uff0c\u9002\u7528\u4e8e\u591a\u884c\u6ce8\u91ca \" \u5b9a\u4e49\u5feb\u6377\u952e\u7684\u524d\u7f00\uff0c\u5373<Leader> let mapleader=\";\" \" ==== \u7cfb\u7edf\u526a\u5207\u677f\u590d\u5236\u7c98\u8d34 ==== \" v \u6a21\u5f0f\u4e0b\u590d\u5236\u5185\u5bb9\u5230\u7cfb\u7edf\u526a\u5207\u677f vmap <Leader>c \"+yy \" n \u6a21\u5f0f\u4e0b\u590d\u5236\u4e00\u884c\u5230\u7cfb\u7edf\u526a\u5207\u677f nmap <Leader>c \"+yy \" n \u6a21\u5f0f\u4e0b\u7c98\u8d34\u7cfb\u7edf\u526a\u5207\u677f\u7684\u5185\u5bb9 nmap <Leader>v \"+p \" \u5f00\u542f\u5b9e\u65f6\u641c\u7d22 set incsearch \" \u641c\u7d22\u65f6\u5927\u5c0f\u5199\u4e0d\u654f\u611f set ignorecase syntax enable syntax on \" \u5f00\u542f\u6587\u4ef6\u7c7b\u578b\u4fa6\u6d4b filetype plugin indent on \" \u542f\u7528\u81ea\u52a8\u8865\u5168 \" \u9000\u51fa\u63d2\u5165\u6a21\u5f0f\u6307\u5b9a\u7c7b\u578b\u7684\u6587\u4ef6\u81ea\u52a8\u4fdd\u5b58 au InsertLeave *.go,*.sh,*.php write \u63d2\u4ef6\u7ba1\u7406 \u63d2\u4ef6\u7684\u7528\u9014\u5c31\u662f\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u7ba1\u7406 vim \u7684\u5404\u79cd\u63d2\u4ef6\uff0c\u5feb\u901f\u5b89\u88c5\u914d\u7f6e\u4ee5\u53ca\u6e05\u9664\uff0c\u7f51\u4e0a\u73b0\u5728\u7684\u5e16\u5b50\u591a\u6570\u90fd\u662f\u4f7f\u7528\u7684 Vundle \u8fd9\u4e2a\u63d2\u4ef6\uff0c\u4e0d\u8fc7\u4e2a\u4eba\u89c9\u5f97\u8fd9\u4e2a\u7ba1\u7406\u5de5\u5177\u5728\u63d2\u4ef6\u5b89\u88c5\u591a\u4e86\u7684\u65f6\u5019\u4e0d\u662f\u5f88\u6d41\u7545\uff0c\u66f4\u559c\u597d\u4f7f\u7528 vim-plug \u8fd9\u4e2a\u63d2\u4ef6\uff0c\u4e24\u4e2a\u63d2\u4ef6\u90fd\u662f\u5f88\u6e05\u9664\u7684\u5b89\u88c5\u6587\u6863\uff0c\u8fd9\u91cc\u662f\u4ecb\u7ecd vim-plug \u3002 \u5b89\u88c5\u63d2\u4ef6 \u5728 Linux \u4e0b\u975e\u5e38\u7b80\u5355\uff0c\u76f4\u63a5\u901a\u8fc7 curl \u4e0b\u8f7d\u5373\u53ef\uff08\u4e5f\u53ef\u4ee5\u624b\u52a8\u4e0b\u8f7d\uff0c\u89c1\u5b98\u65b9\u6587\u6863\uff09 curl -fLo ~/.vim/autoload/plug.vim --create-dirs \\ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim \u914d\u7f6e\u63d2\u4ef6 \u63d2\u4ef6\u7684\u914d\u7f6e\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u8981\u5c06\u6240\u6709\u7684\u63d2\u4ef6\u914d\u7f6e\u5728 call plug#begin('~/.vim/plugged') \u548c call plug#end() \u4e4b\u95f4\u5373\u53ef\uff0c\u5e38\u89c1\u7684\u63d2\u4ef6\u57fa\u672c\u4e0a\u90fd\u53ef\u4ee5\u4ece github \u4e2d\u627e\u5230\uff0c\u5982\u679c github \u627e\u4e0d\u5230\u7684\u8bdd\u57fa\u672c\u4e0a vim.org \u7684\u811a\u672c\u90fd\u53ef\u4ee5\u5728 vim-script \u4e2d\u627e\u5230\u5907\u4efd \u5728\u521a\u521a\u7684 ~/.vimrc \u4e0b\u9762\u7ee7\u7eed\u6dfb\u52a0\u63d2\u4ef6\u76f8\u5173\u7684\u914d\u7f6e \" \u63d2\u4ef6\u5f00\u59cb\u7684\u4f4d\u7f6e call plug#begin('~/.vim/plugged') \" Shorthand notation; fetches https://github.com/junegunn/vim-easy-align \" \u53ef\u4ee5\u5feb\u901f\u5bf9\u9f50\u7684\u63d2\u4ef6 Plug 'junegunn/vim-easy-align' \" \u7528\u6765\u63d0\u4f9b\u4e00\u4e2a\u5bfc\u822a\u76ee\u5f55\u7684\u4fa7\u8fb9\u680f Plug 'scrooloose/nerdtree' \" \u53ef\u4ee5\u4f7f nerdtree \u7684 tab \u66f4\u52a0\u53cb\u597d\u4e9b Plug 'jistr/vim-nerdtree-tabs' \" \u53ef\u4ee5\u5728\u5bfc\u822a\u76ee\u5f55\u4e2d\u770b\u5230 git \u7248\u672c\u4fe1\u606f Plug 'Xuyuanp/nerdtree-git-plugin' \" \u67e5\u770b\u5f53\u524d\u4ee3\u7801\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u548c\u51fd\u6570\u5217\u8868\u7684\u63d2\u4ef6\uff0c \" \u53ef\u4ee5\u5207\u6362\u548c\u8df3\u8f6c\u5230\u4ee3\u7801\u4e2d\u5bf9\u5e94\u7684\u53d8\u91cf\u548c\u51fd\u6570\u7684\u4f4d\u7f6e \" \u5927\u7eb2\u5f0f\u5bfc\u822a, Go \u9700\u8981 https://github.com/jstemmer/gotags \u652f\u6301 Plug 'majutsushi/tagbar' \" \u81ea\u52a8\u8865\u5168\u62ec\u53f7\u7684\u63d2\u4ef6\uff0c\u5305\u62ec\u5c0f\u62ec\u53f7\uff0c\u4e2d\u62ec\u53f7\uff0c\u4ee5\u53ca\u82b1\u62ec\u53f7 Plug 'jiangmiao/auto-pairs' \" Vim\u72b6\u6001\u680f\u63d2\u4ef6\uff0c\u5305\u62ec\u663e\u793a\u884c\u53f7\uff0c\u5217\u53f7\uff0c\u6587\u4ef6\u7c7b\u578b\uff0c\u6587\u4ef6\u540d\uff0c\u4ee5\u53caGit\u72b6\u6001 Plug 'vim-airline/vim-airline' \" \u6709\u9053\u8bcd\u5178\u5728\u7ebf\u7ffb\u8bd1 Plug 'ianva/vim-youdao-translater' \" \u4ee3\u7801\u81ea\u52a8\u5b8c\u6210\uff0c\u5b89\u88c5\u5b8c\u63d2\u4ef6\u8fd8\u9700\u8981\u989d\u5916\u914d\u7f6e\u624d\u53ef\u4ee5\u4f7f\u7528 Plug 'Valloric/YouCompleteMe' \" \u53ef\u4ee5\u5728\u6587\u6863\u4e2d\u663e\u793a git \u4fe1\u606f Plug 'airblade/vim-gitgutter' \" \u4e0b\u9762\u4e24\u4e2a\u63d2\u4ef6\u8981\u914d\u5408\u4f7f\u7528\uff0c\u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u4ee3\u7801\u5757 Plug 'SirVer/ultisnips' Plug 'honza/vim-snippets' \" \u53ef\u4ee5\u5728 vim \u4e2d\u4f7f\u7528 tab \u8865\u5168 \"Plug 'vim-scripts/SuperTab' \" \u53ef\u4ee5\u5728 vim \u4e2d\u81ea\u52a8\u5b8c\u6210 \"Plug 'Shougo/neocomplete.vim' \" \u914d\u8272\u65b9\u6848 \" colorscheme neodark Plug 'KeitaNakamura/neodark.vim' \" colorscheme monokai Plug 'crusoexia/vim-monokai' \" colorscheme github Plug 'acarapetis/vim-colors-github' \" colorscheme one Plug 'rakr/vim-one' \" go \u4e3b\u8981\u63d2\u4ef6 Plug 'fatih/vim-go', { 'tag': '*' } \" go \u4e2d\u7684\u4ee3\u7801\u8ffd\u8e2a\uff0c\u8f93\u5165 gd \u5c31\u53ef\u4ee5\u81ea\u52a8\u8df3\u8f6c Plug 'dgryski/vim-godef' \" markdown \u63d2\u4ef6 Plug 'iamcco/mathjax-support-for-mkdp' Plug 'iamcco/markdown-preview.vim' \" \u63d2\u4ef6\u7ed3\u675f\u7684\u4f4d\u7f6e\uff0c\u63d2\u4ef6\u5168\u90e8\u653e\u5728\u6b64\u884c\u4e0a\u9762 call plug#end() \u7136\u540e\u8f93\u5165 :w \u4fdd\u5b58\u914d\u7f6e\uff0c\u5728\u8f93\u5165 :PlugInstall \uff0c\u5982\u4e0b\uff1a :w :PlugInstall \u63d2\u4ef6\u4f1a\u81ea\u52a8\u4e0b\u8f7d\u5b89\u88c5\uff0c\u770b\u89c1\u4e0a\u9762\u663e\u793a Finishing ... Done \u7684\u5185\u5bb9\uff0c\u63d2\u4ef6\u5b89\u88c5\u6210\u529f \u63d2\u4ef6\u5220\u9664 \u5982\u679c\u60f3\u8981\u5220\u9664\u63d2\u4ef6\uff0c\u53ea\u8981\u5c06\u4e0d\u9700\u8981\u7684\u63d2\u4ef6\u6ce8\u91ca\u6216\u8005\u5220\u9664\uff0c\u6267\u884c :PlugClean \u5c31\u53ef\u4ee5\u81ea\u52a8\u6e05\u7406\u4e86 \u63d2\u4ef6\u914d\u7f6e \u4e0a\u9762\u4e00\u8d77\u5b89\u88c5\u4e86\u5f88\u591a\u4e2a\u63d2\u4ef6\uff0c\u6709\u4e9b\u63d2\u4ef6\u8981\u5355\u72ec\u914d\u7f6e\uff0c\u8bb0\u5f55\u5230\u4e0b\u9762 vim-go \u8fd9\u4e2a\u662f go \u8bed\u8a00\u652f\u6301\u63d2\u4ef6\uff0c\u4e0a\u9762\u63d2\u4ef6\u5b8c\u6210\u540e\u8fd8\u9700\u8981\u5b89\u88c5\u5f88\u591a\u4e2a Go \u7684\u5305\u624d\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u5728 vim \u4e2d\u6267\u884c\u4e0b\u9762\u547d\u4ee4\uff1a :GoInstallBinaries \u51fa\u73b0 vim-go: installing finished! \u5b89\u88c5\u6210\u529f\uff0c\u53ef\u4ee5\u4f7f\u7528 Go \u5305\u7684\u76f8\u5173\u529f\u80fd\u4e86 \u9700\u8981\u6ce8\u610f\u524d\u9762\u7684 PATH \u8981\u914d\u7f6e\u6b63\u786e\uff0c\u5e76\u4e14\u5df2\u7ecf\u751f\u6548\uff0c\u5982\u679c\u914d\u7f6e\u6b63\u786e\u6ca1\u6709\u751f\u6548\uff0c\u53ef\u4ee5\u6ce8\u9500\u518d\u767b\u5f55\u67e5\u770b YouCompleteMe \u8fd9\u4e2a\u63d2\u4ef6\u662f\u7528\u6765\u81ea\u52a8\u5b8c\u6210\u7684\uff0c\u4e0d\u8fc7\u9700\u8981\u624b\u52a8\u505a\u4e00\u4e9b\u989d\u5916\u7684\u914d\u7f6e a. \u5b89\u88c5\u4f9d\u8d56\u5173\u7cfb sudo apt install build-essential cmake python3-dev b. \u7f16\u8bd1 cd ~/.vim/plugged/YouCompleteMe # \u7f16\u8bd1\uff0c\u5e76\u52a0\u5165 go \u7684\u652f\u6301 python3 install.py --go-completer c. \u914d\u7f6e\u548c SirVer/ultisnips \u51b2\u7a81\u7684\u5feb\u6377\u952e let g:ycm_key_list_select_completion = ['<C-n>', '<space>'] let g:ycm_key_list_previous_completion = ['<C-p>', '<Up>'] let g:SuperTabDefaultCompletionType = '<C-n>' \" better key bindings for UltiSnipsExpandTrigger let g:UltiSnipsExpandTrigger = \"<tab>\" let g:UltiSnipsJumpForwardTrigger = \"<tab>\" let g:UltiSnipsJumpBackwardTrigger = \"<s-tab>\" \u5176\u4ed6\u63d2\u4ef6 \u5176\u4ed6\u7684\u63d2\u4ef6\u914d\u7f6e\u4e0d\u591a\uff0c\u76f4\u63a5\u770b\u914d\u7f6e\u6587\u4ef6\u7684\u6ce8\u91ca\u5373\u53ef\uff0c\u4e0b\u9762\u5c06\u6240\u6709\u7684\u914d\u7f6e\u5168\u90e8\u8d34\u51fa\u6765 \u4e0b\u9762\u662f\u5168\u90e8\u7684 ~/.vimrc \u4e2d\u7684\u914d\u7f6e, \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u6211\u914d\u7f6e\u597d\u7684 vimrc \u6587\u4ef6 \"============================================================================== \" \u5904\u7406 Gnome \u7ec8\u7aef\u4e0d\u80fd\u4f7f\u7528 alt \u5feb\u6377\u952e \" \u53c2\u8003\uff1ahttp://landcareweb.com/questions/8623/altjian-kuai-jie-jian-bu-gua-yong-yu-dai-you-vimde-gnomezhong-duan \"============================================================================== let c='a' while c <= 'z' exec \"set <A-\".c.\">=\\e\".c exec \"imap \\e\".c.\" <A-\".c.\">\" let c = nr2char(1+char2nr(c)) endw set timeout ttimeoutlen=50 \"============================================================================== \" vim \u5185\u7f6e\u914d\u7f6e \"============================================================================== \" \u8bbe\u7f6e vimrc \u4fee\u6539\u4fdd\u5b58\u540e\u7acb\u523b\u751f\u6548\uff0c\u4e0d\u7528\u5728\u91cd\u65b0\u6253\u5f00 \" \u5efa\u8bae\u914d\u7f6e\u5b8c\u6210\u540e\u5c06\u8fd9\u4e2a\u5173\u95ed\uff0c\u5426\u5219\u914d\u7f6e\u591a\u4e86\u4e4b\u540e\u4f1a\u5f88\u5361 \" autocmd BufWritePost $MYVIMRC source $MYVIMRC \" \u5173\u95ed\u517c\u5bb9\u6a21\u5f0f set nocompatible set number \" \u8bbe\u7f6e\u7edd\u5bf9\u884c\u53f7 set relativenumber \" \u8bbe\u7f6e\u76f8\u5bf9\u884c\u53f7 set cursorline \"\u7a81\u51fa\u663e\u793a\u5f53\u524d\u884c \" set cursorcolumn \" \u7a81\u51fa\u663e\u793a\u5f53\u524d\u5217 set showmatch \" \u663e\u793a\u62ec\u53f7\u5339\u914d \" tab \u7f29\u8fdb set tabstop=4 \" \u8bbe\u7f6eTab\u957f\u5ea6\u4e3a4\u7a7a\u683c set shiftwidth=4 \" \u8bbe\u7f6e\u81ea\u52a8\u7f29\u8fdb\u957f\u5ea6\u4e3a4\u7a7a\u683c set autoindent \" \u7ee7\u627f\u524d\u4e00\u884c\u7684\u7f29\u8fdb\u65b9\u5f0f\uff0c\u9002\u7528\u4e8e\u591a\u884c\u6ce8\u91ca \" \u5b9a\u4e49\u5feb\u6377\u952e\u7684\u524d\u7f00\uff0c\u5373<Leader> let mapleader=\";\" \" \u81ea\u5b9a\u4e49\u5feb\u6377\u952e \" ==== \u7cfb\u7edf\u526a\u5207\u677f\u590d\u5236\u7c98\u8d34 ==== \" v \u6a21\u5f0f\u4e0b\u590d\u5236\u5185\u5bb9\u5230\u7cfb\u7edf\u526a\u5207\u677f vmap <M-c> \"+yy \" n \u6a21\u5f0f\u4e0b\u590d\u5236\u4e00\u884c\u5230\u7cfb\u7edf\u526a\u5207\u677f nmap <M-c> \"+yy \" n \u6a21\u5f0f\u4e0b\u7c98\u8d34\u7cfb\u7edf\u526a\u5207\u677f\u7684\u5185\u5bb9 nmap <M-v> \"+p \" \u4fee\u6539\u9ed8\u8ba4\u7684\u533a\u57df\u5207\u6362\u5982ctrl+w+h \u5947\u5e7b\u5230\u5de6\u4fa7\uff0c \u4f9d\u6b21\u662f \u5de6\u53f3\u4e0a\u4e0b nmap <M-h> <C-w>h nmap <M-l> <C-w>l nmap <M-k> <C-w>k nmap <M-j> <C-w>j \"\u5f00\u542f\u5b9e\u65f6\u641c\u7d22 set incsearch \" \u641c\u7d22\u65f6\u5927\u5c0f\u5199\u4e0d\u654f\u611f set ignorecase syntax enable syntax on \" \u5f00\u542f\u6587\u4ef6\u7c7b\u578b\u4fa6\u6d4b filetype plugin indent on \" \u542f\u7528\u81ea\u52a8\u8865\u5168 \" \u9000\u51fa\u63d2\u5165\u6a21\u5f0f\u6307\u5b9a\u7c7b\u578b\u7684\u6587\u4ef6\u81ea\u52a8\u4fdd\u5b58 au InsertLeave *.go,*.sh,*.php write \"============================================================================== \" \u63d2\u4ef6\u914d\u7f6e \"============================================================================== \" \u63d2\u4ef6\u5f00\u59cb\u7684\u4f4d\u7f6e call plug#begin('~/.vim/plugged') \" Vim \u4e2d\u6587\u6587\u6863 Plug 'yianwillis/vimcdoc' \" Shorthand notation; fetches https://github.com/junegunn/vim-easy-align \" \u53ef\u4ee5\u5feb\u901f\u5bf9\u9f50\u7684\u63d2\u4ef6 Plug 'junegunn/vim-easy-align' \" \u7528\u6765\u63d0\u4f9b\u4e00\u4e2a\u5bfc\u822a\u76ee\u5f55\u7684\u4fa7\u8fb9\u680f Plug 'scrooloose/nerdtree' \" \u53ef\u4ee5\u4f7f nerdtree Tab \u6807\u7b7e\u7684\u540d\u79f0\u66f4\u53cb\u597d\u4e9b Plug 'jistr/vim-nerdtree-tabs' \" \u53ef\u4ee5\u5728\u5bfc\u822a\u76ee\u5f55\u4e2d\u770b\u5230 git \u7248\u672c\u4fe1\u606f Plug 'Xuyuanp/nerdtree-git-plugin' \" \u67e5\u770b\u5f53\u524d\u4ee3\u7801\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u548c\u51fd\u6570\u5217\u8868\u7684\u63d2\u4ef6\uff0c \" \u53ef\u4ee5\u5207\u6362\u548c\u8df3\u8f6c\u5230\u4ee3\u7801\u4e2d\u5bf9\u5e94\u7684\u53d8\u91cf\u548c\u51fd\u6570\u7684\u4f4d\u7f6e \" \u5927\u7eb2\u5f0f\u5bfc\u822a, Go \u9700\u8981 https://github.com/jstemmer/gotags \u652f\u6301 Plug 'majutsushi/tagbar' \" \u81ea\u52a8\u8865\u5168\u62ec\u53f7\u7684\u63d2\u4ef6\uff0c\u5305\u62ec\u5c0f\u62ec\u53f7\uff0c\u4e2d\u62ec\u53f7\uff0c\u4ee5\u53ca\u82b1\u62ec\u53f7 Plug 'jiangmiao/auto-pairs' \" Vim\u72b6\u6001\u680f\u63d2\u4ef6\uff0c\u5305\u62ec\u663e\u793a\u884c\u53f7\uff0c\u5217\u53f7\uff0c\u6587\u4ef6\u7c7b\u578b\uff0c\u6587\u4ef6\u540d\uff0c\u4ee5\u53caGit\u72b6\u6001 Plug 'vim-airline/vim-airline' \" \u6709\u9053\u8bcd\u5178\u5728\u7ebf\u7ffb\u8bd1 Plug 'ianva/vim-youdao-translater' \" \u4ee3\u7801\u81ea\u52a8\u5b8c\u6210\uff0c\u5b89\u88c5\u5b8c\u63d2\u4ef6\u8fd8\u9700\u8981\u989d\u5916\u914d\u7f6e\u624d\u53ef\u4ee5\u4f7f\u7528 Plug 'Valloric/YouCompleteMe' \" \u53ef\u4ee5\u5728\u6587\u6863\u4e2d\u663e\u793a git \u4fe1\u606f Plug 'airblade/vim-gitgutter' \" \u4e0b\u9762\u4e24\u4e2a\u63d2\u4ef6\u8981\u914d\u5408\u4f7f\u7528\uff0c\u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u4ee3\u7801\u5757 Plug 'SirVer/ultisnips' Plug 'honza/vim-snippets' \" \u914d\u8272\u65b9\u6848 \" colorscheme neodark Plug 'KeitaNakamura/neodark.vim' \" colorscheme monokai Plug 'crusoexia/vim-monokai' \" colorscheme github Plug 'acarapetis/vim-colors-github' \" colorscheme one Plug 'rakr/vim-one' \" go \u4e3b\u8981\u63d2\u4ef6 Plug 'fatih/vim-go', { 'tag': '*' } \" go \u4e2d\u7684\u4ee3\u7801\u8ffd\u8e2a\uff0c\u8f93\u5165 gd \u5c31\u53ef\u4ee5\u81ea\u52a8\u8df3\u8f6c Plug 'dgryski/vim-godef' \" markdown \u63d2\u4ef6 Plug 'iamcco/mathjax-support-for-mkdp' Plug 'iamcco/markdown-preview.vim' \" \u63d2\u4ef6\u7ed3\u675f\u7684\u4f4d\u7f6e\uff0c\u63d2\u4ef6\u5168\u90e8\u653e\u5728\u6b64\u884c\u4e0a\u9762 call plug#end() \"============================================================================== \" \u4e3b\u9898\u914d\u8272 \"============================================================================== \" \u5f00\u542f24bit\u7684\u989c\u8272\uff0c\u5f00\u542f\u8fd9\u4e2a\u989c\u8272\u4f1a\u66f4\u6f02\u4eae\u4e00\u4e9b set termguicolors \" \u914d\u8272\u65b9\u6848, \u53ef\u4ee5\u4ece\u4e0a\u9762\u63d2\u4ef6\u5b89\u88c5\u4e2d\u7684\u9009\u62e9\u4e00\u4e2a\u4f7f\u7528 colorscheme one \" \u4e3b\u9898 set background=dark \" \u4e3b\u9898\u80cc\u666f dark-\u6df1\u8272; light-\u6d45\u8272 \"============================================================================== \" vim-go \u63d2\u4ef6 \"============================================================================== let g:go_fmt_command = \"goimports\" \" \u683c\u5f0f\u5316\u5c06\u9ed8\u8ba4\u7684 gofmt \u66ff\u6362 let g:go_autodetect_gopath = 1 let g:go_list_type = \"quickfix\" let g:go_version_warning = 1 let g:go_highlight_types = 1 let g:go_highlight_fields = 1 let g:go_highlight_functions = 1 let g:go_highlight_function_calls = 1 let g:go_highlight_operators = 1 let g:go_highlight_extra_types = 1 let g:go_highlight_methods = 1 let g:go_highlight_generate_tags = 1 let g:godef_split=2 \" \u76f4\u63a5\u901a\u8fc7 go run \u6267\u884c\u5f53\u524d\u6587\u4ef6 autocmd FileType go nmap <leader>r :GoRun %<CR> \"============================================================================== \" NERDTree \u63d2\u4ef6 \"============================================================================== \" \u6253\u5f00\u548c\u5173\u95edNERDTree\u5feb\u6377\u952e map <F10> :NERDTreeToggle<CR> nmap <M-m> :NERDTreeFind<CR> \" \u663e\u793a\u884c\u53f7 let NERDTreeShowLineNumbers=1 \" \u6253\u5f00\u6587\u4ef6\u65f6\u662f\u5426\u663e\u793a\u76ee\u5f55 let NERDTreeAutoCenter=1 \" \u662f\u5426\u663e\u793a\u9690\u85cf\u6587\u4ef6 let NERDTreeShowHidden=0 \" \u8bbe\u7f6e\u5bbd\u5ea6 \" let NERDTreeWinSize=31 \" \u5ffd\u7565\u4e00\u4e0b\u6587\u4ef6\u7684\u663e\u793a let NERDTreeIgnore=['\\.pyc','\\~$','\\.swp'] \" \u6253\u5f00 vim \u6587\u4ef6\u53ca\u663e\u793a\u4e66\u7b7e\u5217\u8868 let NERDTreeShowBookmarks=2 \" \u5728\u7ec8\u7aef\u542f\u52a8vim\u65f6\uff0c\u5171\u4eabNERDTree let g:nerdtree_tabs_open_on_console_startup=1 \"============================================================================== \" majutsushi/tagbar \u63d2\u4ef6 \"============================================================================== \" majutsushi/tagbar \u63d2\u4ef6\u6253\u5f00\u5173\u95ed\u5feb\u6377\u952e nmap <F9> :TagbarToggle<CR> let g:tagbar_type_go = { \\ 'ctagstype' : 'go', \\ 'kinds' : [ \\ 'p:package', \\ 'i:imports:1', \\ 'c:constants', \\ 'v:variables', \\ 't:types', \\ 'n:interfaces', \\ 'w:fields', \\ 'e:embedded', \\ 'm:methods', \\ 'r:constructor', \\ 'f:functions' \\ ], \\ 'sro' : '.', \\ 'kind2scope' : { \\ 't' : 'ctype', \\ 'n' : 'ntype' \\ }, \\ 'scope2kind' : { \\ 'ctype' : 't', \\ 'ntype' : 'n' \\ }, \\ 'ctagsbin' : 'gotags', \\ 'ctagsargs' : '-sort -silent' \\ } \"============================================================================== \" nerdtree-git-plugin \u63d2\u4ef6 \"============================================================================== let g:NERDTreeIndicatorMapCustom = { \\ \"Modified\" : \"\u2739\", \\ \"Staged\" : \"\u271a\", \\ \"Untracked\" : \"\u272d\", \\ \"Renamed\" : \"\u279c\", \\ \"Unmerged\" : \"\u2550\", \\ \"Deleted\" : \"\u2716\", \\ \"Dirty\" : \"\u2717\", \\ \"Clean\" : \"\u2714\ufe0e\", \\ 'Ignored' : '\u2612', \\ \"Unknown\" : \"?\" \\ } let g:NERDTreeShowIgnoredStatus = 1 nmap <Leader>pwd :NERDTreeCWD<CR> \"============================================================================== \" Valloric/YouCompleteMe \u63d2\u4ef6 \"============================================================================== \" make YCM compatible with UltiSnips (using supertab) let g:ycm_key_list_select_completion = ['<M-w>', '<DOWN>'] let g:ycm_key_list_previous_completion = ['<M-d>', '<Up>'] let g:SuperTabDefaultCompletionType = '<M-w>' \" better key bindings for UltiSnipsExpandTrigger let g:UltiSnipsExpandTrigger = \"<tab>\" let g:UltiSnipsJumpForwardTrigger = \"<tab>\" let g:UltiSnipsJumpBackwardTrigger = \"<s-tab>\" \" \u5173\u95ed\u4e86\u63d0\u793a\u518d\u6b21\u89e6\u53d1\u7684\u5feb\u6377\u952e let g:ycm_key_invoke_completion = '<Leader>,' \"============================================================================== \" \u5176\u4ed6\u63d2\u4ef6\u914d\u7f6e \"============================================================================== \" markdwon \u7684\u5feb\u6377\u952e map <silent> <F5> <Plug>MarkdownPreview map <silent> <F6> <Plug>StopMarkdownPreview \" tab \u6807\u7b7e\u9875\u5207\u6362\u5feb\u6377\u952e :nn <Leader>1 1gt :nn <Leader>2 2gt :nn <Leader>3 3gt :nn <Leader>4 4gt :nn <Leader>5 5gt :nn <Leader>6 6gt :nn <Leader>7 7gt :nn <Leader>8 8gt :nn <Leader>9 8gt :nn <Leader>0 :tablast<CR> \"============================================================================== \" GVim \u7684\u914d\u7f6e \"============================================================================== \" \u5982\u679c\u4e0d\u4f7f\u7528 GVim \uff0c\u53ef\u4ee5\u4e0d\u7528\u914d\u7f6e\u4e0b\u9762\u7684\u914d\u7f6e if has('gui_running') colorscheme one \" \u8bbe\u7f6e\u542f\u52a8\u65f6\u7a97\u53e3\u7684\u5927\u5c0f set lines=999 columns=999 linespace=4 \" \u8bbe\u7f6e\u5b57\u4f53\u53ca\u5927\u5c0f set guifont=Roboto\\ Mono\\ 13 set guioptions-=m \" \u9690\u85cf\u83dc\u5355\u680f set guioptions-=T \" \u9690\u85cf\u5de5\u5177\u680f set guioptions-=L \" \u9690\u85cf\u5de6\u4fa7\u6eda\u52a8\u6761 set guioptions-=r \" \u9690\u85cf\u53f3\u4fa7\u6eda\u52a8\u6761 set guioptions-=b \" \u9690\u85cf\u5e95\u90e8\u6eda\u52a8\u6761 \" \u5728 gvim \u4e0b\u4e0d\u4f1a\u548c terminal \u7684 alt+\u6570\u5b57\u7684\u5feb\u6377\u952e\u51b2\u7a81\uff0c \" \u6240\u4ee5\u5c06 tab \u5207\u6362\u914d\u7f6e\u4e00\u4efd alt+\u6570\u5b57\u7684\u5feb\u6377\u952e :nn <M-1> 1gt :nn <M-2> 2gt :nn <M-3> 3gt :nn <M-4> 4gt :nn <M-5> 5gt :nn <M-6> 6gt :nn <M-7> 7gt :nn <M-8> 8gt :nn <M-9> 9gt :nn <M-0> :tablast<CR> endif \"============================================================================== \" \u5149\u6807\u968f\u7740\u63d2\u5165\u6a21\u5f0f\u6539\u53d8\u5f62\u72b6 \" \u53c2\u8003\uff1a https://vim.fandom.com/wiki/Change_cursor_shape_in_different_modes \"============================================================================== if has(\"autocmd\") au VimEnter,InsertLeave * silent execute '!echo -ne \"\\e[2 q\"' | redraw! au InsertEnter,InsertChange * \\ if v:insertmode == 'i' | \\ silent execute '!echo -ne \"\\e[6 q\"' | redraw! | \\ elseif v:insertmode == 'r' | \\ silent execute '!echo -ne \"\\e[4 q\"' | redraw! | \\ endif au VimLeave * silent execute '!echo -ne \"\\e[ q\"' | redraw! endif \u9519\u8bef\u5904\u7406 \u7f3a\u5c11 \u5f53\u4f7f\u7528 F9 \u7684\u65f6\u5019\uff0c \u51fa\u73b0\u4e0b\u9762\u7684\u9519\u8bef\uff1a Taglist: Exuberant ctags (http://ctags.sf.net) not found in PATH. Plugin is not loaded \u89e3\u51b3\u65b9\u6cd5\uff1a sudo apt install ctags","title":"Vim ide"},{"location":"Tools/vim-ide/#go","text":"\u65e2\u7136\u662f Go \u7684\u5f00\u53d1\u73af\u5883\uff0c\u7b2c\u4e00\u6b65\u5f53\u524d\u5c31\u662f\u51c6\u5907\u597d \u3002","title":"\u914d\u7f6e Go \u73af\u5883"},{"location":"Tools/vim-ide/#go_1","text":"\u5230 golang.org \u5c06\u5b89\u88c5\u5305\u4e0b\u8f7d\uff0c\u5e76\u914d\u7f6e\u597d\u73af\u5883\uff0c \u63a8\u8350\u4f7f\u7528\u4e8c\u8fdb\u5236\u7248\u672c\uff0c\u4e0b\u8f7d\u5b8c\u6210\u540e\u76f4\u63a5\u89e3\u538b\u7f29\u5c31\u53ef\u4ee5\u4f7f\u7528\u3002\u5982\u679c\u65e0\u6cd5\u8bbf\u95ee go \u5b98\u7f51\uff0c\u53ef\u4ee5\u8003\u8651\u53bb golang.google.cn \u53bb\u4e0b\u8f7d\u3002 wget https://dl.google.com/go/go1.12.linux-amd64.tar.gz sudo tar xzvf go1.12.linux-amd64.tar.gz -C /usr/local/","title":"\u5b89\u88c5 Go"},{"location":"Tools/vim-ide/#path-gopath","text":"\u521b\u5efa Go \u7684\u5de5\u4f5c\u7a7a\u95f4\uff08\u76ee\u5f55\uff09 # \u8fd9\u662f\u9ed8\u8ba4\u7684\u4f4d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u6309\u7167\u9700\u6c42\u6307\u5b9a\u5230\u5176\u4ed6\u76ee\u5f55 mkdir -p $HOME/go/{bin,pkg,src} \u914d\u7f6e\u73af\u5883\u53d8\u91cf \u7528\u6237 vim \u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u6587 vim /etc/profile.d/go.sh \uff0c\u5199\u5165\u4e0b\u9762\u5185\u5bb9 export GOPATH=$HOME/go export GOROOT=/usr/local/go export PATH=$PATH:$GOROOT/bin:$GOPATH/bin","title":"\u914d\u7f6e PATH \u53ca GOPATH"},{"location":"Tools/vim-ide/#vim","text":"\u6253\u5f00 vimrc \u6587\u4ef6 vim ~/.vimrc \uff0c\u5199\u5165\u4e0b\u9762\u914d\u7f6e \"============================================================================== \" vim \u5185\u7f6e\u914d\u7f6e \"============================================================================== \" \u8bbe\u7f6e vimrc \u4fee\u6539\u4fdd\u5b58\u540e\u7acb\u523b\u751f\u6548\uff0c\u4e0d\u7528\u5728\u91cd\u65b0\u6253\u5f00 \" \u5efa\u8bae\u914d\u7f6e\u5b8c\u6210\u540e\u5c06\u8fd9\u4e2a\u5173\u95ed autocmd BufWritePost $MYVIMRC source $MYVIMRC \" \u5173\u95ed\u517c\u5bb9\u6a21\u5f0f set nocompatible set nu \" \u8bbe\u7f6e\u884c\u53f7 set cursorline \"\u7a81\u51fa\u663e\u793a\u5f53\u524d\u884c \" set cursorcolumn \" \u7a81\u51fa\u663e\u793a\u5f53\u524d\u5217 set showmatch \" \u663e\u793a\u62ec\u53f7\u5339\u914d \" tab \u7f29\u8fdb set tabstop=4 \" \u8bbe\u7f6eTab\u957f\u5ea6\u4e3a4\u7a7a\u683c set shiftwidth=4 \" \u8bbe\u7f6e\u81ea\u52a8\u7f29\u8fdb\u957f\u5ea6\u4e3a4\u7a7a\u683c set autoindent \" \u7ee7\u627f\u524d\u4e00\u884c\u7684\u7f29\u8fdb\u65b9\u5f0f\uff0c\u9002\u7528\u4e8e\u591a\u884c\u6ce8\u91ca \" \u5b9a\u4e49\u5feb\u6377\u952e\u7684\u524d\u7f00\uff0c\u5373<Leader> let mapleader=\";\" \" ==== \u7cfb\u7edf\u526a\u5207\u677f\u590d\u5236\u7c98\u8d34 ==== \" v \u6a21\u5f0f\u4e0b\u590d\u5236\u5185\u5bb9\u5230\u7cfb\u7edf\u526a\u5207\u677f vmap <Leader>c \"+yy \" n \u6a21\u5f0f\u4e0b\u590d\u5236\u4e00\u884c\u5230\u7cfb\u7edf\u526a\u5207\u677f nmap <Leader>c \"+yy \" n \u6a21\u5f0f\u4e0b\u7c98\u8d34\u7cfb\u7edf\u526a\u5207\u677f\u7684\u5185\u5bb9 nmap <Leader>v \"+p \" \u5f00\u542f\u5b9e\u65f6\u641c\u7d22 set incsearch \" \u641c\u7d22\u65f6\u5927\u5c0f\u5199\u4e0d\u654f\u611f set ignorecase syntax enable syntax on \" \u5f00\u542f\u6587\u4ef6\u7c7b\u578b\u4fa6\u6d4b filetype plugin indent on \" \u542f\u7528\u81ea\u52a8\u8865\u5168 \" \u9000\u51fa\u63d2\u5165\u6a21\u5f0f\u6307\u5b9a\u7c7b\u578b\u7684\u6587\u4ef6\u81ea\u52a8\u4fdd\u5b58 au InsertLeave *.go,*.sh,*.php write","title":"Vim \u57fa\u672c\u914d\u7f6e"},{"location":"Tools/vim-ide/#_1","text":"\u63d2\u4ef6\u7684\u7528\u9014\u5c31\u662f\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u7ba1\u7406 vim \u7684\u5404\u79cd\u63d2\u4ef6\uff0c\u5feb\u901f\u5b89\u88c5\u914d\u7f6e\u4ee5\u53ca\u6e05\u9664\uff0c\u7f51\u4e0a\u73b0\u5728\u7684\u5e16\u5b50\u591a\u6570\u90fd\u662f\u4f7f\u7528\u7684 Vundle \u8fd9\u4e2a\u63d2\u4ef6\uff0c\u4e0d\u8fc7\u4e2a\u4eba\u89c9\u5f97\u8fd9\u4e2a\u7ba1\u7406\u5de5\u5177\u5728\u63d2\u4ef6\u5b89\u88c5\u591a\u4e86\u7684\u65f6\u5019\u4e0d\u662f\u5f88\u6d41\u7545\uff0c\u66f4\u559c\u597d\u4f7f\u7528 vim-plug \u8fd9\u4e2a\u63d2\u4ef6\uff0c\u4e24\u4e2a\u63d2\u4ef6\u90fd\u662f\u5f88\u6e05\u9664\u7684\u5b89\u88c5\u6587\u6863\uff0c\u8fd9\u91cc\u662f\u4ecb\u7ecd vim-plug \u3002","title":"\u63d2\u4ef6\u7ba1\u7406"},{"location":"Tools/vim-ide/#_2","text":"\u5728 Linux \u4e0b\u975e\u5e38\u7b80\u5355\uff0c\u76f4\u63a5\u901a\u8fc7 curl \u4e0b\u8f7d\u5373\u53ef\uff08\u4e5f\u53ef\u4ee5\u624b\u52a8\u4e0b\u8f7d\uff0c\u89c1\u5b98\u65b9\u6587\u6863\uff09 curl -fLo ~/.vim/autoload/plug.vim --create-dirs \\ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim","title":"\u5b89\u88c5\u63d2\u4ef6"},{"location":"Tools/vim-ide/#_3","text":"\u63d2\u4ef6\u7684\u914d\u7f6e\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u8981\u5c06\u6240\u6709\u7684\u63d2\u4ef6\u914d\u7f6e\u5728 call plug#begin('~/.vim/plugged') \u548c call plug#end() \u4e4b\u95f4\u5373\u53ef\uff0c\u5e38\u89c1\u7684\u63d2\u4ef6\u57fa\u672c\u4e0a\u90fd\u53ef\u4ee5\u4ece github \u4e2d\u627e\u5230\uff0c\u5982\u679c github \u627e\u4e0d\u5230\u7684\u8bdd\u57fa\u672c\u4e0a vim.org \u7684\u811a\u672c\u90fd\u53ef\u4ee5\u5728 vim-script \u4e2d\u627e\u5230\u5907\u4efd \u5728\u521a\u521a\u7684 ~/.vimrc \u4e0b\u9762\u7ee7\u7eed\u6dfb\u52a0\u63d2\u4ef6\u76f8\u5173\u7684\u914d\u7f6e \" \u63d2\u4ef6\u5f00\u59cb\u7684\u4f4d\u7f6e call plug#begin('~/.vim/plugged') \" Shorthand notation; fetches https://github.com/junegunn/vim-easy-align \" \u53ef\u4ee5\u5feb\u901f\u5bf9\u9f50\u7684\u63d2\u4ef6 Plug 'junegunn/vim-easy-align' \" \u7528\u6765\u63d0\u4f9b\u4e00\u4e2a\u5bfc\u822a\u76ee\u5f55\u7684\u4fa7\u8fb9\u680f Plug 'scrooloose/nerdtree' \" \u53ef\u4ee5\u4f7f nerdtree \u7684 tab \u66f4\u52a0\u53cb\u597d\u4e9b Plug 'jistr/vim-nerdtree-tabs' \" \u53ef\u4ee5\u5728\u5bfc\u822a\u76ee\u5f55\u4e2d\u770b\u5230 git \u7248\u672c\u4fe1\u606f Plug 'Xuyuanp/nerdtree-git-plugin' \" \u67e5\u770b\u5f53\u524d\u4ee3\u7801\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u548c\u51fd\u6570\u5217\u8868\u7684\u63d2\u4ef6\uff0c \" \u53ef\u4ee5\u5207\u6362\u548c\u8df3\u8f6c\u5230\u4ee3\u7801\u4e2d\u5bf9\u5e94\u7684\u53d8\u91cf\u548c\u51fd\u6570\u7684\u4f4d\u7f6e \" \u5927\u7eb2\u5f0f\u5bfc\u822a, Go \u9700\u8981 https://github.com/jstemmer/gotags \u652f\u6301 Plug 'majutsushi/tagbar' \" \u81ea\u52a8\u8865\u5168\u62ec\u53f7\u7684\u63d2\u4ef6\uff0c\u5305\u62ec\u5c0f\u62ec\u53f7\uff0c\u4e2d\u62ec\u53f7\uff0c\u4ee5\u53ca\u82b1\u62ec\u53f7 Plug 'jiangmiao/auto-pairs' \" Vim\u72b6\u6001\u680f\u63d2\u4ef6\uff0c\u5305\u62ec\u663e\u793a\u884c\u53f7\uff0c\u5217\u53f7\uff0c\u6587\u4ef6\u7c7b\u578b\uff0c\u6587\u4ef6\u540d\uff0c\u4ee5\u53caGit\u72b6\u6001 Plug 'vim-airline/vim-airline' \" \u6709\u9053\u8bcd\u5178\u5728\u7ebf\u7ffb\u8bd1 Plug 'ianva/vim-youdao-translater' \" \u4ee3\u7801\u81ea\u52a8\u5b8c\u6210\uff0c\u5b89\u88c5\u5b8c\u63d2\u4ef6\u8fd8\u9700\u8981\u989d\u5916\u914d\u7f6e\u624d\u53ef\u4ee5\u4f7f\u7528 Plug 'Valloric/YouCompleteMe' \" \u53ef\u4ee5\u5728\u6587\u6863\u4e2d\u663e\u793a git \u4fe1\u606f Plug 'airblade/vim-gitgutter' \" \u4e0b\u9762\u4e24\u4e2a\u63d2\u4ef6\u8981\u914d\u5408\u4f7f\u7528\uff0c\u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u4ee3\u7801\u5757 Plug 'SirVer/ultisnips' Plug 'honza/vim-snippets' \" \u53ef\u4ee5\u5728 vim \u4e2d\u4f7f\u7528 tab \u8865\u5168 \"Plug 'vim-scripts/SuperTab' \" \u53ef\u4ee5\u5728 vim \u4e2d\u81ea\u52a8\u5b8c\u6210 \"Plug 'Shougo/neocomplete.vim' \" \u914d\u8272\u65b9\u6848 \" colorscheme neodark Plug 'KeitaNakamura/neodark.vim' \" colorscheme monokai Plug 'crusoexia/vim-monokai' \" colorscheme github Plug 'acarapetis/vim-colors-github' \" colorscheme one Plug 'rakr/vim-one' \" go \u4e3b\u8981\u63d2\u4ef6 Plug 'fatih/vim-go', { 'tag': '*' } \" go \u4e2d\u7684\u4ee3\u7801\u8ffd\u8e2a\uff0c\u8f93\u5165 gd \u5c31\u53ef\u4ee5\u81ea\u52a8\u8df3\u8f6c Plug 'dgryski/vim-godef' \" markdown \u63d2\u4ef6 Plug 'iamcco/mathjax-support-for-mkdp' Plug 'iamcco/markdown-preview.vim' \" \u63d2\u4ef6\u7ed3\u675f\u7684\u4f4d\u7f6e\uff0c\u63d2\u4ef6\u5168\u90e8\u653e\u5728\u6b64\u884c\u4e0a\u9762 call plug#end() \u7136\u540e\u8f93\u5165 :w \u4fdd\u5b58\u914d\u7f6e\uff0c\u5728\u8f93\u5165 :PlugInstall \uff0c\u5982\u4e0b\uff1a :w :PlugInstall \u63d2\u4ef6\u4f1a\u81ea\u52a8\u4e0b\u8f7d\u5b89\u88c5\uff0c\u770b\u89c1\u4e0a\u9762\u663e\u793a Finishing ... Done \u7684\u5185\u5bb9\uff0c\u63d2\u4ef6\u5b89\u88c5\u6210\u529f","title":"\u914d\u7f6e\u63d2\u4ef6"},{"location":"Tools/vim-ide/#_4","text":"\u5982\u679c\u60f3\u8981\u5220\u9664\u63d2\u4ef6\uff0c\u53ea\u8981\u5c06\u4e0d\u9700\u8981\u7684\u63d2\u4ef6\u6ce8\u91ca\u6216\u8005\u5220\u9664\uff0c\u6267\u884c :PlugClean \u5c31\u53ef\u4ee5\u81ea\u52a8\u6e05\u7406\u4e86","title":"\u63d2\u4ef6\u5220\u9664"},{"location":"Tools/vim-ide/#_5","text":"\u4e0a\u9762\u4e00\u8d77\u5b89\u88c5\u4e86\u5f88\u591a\u4e2a\u63d2\u4ef6\uff0c\u6709\u4e9b\u63d2\u4ef6\u8981\u5355\u72ec\u914d\u7f6e\uff0c\u8bb0\u5f55\u5230\u4e0b\u9762","title":"\u63d2\u4ef6\u914d\u7f6e"},{"location":"Tools/vim-ide/#vim-go","text":"\u8fd9\u4e2a\u662f go \u8bed\u8a00\u652f\u6301\u63d2\u4ef6\uff0c\u4e0a\u9762\u63d2\u4ef6\u5b8c\u6210\u540e\u8fd8\u9700\u8981\u5b89\u88c5\u5f88\u591a\u4e2a Go \u7684\u5305\u624d\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u5728 vim \u4e2d\u6267\u884c\u4e0b\u9762\u547d\u4ee4\uff1a :GoInstallBinaries \u51fa\u73b0 vim-go: installing finished! \u5b89\u88c5\u6210\u529f\uff0c\u53ef\u4ee5\u4f7f\u7528 Go \u5305\u7684\u76f8\u5173\u529f\u80fd\u4e86 \u9700\u8981\u6ce8\u610f\u524d\u9762\u7684 PATH \u8981\u914d\u7f6e\u6b63\u786e\uff0c\u5e76\u4e14\u5df2\u7ecf\u751f\u6548\uff0c\u5982\u679c\u914d\u7f6e\u6b63\u786e\u6ca1\u6709\u751f\u6548\uff0c\u53ef\u4ee5\u6ce8\u9500\u518d\u767b\u5f55\u67e5\u770b","title":"vim-go"},{"location":"Tools/vim-ide/#youcompleteme","text":"\u8fd9\u4e2a\u63d2\u4ef6\u662f\u7528\u6765\u81ea\u52a8\u5b8c\u6210\u7684\uff0c\u4e0d\u8fc7\u9700\u8981\u624b\u52a8\u505a\u4e00\u4e9b\u989d\u5916\u7684\u914d\u7f6e a. \u5b89\u88c5\u4f9d\u8d56\u5173\u7cfb sudo apt install build-essential cmake python3-dev b. \u7f16\u8bd1 cd ~/.vim/plugged/YouCompleteMe # \u7f16\u8bd1\uff0c\u5e76\u52a0\u5165 go \u7684\u652f\u6301 python3 install.py --go-completer c. \u914d\u7f6e\u548c SirVer/ultisnips \u51b2\u7a81\u7684\u5feb\u6377\u952e let g:ycm_key_list_select_completion = ['<C-n>', '<space>'] let g:ycm_key_list_previous_completion = ['<C-p>', '<Up>'] let g:SuperTabDefaultCompletionType = '<C-n>' \" better key bindings for UltiSnipsExpandTrigger let g:UltiSnipsExpandTrigger = \"<tab>\" let g:UltiSnipsJumpForwardTrigger = \"<tab>\" let g:UltiSnipsJumpBackwardTrigger = \"<s-tab>\"","title":"YouCompleteMe"},{"location":"Tools/vim-ide/#_6","text":"\u5176\u4ed6\u7684\u63d2\u4ef6\u914d\u7f6e\u4e0d\u591a\uff0c\u76f4\u63a5\u770b\u914d\u7f6e\u6587\u4ef6\u7684\u6ce8\u91ca\u5373\u53ef\uff0c\u4e0b\u9762\u5c06\u6240\u6709\u7684\u914d\u7f6e\u5168\u90e8\u8d34\u51fa\u6765 \u4e0b\u9762\u662f\u5168\u90e8\u7684 ~/.vimrc \u4e2d\u7684\u914d\u7f6e, \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4e0b\u8f7d\u6211\u914d\u7f6e\u597d\u7684 vimrc \u6587\u4ef6 \"============================================================================== \" \u5904\u7406 Gnome \u7ec8\u7aef\u4e0d\u80fd\u4f7f\u7528 alt \u5feb\u6377\u952e \" \u53c2\u8003\uff1ahttp://landcareweb.com/questions/8623/altjian-kuai-jie-jian-bu-gua-yong-yu-dai-you-vimde-gnomezhong-duan \"============================================================================== let c='a' while c <= 'z' exec \"set <A-\".c.\">=\\e\".c exec \"imap \\e\".c.\" <A-\".c.\">\" let c = nr2char(1+char2nr(c)) endw set timeout ttimeoutlen=50 \"============================================================================== \" vim \u5185\u7f6e\u914d\u7f6e \"============================================================================== \" \u8bbe\u7f6e vimrc \u4fee\u6539\u4fdd\u5b58\u540e\u7acb\u523b\u751f\u6548\uff0c\u4e0d\u7528\u5728\u91cd\u65b0\u6253\u5f00 \" \u5efa\u8bae\u914d\u7f6e\u5b8c\u6210\u540e\u5c06\u8fd9\u4e2a\u5173\u95ed\uff0c\u5426\u5219\u914d\u7f6e\u591a\u4e86\u4e4b\u540e\u4f1a\u5f88\u5361 \" autocmd BufWritePost $MYVIMRC source $MYVIMRC \" \u5173\u95ed\u517c\u5bb9\u6a21\u5f0f set nocompatible set number \" \u8bbe\u7f6e\u7edd\u5bf9\u884c\u53f7 set relativenumber \" \u8bbe\u7f6e\u76f8\u5bf9\u884c\u53f7 set cursorline \"\u7a81\u51fa\u663e\u793a\u5f53\u524d\u884c \" set cursorcolumn \" \u7a81\u51fa\u663e\u793a\u5f53\u524d\u5217 set showmatch \" \u663e\u793a\u62ec\u53f7\u5339\u914d \" tab \u7f29\u8fdb set tabstop=4 \" \u8bbe\u7f6eTab\u957f\u5ea6\u4e3a4\u7a7a\u683c set shiftwidth=4 \" \u8bbe\u7f6e\u81ea\u52a8\u7f29\u8fdb\u957f\u5ea6\u4e3a4\u7a7a\u683c set autoindent \" \u7ee7\u627f\u524d\u4e00\u884c\u7684\u7f29\u8fdb\u65b9\u5f0f\uff0c\u9002\u7528\u4e8e\u591a\u884c\u6ce8\u91ca \" \u5b9a\u4e49\u5feb\u6377\u952e\u7684\u524d\u7f00\uff0c\u5373<Leader> let mapleader=\";\" \" \u81ea\u5b9a\u4e49\u5feb\u6377\u952e \" ==== \u7cfb\u7edf\u526a\u5207\u677f\u590d\u5236\u7c98\u8d34 ==== \" v \u6a21\u5f0f\u4e0b\u590d\u5236\u5185\u5bb9\u5230\u7cfb\u7edf\u526a\u5207\u677f vmap <M-c> \"+yy \" n \u6a21\u5f0f\u4e0b\u590d\u5236\u4e00\u884c\u5230\u7cfb\u7edf\u526a\u5207\u677f nmap <M-c> \"+yy \" n \u6a21\u5f0f\u4e0b\u7c98\u8d34\u7cfb\u7edf\u526a\u5207\u677f\u7684\u5185\u5bb9 nmap <M-v> \"+p \" \u4fee\u6539\u9ed8\u8ba4\u7684\u533a\u57df\u5207\u6362\u5982ctrl+w+h \u5947\u5e7b\u5230\u5de6\u4fa7\uff0c \u4f9d\u6b21\u662f \u5de6\u53f3\u4e0a\u4e0b nmap <M-h> <C-w>h nmap <M-l> <C-w>l nmap <M-k> <C-w>k nmap <M-j> <C-w>j \"\u5f00\u542f\u5b9e\u65f6\u641c\u7d22 set incsearch \" \u641c\u7d22\u65f6\u5927\u5c0f\u5199\u4e0d\u654f\u611f set ignorecase syntax enable syntax on \" \u5f00\u542f\u6587\u4ef6\u7c7b\u578b\u4fa6\u6d4b filetype plugin indent on \" \u542f\u7528\u81ea\u52a8\u8865\u5168 \" \u9000\u51fa\u63d2\u5165\u6a21\u5f0f\u6307\u5b9a\u7c7b\u578b\u7684\u6587\u4ef6\u81ea\u52a8\u4fdd\u5b58 au InsertLeave *.go,*.sh,*.php write \"============================================================================== \" \u63d2\u4ef6\u914d\u7f6e \"============================================================================== \" \u63d2\u4ef6\u5f00\u59cb\u7684\u4f4d\u7f6e call plug#begin('~/.vim/plugged') \" Vim \u4e2d\u6587\u6587\u6863 Plug 'yianwillis/vimcdoc' \" Shorthand notation; fetches https://github.com/junegunn/vim-easy-align \" \u53ef\u4ee5\u5feb\u901f\u5bf9\u9f50\u7684\u63d2\u4ef6 Plug 'junegunn/vim-easy-align' \" \u7528\u6765\u63d0\u4f9b\u4e00\u4e2a\u5bfc\u822a\u76ee\u5f55\u7684\u4fa7\u8fb9\u680f Plug 'scrooloose/nerdtree' \" \u53ef\u4ee5\u4f7f nerdtree Tab \u6807\u7b7e\u7684\u540d\u79f0\u66f4\u53cb\u597d\u4e9b Plug 'jistr/vim-nerdtree-tabs' \" \u53ef\u4ee5\u5728\u5bfc\u822a\u76ee\u5f55\u4e2d\u770b\u5230 git \u7248\u672c\u4fe1\u606f Plug 'Xuyuanp/nerdtree-git-plugin' \" \u67e5\u770b\u5f53\u524d\u4ee3\u7801\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u548c\u51fd\u6570\u5217\u8868\u7684\u63d2\u4ef6\uff0c \" \u53ef\u4ee5\u5207\u6362\u548c\u8df3\u8f6c\u5230\u4ee3\u7801\u4e2d\u5bf9\u5e94\u7684\u53d8\u91cf\u548c\u51fd\u6570\u7684\u4f4d\u7f6e \" \u5927\u7eb2\u5f0f\u5bfc\u822a, Go \u9700\u8981 https://github.com/jstemmer/gotags \u652f\u6301 Plug 'majutsushi/tagbar' \" \u81ea\u52a8\u8865\u5168\u62ec\u53f7\u7684\u63d2\u4ef6\uff0c\u5305\u62ec\u5c0f\u62ec\u53f7\uff0c\u4e2d\u62ec\u53f7\uff0c\u4ee5\u53ca\u82b1\u62ec\u53f7 Plug 'jiangmiao/auto-pairs' \" Vim\u72b6\u6001\u680f\u63d2\u4ef6\uff0c\u5305\u62ec\u663e\u793a\u884c\u53f7\uff0c\u5217\u53f7\uff0c\u6587\u4ef6\u7c7b\u578b\uff0c\u6587\u4ef6\u540d\uff0c\u4ee5\u53caGit\u72b6\u6001 Plug 'vim-airline/vim-airline' \" \u6709\u9053\u8bcd\u5178\u5728\u7ebf\u7ffb\u8bd1 Plug 'ianva/vim-youdao-translater' \" \u4ee3\u7801\u81ea\u52a8\u5b8c\u6210\uff0c\u5b89\u88c5\u5b8c\u63d2\u4ef6\u8fd8\u9700\u8981\u989d\u5916\u914d\u7f6e\u624d\u53ef\u4ee5\u4f7f\u7528 Plug 'Valloric/YouCompleteMe' \" \u53ef\u4ee5\u5728\u6587\u6863\u4e2d\u663e\u793a git \u4fe1\u606f Plug 'airblade/vim-gitgutter' \" \u4e0b\u9762\u4e24\u4e2a\u63d2\u4ef6\u8981\u914d\u5408\u4f7f\u7528\uff0c\u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u4ee3\u7801\u5757 Plug 'SirVer/ultisnips' Plug 'honza/vim-snippets' \" \u914d\u8272\u65b9\u6848 \" colorscheme neodark Plug 'KeitaNakamura/neodark.vim' \" colorscheme monokai Plug 'crusoexia/vim-monokai' \" colorscheme github Plug 'acarapetis/vim-colors-github' \" colorscheme one Plug 'rakr/vim-one' \" go \u4e3b\u8981\u63d2\u4ef6 Plug 'fatih/vim-go', { 'tag': '*' } \" go \u4e2d\u7684\u4ee3\u7801\u8ffd\u8e2a\uff0c\u8f93\u5165 gd \u5c31\u53ef\u4ee5\u81ea\u52a8\u8df3\u8f6c Plug 'dgryski/vim-godef' \" markdown \u63d2\u4ef6 Plug 'iamcco/mathjax-support-for-mkdp' Plug 'iamcco/markdown-preview.vim' \" \u63d2\u4ef6\u7ed3\u675f\u7684\u4f4d\u7f6e\uff0c\u63d2\u4ef6\u5168\u90e8\u653e\u5728\u6b64\u884c\u4e0a\u9762 call plug#end() \"============================================================================== \" \u4e3b\u9898\u914d\u8272 \"============================================================================== \" \u5f00\u542f24bit\u7684\u989c\u8272\uff0c\u5f00\u542f\u8fd9\u4e2a\u989c\u8272\u4f1a\u66f4\u6f02\u4eae\u4e00\u4e9b set termguicolors \" \u914d\u8272\u65b9\u6848, \u53ef\u4ee5\u4ece\u4e0a\u9762\u63d2\u4ef6\u5b89\u88c5\u4e2d\u7684\u9009\u62e9\u4e00\u4e2a\u4f7f\u7528 colorscheme one \" \u4e3b\u9898 set background=dark \" \u4e3b\u9898\u80cc\u666f dark-\u6df1\u8272; light-\u6d45\u8272 \"============================================================================== \" vim-go \u63d2\u4ef6 \"============================================================================== let g:go_fmt_command = \"goimports\" \" \u683c\u5f0f\u5316\u5c06\u9ed8\u8ba4\u7684 gofmt \u66ff\u6362 let g:go_autodetect_gopath = 1 let g:go_list_type = \"quickfix\" let g:go_version_warning = 1 let g:go_highlight_types = 1 let g:go_highlight_fields = 1 let g:go_highlight_functions = 1 let g:go_highlight_function_calls = 1 let g:go_highlight_operators = 1 let g:go_highlight_extra_types = 1 let g:go_highlight_methods = 1 let g:go_highlight_generate_tags = 1 let g:godef_split=2 \" \u76f4\u63a5\u901a\u8fc7 go run \u6267\u884c\u5f53\u524d\u6587\u4ef6 autocmd FileType go nmap <leader>r :GoRun %<CR> \"============================================================================== \" NERDTree \u63d2\u4ef6 \"============================================================================== \" \u6253\u5f00\u548c\u5173\u95edNERDTree\u5feb\u6377\u952e map <F10> :NERDTreeToggle<CR> nmap <M-m> :NERDTreeFind<CR> \" \u663e\u793a\u884c\u53f7 let NERDTreeShowLineNumbers=1 \" \u6253\u5f00\u6587\u4ef6\u65f6\u662f\u5426\u663e\u793a\u76ee\u5f55 let NERDTreeAutoCenter=1 \" \u662f\u5426\u663e\u793a\u9690\u85cf\u6587\u4ef6 let NERDTreeShowHidden=0 \" \u8bbe\u7f6e\u5bbd\u5ea6 \" let NERDTreeWinSize=31 \" \u5ffd\u7565\u4e00\u4e0b\u6587\u4ef6\u7684\u663e\u793a let NERDTreeIgnore=['\\.pyc','\\~$','\\.swp'] \" \u6253\u5f00 vim \u6587\u4ef6\u53ca\u663e\u793a\u4e66\u7b7e\u5217\u8868 let NERDTreeShowBookmarks=2 \" \u5728\u7ec8\u7aef\u542f\u52a8vim\u65f6\uff0c\u5171\u4eabNERDTree let g:nerdtree_tabs_open_on_console_startup=1 \"============================================================================== \" majutsushi/tagbar \u63d2\u4ef6 \"============================================================================== \" majutsushi/tagbar \u63d2\u4ef6\u6253\u5f00\u5173\u95ed\u5feb\u6377\u952e nmap <F9> :TagbarToggle<CR> let g:tagbar_type_go = { \\ 'ctagstype' : 'go', \\ 'kinds' : [ \\ 'p:package', \\ 'i:imports:1', \\ 'c:constants', \\ 'v:variables', \\ 't:types', \\ 'n:interfaces', \\ 'w:fields', \\ 'e:embedded', \\ 'm:methods', \\ 'r:constructor', \\ 'f:functions' \\ ], \\ 'sro' : '.', \\ 'kind2scope' : { \\ 't' : 'ctype', \\ 'n' : 'ntype' \\ }, \\ 'scope2kind' : { \\ 'ctype' : 't', \\ 'ntype' : 'n' \\ }, \\ 'ctagsbin' : 'gotags', \\ 'ctagsargs' : '-sort -silent' \\ } \"============================================================================== \" nerdtree-git-plugin \u63d2\u4ef6 \"============================================================================== let g:NERDTreeIndicatorMapCustom = { \\ \"Modified\" : \"\u2739\", \\ \"Staged\" : \"\u271a\", \\ \"Untracked\" : \"\u272d\", \\ \"Renamed\" : \"\u279c\", \\ \"Unmerged\" : \"\u2550\", \\ \"Deleted\" : \"\u2716\", \\ \"Dirty\" : \"\u2717\", \\ \"Clean\" : \"\u2714\ufe0e\", \\ 'Ignored' : '\u2612', \\ \"Unknown\" : \"?\" \\ } let g:NERDTreeShowIgnoredStatus = 1 nmap <Leader>pwd :NERDTreeCWD<CR> \"============================================================================== \" Valloric/YouCompleteMe \u63d2\u4ef6 \"============================================================================== \" make YCM compatible with UltiSnips (using supertab) let g:ycm_key_list_select_completion = ['<M-w>', '<DOWN>'] let g:ycm_key_list_previous_completion = ['<M-d>', '<Up>'] let g:SuperTabDefaultCompletionType = '<M-w>' \" better key bindings for UltiSnipsExpandTrigger let g:UltiSnipsExpandTrigger = \"<tab>\" let g:UltiSnipsJumpForwardTrigger = \"<tab>\" let g:UltiSnipsJumpBackwardTrigger = \"<s-tab>\" \" \u5173\u95ed\u4e86\u63d0\u793a\u518d\u6b21\u89e6\u53d1\u7684\u5feb\u6377\u952e let g:ycm_key_invoke_completion = '<Leader>,' \"============================================================================== \" \u5176\u4ed6\u63d2\u4ef6\u914d\u7f6e \"============================================================================== \" markdwon \u7684\u5feb\u6377\u952e map <silent> <F5> <Plug>MarkdownPreview map <silent> <F6> <Plug>StopMarkdownPreview \" tab \u6807\u7b7e\u9875\u5207\u6362\u5feb\u6377\u952e :nn <Leader>1 1gt :nn <Leader>2 2gt :nn <Leader>3 3gt :nn <Leader>4 4gt :nn <Leader>5 5gt :nn <Leader>6 6gt :nn <Leader>7 7gt :nn <Leader>8 8gt :nn <Leader>9 8gt :nn <Leader>0 :tablast<CR> \"============================================================================== \" GVim \u7684\u914d\u7f6e \"============================================================================== \" \u5982\u679c\u4e0d\u4f7f\u7528 GVim \uff0c\u53ef\u4ee5\u4e0d\u7528\u914d\u7f6e\u4e0b\u9762\u7684\u914d\u7f6e if has('gui_running') colorscheme one \" \u8bbe\u7f6e\u542f\u52a8\u65f6\u7a97\u53e3\u7684\u5927\u5c0f set lines=999 columns=999 linespace=4 \" \u8bbe\u7f6e\u5b57\u4f53\u53ca\u5927\u5c0f set guifont=Roboto\\ Mono\\ 13 set guioptions-=m \" \u9690\u85cf\u83dc\u5355\u680f set guioptions-=T \" \u9690\u85cf\u5de5\u5177\u680f set guioptions-=L \" \u9690\u85cf\u5de6\u4fa7\u6eda\u52a8\u6761 set guioptions-=r \" \u9690\u85cf\u53f3\u4fa7\u6eda\u52a8\u6761 set guioptions-=b \" \u9690\u85cf\u5e95\u90e8\u6eda\u52a8\u6761 \" \u5728 gvim \u4e0b\u4e0d\u4f1a\u548c terminal \u7684 alt+\u6570\u5b57\u7684\u5feb\u6377\u952e\u51b2\u7a81\uff0c \" \u6240\u4ee5\u5c06 tab \u5207\u6362\u914d\u7f6e\u4e00\u4efd alt+\u6570\u5b57\u7684\u5feb\u6377\u952e :nn <M-1> 1gt :nn <M-2> 2gt :nn <M-3> 3gt :nn <M-4> 4gt :nn <M-5> 5gt :nn <M-6> 6gt :nn <M-7> 7gt :nn <M-8> 8gt :nn <M-9> 9gt :nn <M-0> :tablast<CR> endif \"============================================================================== \" \u5149\u6807\u968f\u7740\u63d2\u5165\u6a21\u5f0f\u6539\u53d8\u5f62\u72b6 \" \u53c2\u8003\uff1a https://vim.fandom.com/wiki/Change_cursor_shape_in_different_modes \"============================================================================== if has(\"autocmd\") au VimEnter,InsertLeave * silent execute '!echo -ne \"\\e[2 q\"' | redraw! au InsertEnter,InsertChange * \\ if v:insertmode == 'i' | \\ silent execute '!echo -ne \"\\e[6 q\"' | redraw! | \\ elseif v:insertmode == 'r' | \\ silent execute '!echo -ne \"\\e[4 q\"' | redraw! | \\ endif au VimLeave * silent execute '!echo -ne \"\\e[ q\"' | redraw! endif","title":"\u5176\u4ed6\u63d2\u4ef6"},{"location":"Tools/vim-ide/#_7","text":"","title":"\u9519\u8bef\u5904\u7406"},{"location":"Tools/vim-ide/#_8","text":"\u5f53\u4f7f\u7528 F9 \u7684\u65f6\u5019\uff0c \u51fa\u73b0\u4e0b\u9762\u7684\u9519\u8bef\uff1a Taglist: Exuberant ctags (http://ctags.sf.net) not found in PATH. Plugin is not loaded \u89e3\u51b3\u65b9\u6cd5\uff1a sudo apt install ctags","title":"\u7f3a\u5c11"},{"location":"Tools/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/","text":"\u6b63\u5219\u8868\u8fbe\u5f0f \u8868\u8fbe\u5f0f\u5168\u96c6 \u5b57\u7b26 \u63cf\u8ff0 \\ \u5c06\u4e0b\u4e00\u4e2a\u5b57\u7b26\u6807\u8bb0\u4e3a\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\u3001\u6216\u4e00\u4e2a\u539f\u4e49\u5b57\u7b26\u3001\u6216\u4e00\u4e2a\u5411\u540e\u5f15\u7528\u3001\u6216\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u7b26\u3002\u4f8b\u5982\uff0c\u201c n \u201d\u5339\u914d\u5b57\u7b26\u201c n \u201d\u3002\u201c \\n \u201d\u5339\u914d\u4e00\u4e2a\u6362\u884c\u7b26\u3002\u4e32\u884c\u201c \\\\ \u201d\u5339\u914d\u201c \\ \u201d\u800c\u201c \\( \u201d\u5219\u5339\u914d\u201c ( \u201d\u3002 ^ \u5339\u914d\u8f93\u5165\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u4f4d\u7f6e\u3002\u5982\u679c\u8bbe\u7f6e\u4e86RegExp\u5bf9\u8c61\u7684Multiline\u5c5e\u6027\uff0c^\u4e5f\u5339\u914d\u201c \\n \u201d\u6216\u201c \\r \u201d\u4e4b\u540e\u7684\u4f4d\u7f6e\u3002 $ \u5339\u914d\u8f93\u5165\u5b57\u7b26\u4e32\u7684\u7ed3\u675f\u4f4d\u7f6e\u3002\u5982\u679c\u8bbe\u7f6e\u4e86RegExp\u5bf9\u8c61\u7684Multiline\u5c5e\u6027\uff0c$\u4e5f\u5339\u914d\u201c \\n \u201d\u6216\u201c \\r \u201d\u4e4b\u524d\u7684\u4f4d\u7f6e\u3002 * \u5339\u914d\u524d\u9762\u7684\u5b50\u8868\u8fbe\u5f0f\u96f6\u6b21\u6216\u591a\u6b21\u3002\u4f8b\u5982\uff0czo \u80fd\u5339\u914d\u201c z \u201d\u4ee5\u53ca\u201c zoo \u201d\u3002 \u7b49\u4ef7\u4e8e{0,}\u3002 + \u5339\u914d\u524d\u9762\u7684\u5b50\u8868\u8fbe\u5f0f\u4e00\u6b21\u6216\u591a\u6b21\u3002\u4f8b\u5982\uff0c\u201c zo+ \u201d\u80fd\u5339\u914d\u201c zo \u201d\u4ee5\u53ca\u201c zoo \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c z \u201d\u3002+\u7b49\u4ef7\u4e8e{1,}\u3002 ? \u5339\u914d\u524d\u9762\u7684\u5b50\u8868\u8fbe\u5f0f\u96f6\u6b21\u6216\u4e00\u6b21\u3002\u4f8b\u5982\uff0c\u201c do(es)? \u201d\u53ef\u4ee5\u5339\u914d\u201c does \u201d\u6216\u201c does \u201d\u4e2d\u7684\u201c do \u201d\u3002?\u7b49\u4ef7\u4e8e{0,1}\u3002 { n } n \u662f\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u3002\u5339\u914d\u786e\u5b9a\u7684 n \u6b21\u3002\u4f8b\u5982\uff0c\u201c o{2} \u201d\u4e0d\u80fd\u5339\u914d\u201c Bob \u201d\u4e2d\u7684\u201c o \u201d\uff0c\u4f46\u662f\u80fd\u5339\u914d\u201c food \u201d\u4e2d\u7684\u4e24\u4e2ao\u3002 { n ,} n \u662f\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u3002\u81f3\u5c11\u5339\u914d n \u6b21\u3002\u4f8b\u5982\uff0c\u201c o{2,} \u201d\u4e0d\u80fd\u5339\u914d\u201c Bob \u201d\u4e2d\u7684\u201c o \u201d\uff0c\u4f46\u80fd\u5339\u914d\u201c foooood \u201d\u4e2d\u7684\u6240\u6709o\u3002\u201c o{1,} \u201d\u7b49\u4ef7\u4e8e\u201c o+ \u201d\u3002\u201c o{0,} \u201d\u5219\u7b49\u4ef7\u4e8e\u201c o* \u201d\u3002 { n , m } m \u548c n \u5747\u4e3a\u975e\u8d1f\u6574\u6570\uff0c\u5176\u4e2d n <= m \u3002\u6700\u5c11\u5339\u914d n \u6b21\u4e14\u6700\u591a\u5339\u914d m \u6b21\u3002\u4f8b\u5982\uff0c\u201c o{1,3} \u201d\u5c06\u5339\u914d\u201c fooooood \u201d\u4e2d\u7684\u524d\u4e09\u4e2ao\u3002\u201c o{0,1} \u201d\u7b49\u4ef7\u4e8e\u201c o? \u201d\u3002\u8bf7\u6ce8\u610f\u5728\u9017\u53f7\u548c\u4e24\u4e2a\u6570\u4e4b\u95f4\u4e0d\u80fd\u6709\u7a7a\u683c\u3002 ? \u5f53\u8be5\u5b57\u7b26\u7d27\u8ddf\u5728\u4efb\u4f55\u4e00\u4e2a\u5176\u4ed6\u9650\u5236\u7b26\uff08 ,+,?\uff0c{ n }\uff0c{ n ,}\uff0c{ n , m*}\uff09\u540e\u9762\u65f6\uff0c\u5339\u914d\u6a21\u5f0f\u662f\u975e\u8d2a\u5a6a\u7684\u3002\u975e\u8d2a\u5a6a\u6a21\u5f0f\u5c3d\u53ef\u80fd\u5c11\u7684\u5339\u914d\u6240\u641c\u7d22\u7684\u5b57\u7b26\u4e32\uff0c\u800c\u9ed8\u8ba4\u7684\u8d2a\u5a6a\u6a21\u5f0f\u5219\u5c3d\u53ef\u80fd\u591a\u7684\u5339\u914d\u6240\u641c\u7d22\u7684\u5b57\u7b26\u4e32\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u5b57\u7b26\u4e32\u201c oooo \u201d\uff0c\u201c o+? \u201d\u5c06\u5339\u914d\u5355\u4e2a\u201c o \u201d\uff0c\u800c\u201c o+ \u201d\u5c06\u5339\u914d\u6240\u6709\u201c o \u201d\u3002 . \u5339\u914d\u9664\u201c \\ n \u201d\u4e4b\u5916\u7684\u4efb\u4f55\u5355\u4e2a\u5b57\u7b26\u3002\u8981\u5339\u914d\u5305\u62ec\u201c \\ n \u201d\u5728\u5185\u7684\u4efb\u4f55\u5b57\u7b26\uff0c\u8bf7\u4f7f\u7528\u50cf\u201c (.|\\n) \u201d\u7684\u6a21\u5f0f\u3002 (pattern) \u5339\u914dpattern\u5e76\u83b7\u53d6\u8fd9\u4e00\u5339\u914d\u3002\u6240\u83b7\u53d6\u7684\u5339\u914d\u53ef\u4ee5\u4ece\u4ea7\u751f\u7684Matches\u96c6\u5408\u5f97\u5230\uff0c\u5728VBScript\u4e2d\u4f7f\u7528SubMatches\u96c6\u5408\uff0c\u5728JScript\u4e2d\u5219\u4f7f\u7528$0\u2026$9\u5c5e\u6027\u3002\u8981\u5339\u914d\u5706\u62ec\u53f7\u5b57\u7b26\uff0c\u8bf7\u4f7f\u7528\u201c \\( \u201d\u6216\u201c \\) \u201d\u3002 (?:pattern) \u5339\u914dpattern\u4f46\u4e0d\u83b7\u53d6\u5339\u914d\u7ed3\u679c\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u662f\u4e00\u4e2a\u975e\u83b7\u53d6\u5339\u914d\uff0c\u4e0d\u8fdb\u884c\u5b58\u50a8\u4f9b\u4ee5\u540e\u4f7f\u7528\u3002\u8fd9\u5728\u4f7f\u7528\u6216\u5b57\u7b26\u201c (|) \u201d\u6765\u7ec4\u5408\u4e00\u4e2a\u6a21\u5f0f\u7684\u5404\u4e2a\u90e8\u5206\u662f\u5f88\u6709\u7528\u3002\u4f8b\u5982\u201c industr(?:y|ies) \u201d\u5c31\u662f\u4e00\u4e2a\u6bd4\u201c industry|industries \u201d\u66f4\u7b80\u7565\u7684\u8868\u8fbe\u5f0f\u3002 (?=pattern) \u6b63\u5411\u80af\u5b9a\u9884\u67e5\uff0c\u5728\u4efb\u4f55\u5339\u914dpattern\u7684\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u5339\u914d\u67e5\u627e\u5b57\u7b26\u4e32\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u83b7\u53d6\u5339\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u5339\u914d\u4e0d\u9700\u8981\u83b7\u53d6\u4f9b\u4ee5\u540e\u4f7f\u7528\u3002\u4f8b\u5982\uff0c\u201c Windows(?=95|98|NT|2000) \u201d\u80fd\u5339\u914d\u201c Windows2000 \u201d\u4e2d\u7684\u201c Windows \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c Windows3.1 \u201d\u4e2d\u7684\u201c Windows \u201d\u3002\u9884\u67e5\u4e0d\u6d88\u8017\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u4e00\u4e2a\u5339\u914d\u53d1\u751f\u540e\uff0c\u5728\u6700\u540e\u4e00\u6b21\u5339\u914d\u4e4b\u540e\u7acb\u5373\u5f00\u59cb\u4e0b\u4e00\u6b21\u5339\u914d\u7684\u641c\u7d22\uff0c\u800c\u4e0d\u662f\u4ece\u5305\u542b\u9884\u67e5\u7684\u5b57\u7b26\u4e4b\u540e\u5f00\u59cb\u3002 (?!pattern) \u6b63\u5411\u5426\u5b9a\u9884\u67e5\uff0c\u5728\u4efb\u4f55\u4e0d\u5339\u914dpattern\u7684\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u5339\u914d\u67e5\u627e\u5b57\u7b26\u4e32\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u83b7\u53d6\u5339\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u5339\u914d\u4e0d\u9700\u8981\u83b7\u53d6\u4f9b\u4ee5\u540e\u4f7f\u7528\u3002\u4f8b\u5982\u201c Windows(?!95|98|NT|2000) \u201d\u80fd\u5339\u914d\u201c Windows3.1 \u201d\u4e2d\u7684\u201c Windows \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c Windows2000 \u201d\u4e2d\u7684\u201c Windows \u201d\u3002\u9884\u67e5\u4e0d\u6d88\u8017\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u4e00\u4e2a\u5339\u914d\u53d1\u751f\u540e\uff0c\u5728\u6700\u540e\u4e00\u6b21\u5339\u914d\u4e4b\u540e\u7acb\u5373\u5f00\u59cb\u4e0b\u4e00\u6b21\u5339\u914d\u7684\u641c\u7d22\uff0c\u800c\u4e0d\u662f\u4ece\u5305\u542b\u9884\u67e5\u7684\u5b57\u7b26\u4e4b\u540e\u5f00\u59cb (?<=pattern) \u53cd\u5411\u80af\u5b9a\u9884\u67e5\uff0c\u4e0e\u6b63\u5411\u80af\u5b9a\u9884\u67e5\u7c7b\u62df\uff0c\u53ea\u662f\u65b9\u5411\u76f8\u53cd\u3002\u4f8b\u5982\uff0c\u201c (?<=95|98|NT|2000)Windows \u201d\u80fd\u5339\u914d\u201c 2000Windows \u201d\u4e2d\u7684\u201c Windows \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c 3.1Windows \u201d\u4e2d\u7684\u201c Windows \u201d\u3002 (?<!--pattern) \u53cd\u5411\u5426\u5b9a\u9884\u67e5\uff0c\u4e0e\u6b63\u5411\u5426\u5b9a\u9884\u67e5\u7c7b\u62df\uff0c\u53ea\u662f\u65b9\u5411\u76f8\u53cd\u3002\u4f8b\u5982\u201c (?<!95|98|NT|2000)Windows \u201d\u80fd\u5339\u914d\u201c 3.1Windows \u201d\u4e2d\u7684\u201c Windows \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c 2000Windows \u201d\u4e2d\u7684\u201c Windows \u201d\u3002 x|y \u5339\u914dx\u6216y\u3002\u4f8b\u5982\uff0c\u201c z|food \u201d\u80fd\u5339\u914d\u201c z \u201d\u6216\u201c food \u201d\u3002\u201c (z|f)ood \u201d\u5219\u5339\u914d\u201c zood \u201d\u6216\u201c food \u201d\u3002 [xyz] \u5b57\u7b26\u96c6\u5408\u3002\u5339\u914d\u6240\u5305\u542b\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c [abc] \u201d\u53ef\u4ee5\u5339\u914d\u201c plain \u201d\u4e2d\u7684\u201c a \u201d\u3002 [^xyz] \u8d1f\u503c\u5b57\u7b26\u96c6\u5408\u3002\u5339\u914d\u672a\u5305\u542b\u7684\u4efb\u610f\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c [^abc] \u201d\u53ef\u4ee5\u5339\u914d\u201c plain \u201d\u4e2d\u7684\u201c p \u201d\u3002 [a-z] \u5b57\u7b26\u8303\u56f4\u3002\u5339\u914d\u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c [a-z] \u201d\u53ef\u4ee5\u5339\u914d\u201c a \u201d\u5230\u201c z \u201d\u8303\u56f4\u5185\u7684\u4efb\u610f\u5c0f\u5199\u5b57\u6bcd\u5b57\u7b26\u3002 [^a-z] \u8d1f\u503c\u5b57\u7b26\u8303\u56f4\u3002\u5339\u914d\u4efb\u4f55\u4e0d\u5728\u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c [^a-z] \u201d\u53ef\u4ee5\u5339\u914d\u4efb\u4f55\u4e0d\u5728\u201c a \u201d\u5230\u201c z \u201d\u8303\u56f4\u5185\u7684\u4efb\u610f\u5b57\u7b26\u3002 \\b \u5339\u914d\u4e00\u4e2a\u5355\u8bcd\u8fb9\u754c\uff0c\u4e5f\u5c31\u662f\u6307\u5355\u8bcd\u548c\u7a7a\u683c\u95f4\u7684\u4f4d\u7f6e\u3002\u4f8b\u5982\uff0c\u201c er\\b \u201d\u53ef\u4ee5\u5339\u914d\u201c never \u201d\u4e2d\u7684\u201c er \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c verb \u201d\u4e2d\u7684\u201c er \u201d\u3002 \\B \u5339\u914d\u975e\u5355\u8bcd\u8fb9\u754c\u3002\u201c er\\B \u201d\u80fd\u5339\u914d\u201c verb \u201d\u4e2d\u7684\u201c er \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c never \u201d\u4e2d\u7684\u201c er \u201d\u3002 \\cx \u5339\u914d\u7531x\u6307\u660e\u7684\u63a7\u5236\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\\cM\u5339\u914d\u4e00\u4e2aControl-M\u6216\u56de\u8f66\u7b26\u3002x\u7684\u503c\u5fc5\u987b\u4e3aA-Z\u6216a-z\u4e4b\u4e00\u3002\u5426\u5219\uff0c\u5c06c\u89c6\u4e3a\u4e00\u4e2a\u539f\u4e49\u7684\u201c c \u201d\u5b57\u7b26\u3002 \\d \u5339\u914d\u4e00\u4e2a\u6570\u5b57\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e[0-9]\u3002 \\D \u5339\u914d\u4e00\u4e2a\u975e\u6570\u5b57\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e[^0-9]\u3002 \\f \u5339\u914d\u4e00\u4e2a\u6362\u9875\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0c\u548c\\cL\u3002 \\n \u5339\u914d\u4e00\u4e2a\u6362\u884c\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0a\u548c\\cJ\u3002 \\r \u5339\u914d\u4e00\u4e2a\u56de\u8f66\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0d\u548c\\cM\u3002 \\s \u5339\u914d\u4efb\u4f55\u7a7a\u767d\u5b57\u7b26\uff0c\u5305\u62ec\u7a7a\u683c\u3001\u5236\u8868\u7b26\u3001\u6362\u9875\u7b26\u7b49\u7b49\u3002\u7b49\u4ef7\u4e8e[ \\f\\n\\r\\t\\v]\u3002 \\S \u5339\u914d\u4efb\u4f55\u975e\u7a7a\u767d\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e[^ \\f\\n\\r\\t\\v]\u3002 \\t \u5339\u914d\u4e00\u4e2a\u5236\u8868\u7b26\u3002\u7b49\u4ef7\u4e8e\\x09\u548c\\cI\u3002 \\v \u5339\u914d\u4e00\u4e2a\u5782\u76f4\u5236\u8868\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0b\u548c\\cK\u3002 \\w \u5339\u914d\u5305\u62ec\u4e0b\u5212\u7ebf\u7684\u4efb\u4f55\u5355\u8bcd\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e\u201c [A-Za-z0-9_] \u201d\u3002 \\W \u5339\u914d\u4efb\u4f55\u975e\u5355\u8bcd\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e\u201c [^A-Za-z0-9_] \u201d\u3002 \\x n \u5339\u914d n \uff0c\u5176\u4e2d n \u4e3a\u5341\u516d\u8fdb\u5236\u8f6c\u4e49\u503c\u3002\u5341\u516d\u8fdb\u5236\u8f6c\u4e49\u503c\u5fc5\u987b\u4e3a\u786e\u5b9a\u7684\u4e24\u4e2a\u6570\u5b57\u957f\u3002\u4f8b\u5982\uff0c\u201c \\x41 \u201d\u5339\u914d\u201c A \u201d\u3002\u201c \\x041 \u201d\u5219\u7b49\u4ef7\u4e8e\u201c \\x04&1 \u201d\u3002\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u53ef\u4ee5\u4f7f\u7528ASCII\u7f16\u7801\u3002. *num* \u5339\u914d num \uff0c\u5176\u4e2d num \u662f\u4e00\u4e2a\u6b63\u6574\u6570\u3002\u5bf9\u6240\u83b7\u53d6\u7684\u5339\u914d\u7684\u5f15\u7528\u3002\u4f8b\u5982\uff0c\u201c (.)\\1 \u201d\u5339\u914d\u4e24\u4e2a\u8fde\u7eed\u7684\u76f8\u540c\u5b57\u7b26\u3002 *n* \u6807\u8bc6\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u503c\u6216\u4e00\u4e2a\u5411\u540e\u5f15\u7528\u3002\u5982\u679c*n \u4e4b\u524d\u81f3\u5c11 n \u4e2a\u83b7\u53d6\u7684\u5b50\u8868\u8fbe\u5f0f\uff0c\u5219 n \u4e3a\u5411\u540e\u5f15\u7528\u3002\u5426\u5219\uff0c\u5982\u679c n \u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-7\uff09\uff0c\u5219 n*\u4e3a\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u503c\u3002 *nm* \u6807\u8bc6\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u503c\u6216\u4e00\u4e2a\u5411\u540e\u5f15\u7528\u3002\u5982\u679c*nm \u4e4b\u524d\u81f3\u5c11\u6709 nm \u4e2a\u83b7\u5f97\u5b50\u8868\u8fbe\u5f0f\uff0c\u5219 nm \u4e3a\u5411\u540e\u5f15\u7528\u3002\u5982\u679c*nm \u4e4b\u524d\u81f3\u5c11\u6709 n \u4e2a\u83b7\u53d6\uff0c\u5219 n \u4e3a\u4e00\u4e2a\u540e\u8ddf\u6587\u5b57 m \u7684\u5411\u540e\u5f15\u7528\u3002\u5982\u679c\u524d\u9762\u7684\u6761\u4ef6\u90fd\u4e0d\u6ee1\u8db3\uff0c\u82e5 n \u548c m \u5747\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-7\uff09\uff0c\u5219*nm \u5c06\u5339\u914d\u516b\u8fdb\u5236\u8f6c\u4e49\u503c nm*\u3002 *nml* \u5982\u679c n \u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-3\uff09\uff0c\u4e14 m\u548cl \u5747\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-7\uff09\uff0c\u5219\u5339\u914d\u516b\u8fdb\u5236\u8f6c\u4e49\u503c nm l\u3002 \\u n \u5339\u914d n \uff0c\u5176\u4e2d n \u662f\u4e00\u4e2a\u7528\u56db\u4e2a\u5341\u516d\u8fdb\u5236\u6570\u5b57\u8868\u793a\u7684Unicode\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\\u00A9\u5339\u914d\u7248\u6743\u7b26\u53f7\uff08\u00a9\uff09\u3002 \u5e38\u7528\u6b63\u5219\u8868\u8fbe\u5f0f \u7528\u6237\u540d /^[a-z0-9_-]{3,16}$/ \u5bc6\u7801 /^[a-z0-9_-]{6,18}$/ \u5341\u516d\u8fdb\u5236\u503c /^#?([a-f0-9]{6}|[a-f0-9]{3})$/ \u7535\u5b50\u90ae\u7bb1 /^([a-z0-9_.-]+)@([\\da-z.-]+).([a-z.]{2,6})$/ /^[a-z\\d]+(.[a-z\\d]+)*@( \\da-z ?)+(.{1,2}[a-z]+)+$/ URL /^(https?:\\/\\/)?([\\da-z.-]+).([a-z.]{2,6})([\\/\\w .-] ) \\/?$/ IP \u5730\u5740 /((2[0-4]\\d|25[0-5]|[01]?\\d\\d?).){3}(2[0-4]\\d|25[0-5]|[01]?\\d\\d?)/ /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/ HTML \u6807\u7b7e /^<([a-z]+)([^<]+) (?:-->(. )<\\/\\1>|\\s+\\/>)$/ \u5220\u9664\u4ee3\u7801\\\u6ce8\u91ca (?<!http:|\\S)//.*$ Unicode\u7f16\u7801\u4e2d\u7684\u6c49\u5b57\u8303\u56f4 /^[\\u2E80-\\u9FFF]+$/","title":"\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"Tools/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_1","text":"","title":"\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"Tools/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_2","text":"\u5b57\u7b26 \u63cf\u8ff0 \\ \u5c06\u4e0b\u4e00\u4e2a\u5b57\u7b26\u6807\u8bb0\u4e3a\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\u3001\u6216\u4e00\u4e2a\u539f\u4e49\u5b57\u7b26\u3001\u6216\u4e00\u4e2a\u5411\u540e\u5f15\u7528\u3001\u6216\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u7b26\u3002\u4f8b\u5982\uff0c\u201c n \u201d\u5339\u914d\u5b57\u7b26\u201c n \u201d\u3002\u201c \\n \u201d\u5339\u914d\u4e00\u4e2a\u6362\u884c\u7b26\u3002\u4e32\u884c\u201c \\\\ \u201d\u5339\u914d\u201c \\ \u201d\u800c\u201c \\( \u201d\u5219\u5339\u914d\u201c ( \u201d\u3002 ^ \u5339\u914d\u8f93\u5165\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u4f4d\u7f6e\u3002\u5982\u679c\u8bbe\u7f6e\u4e86RegExp\u5bf9\u8c61\u7684Multiline\u5c5e\u6027\uff0c^\u4e5f\u5339\u914d\u201c \\n \u201d\u6216\u201c \\r \u201d\u4e4b\u540e\u7684\u4f4d\u7f6e\u3002 $ \u5339\u914d\u8f93\u5165\u5b57\u7b26\u4e32\u7684\u7ed3\u675f\u4f4d\u7f6e\u3002\u5982\u679c\u8bbe\u7f6e\u4e86RegExp\u5bf9\u8c61\u7684Multiline\u5c5e\u6027\uff0c$\u4e5f\u5339\u914d\u201c \\n \u201d\u6216\u201c \\r \u201d\u4e4b\u524d\u7684\u4f4d\u7f6e\u3002 * \u5339\u914d\u524d\u9762\u7684\u5b50\u8868\u8fbe\u5f0f\u96f6\u6b21\u6216\u591a\u6b21\u3002\u4f8b\u5982\uff0czo \u80fd\u5339\u914d\u201c z \u201d\u4ee5\u53ca\u201c zoo \u201d\u3002 \u7b49\u4ef7\u4e8e{0,}\u3002 + \u5339\u914d\u524d\u9762\u7684\u5b50\u8868\u8fbe\u5f0f\u4e00\u6b21\u6216\u591a\u6b21\u3002\u4f8b\u5982\uff0c\u201c zo+ \u201d\u80fd\u5339\u914d\u201c zo \u201d\u4ee5\u53ca\u201c zoo \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c z \u201d\u3002+\u7b49\u4ef7\u4e8e{1,}\u3002 ? \u5339\u914d\u524d\u9762\u7684\u5b50\u8868\u8fbe\u5f0f\u96f6\u6b21\u6216\u4e00\u6b21\u3002\u4f8b\u5982\uff0c\u201c do(es)? \u201d\u53ef\u4ee5\u5339\u914d\u201c does \u201d\u6216\u201c does \u201d\u4e2d\u7684\u201c do \u201d\u3002?\u7b49\u4ef7\u4e8e{0,1}\u3002 { n } n \u662f\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u3002\u5339\u914d\u786e\u5b9a\u7684 n \u6b21\u3002\u4f8b\u5982\uff0c\u201c o{2} \u201d\u4e0d\u80fd\u5339\u914d\u201c Bob \u201d\u4e2d\u7684\u201c o \u201d\uff0c\u4f46\u662f\u80fd\u5339\u914d\u201c food \u201d\u4e2d\u7684\u4e24\u4e2ao\u3002 { n ,} n \u662f\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u3002\u81f3\u5c11\u5339\u914d n \u6b21\u3002\u4f8b\u5982\uff0c\u201c o{2,} \u201d\u4e0d\u80fd\u5339\u914d\u201c Bob \u201d\u4e2d\u7684\u201c o \u201d\uff0c\u4f46\u80fd\u5339\u914d\u201c foooood \u201d\u4e2d\u7684\u6240\u6709o\u3002\u201c o{1,} \u201d\u7b49\u4ef7\u4e8e\u201c o+ \u201d\u3002\u201c o{0,} \u201d\u5219\u7b49\u4ef7\u4e8e\u201c o* \u201d\u3002 { n , m } m \u548c n \u5747\u4e3a\u975e\u8d1f\u6574\u6570\uff0c\u5176\u4e2d n <= m \u3002\u6700\u5c11\u5339\u914d n \u6b21\u4e14\u6700\u591a\u5339\u914d m \u6b21\u3002\u4f8b\u5982\uff0c\u201c o{1,3} \u201d\u5c06\u5339\u914d\u201c fooooood \u201d\u4e2d\u7684\u524d\u4e09\u4e2ao\u3002\u201c o{0,1} \u201d\u7b49\u4ef7\u4e8e\u201c o? \u201d\u3002\u8bf7\u6ce8\u610f\u5728\u9017\u53f7\u548c\u4e24\u4e2a\u6570\u4e4b\u95f4\u4e0d\u80fd\u6709\u7a7a\u683c\u3002 ? \u5f53\u8be5\u5b57\u7b26\u7d27\u8ddf\u5728\u4efb\u4f55\u4e00\u4e2a\u5176\u4ed6\u9650\u5236\u7b26\uff08 ,+,?\uff0c{ n }\uff0c{ n ,}\uff0c{ n , m*}\uff09\u540e\u9762\u65f6\uff0c\u5339\u914d\u6a21\u5f0f\u662f\u975e\u8d2a\u5a6a\u7684\u3002\u975e\u8d2a\u5a6a\u6a21\u5f0f\u5c3d\u53ef\u80fd\u5c11\u7684\u5339\u914d\u6240\u641c\u7d22\u7684\u5b57\u7b26\u4e32\uff0c\u800c\u9ed8\u8ba4\u7684\u8d2a\u5a6a\u6a21\u5f0f\u5219\u5c3d\u53ef\u80fd\u591a\u7684\u5339\u914d\u6240\u641c\u7d22\u7684\u5b57\u7b26\u4e32\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u5b57\u7b26\u4e32\u201c oooo \u201d\uff0c\u201c o+? \u201d\u5c06\u5339\u914d\u5355\u4e2a\u201c o \u201d\uff0c\u800c\u201c o+ \u201d\u5c06\u5339\u914d\u6240\u6709\u201c o \u201d\u3002 . \u5339\u914d\u9664\u201c \\ n \u201d\u4e4b\u5916\u7684\u4efb\u4f55\u5355\u4e2a\u5b57\u7b26\u3002\u8981\u5339\u914d\u5305\u62ec\u201c \\ n \u201d\u5728\u5185\u7684\u4efb\u4f55\u5b57\u7b26\uff0c\u8bf7\u4f7f\u7528\u50cf\u201c (.|\\n) \u201d\u7684\u6a21\u5f0f\u3002 (pattern) \u5339\u914dpattern\u5e76\u83b7\u53d6\u8fd9\u4e00\u5339\u914d\u3002\u6240\u83b7\u53d6\u7684\u5339\u914d\u53ef\u4ee5\u4ece\u4ea7\u751f\u7684Matches\u96c6\u5408\u5f97\u5230\uff0c\u5728VBScript\u4e2d\u4f7f\u7528SubMatches\u96c6\u5408\uff0c\u5728JScript\u4e2d\u5219\u4f7f\u7528$0\u2026$9\u5c5e\u6027\u3002\u8981\u5339\u914d\u5706\u62ec\u53f7\u5b57\u7b26\uff0c\u8bf7\u4f7f\u7528\u201c \\( \u201d\u6216\u201c \\) \u201d\u3002 (?:pattern) \u5339\u914dpattern\u4f46\u4e0d\u83b7\u53d6\u5339\u914d\u7ed3\u679c\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u662f\u4e00\u4e2a\u975e\u83b7\u53d6\u5339\u914d\uff0c\u4e0d\u8fdb\u884c\u5b58\u50a8\u4f9b\u4ee5\u540e\u4f7f\u7528\u3002\u8fd9\u5728\u4f7f\u7528\u6216\u5b57\u7b26\u201c (|) \u201d\u6765\u7ec4\u5408\u4e00\u4e2a\u6a21\u5f0f\u7684\u5404\u4e2a\u90e8\u5206\u662f\u5f88\u6709\u7528\u3002\u4f8b\u5982\u201c industr(?:y|ies) \u201d\u5c31\u662f\u4e00\u4e2a\u6bd4\u201c industry|industries \u201d\u66f4\u7b80\u7565\u7684\u8868\u8fbe\u5f0f\u3002 (?=pattern) \u6b63\u5411\u80af\u5b9a\u9884\u67e5\uff0c\u5728\u4efb\u4f55\u5339\u914dpattern\u7684\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u5339\u914d\u67e5\u627e\u5b57\u7b26\u4e32\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u83b7\u53d6\u5339\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u5339\u914d\u4e0d\u9700\u8981\u83b7\u53d6\u4f9b\u4ee5\u540e\u4f7f\u7528\u3002\u4f8b\u5982\uff0c\u201c Windows(?=95|98|NT|2000) \u201d\u80fd\u5339\u914d\u201c Windows2000 \u201d\u4e2d\u7684\u201c Windows \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c Windows3.1 \u201d\u4e2d\u7684\u201c Windows \u201d\u3002\u9884\u67e5\u4e0d\u6d88\u8017\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u4e00\u4e2a\u5339\u914d\u53d1\u751f\u540e\uff0c\u5728\u6700\u540e\u4e00\u6b21\u5339\u914d\u4e4b\u540e\u7acb\u5373\u5f00\u59cb\u4e0b\u4e00\u6b21\u5339\u914d\u7684\u641c\u7d22\uff0c\u800c\u4e0d\u662f\u4ece\u5305\u542b\u9884\u67e5\u7684\u5b57\u7b26\u4e4b\u540e\u5f00\u59cb\u3002 (?!pattern) \u6b63\u5411\u5426\u5b9a\u9884\u67e5\uff0c\u5728\u4efb\u4f55\u4e0d\u5339\u914dpattern\u7684\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u5339\u914d\u67e5\u627e\u5b57\u7b26\u4e32\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u83b7\u53d6\u5339\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u5339\u914d\u4e0d\u9700\u8981\u83b7\u53d6\u4f9b\u4ee5\u540e\u4f7f\u7528\u3002\u4f8b\u5982\u201c Windows(?!95|98|NT|2000) \u201d\u80fd\u5339\u914d\u201c Windows3.1 \u201d\u4e2d\u7684\u201c Windows \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c Windows2000 \u201d\u4e2d\u7684\u201c Windows \u201d\u3002\u9884\u67e5\u4e0d\u6d88\u8017\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u4e00\u4e2a\u5339\u914d\u53d1\u751f\u540e\uff0c\u5728\u6700\u540e\u4e00\u6b21\u5339\u914d\u4e4b\u540e\u7acb\u5373\u5f00\u59cb\u4e0b\u4e00\u6b21\u5339\u914d\u7684\u641c\u7d22\uff0c\u800c\u4e0d\u662f\u4ece\u5305\u542b\u9884\u67e5\u7684\u5b57\u7b26\u4e4b\u540e\u5f00\u59cb (?<=pattern) \u53cd\u5411\u80af\u5b9a\u9884\u67e5\uff0c\u4e0e\u6b63\u5411\u80af\u5b9a\u9884\u67e5\u7c7b\u62df\uff0c\u53ea\u662f\u65b9\u5411\u76f8\u53cd\u3002\u4f8b\u5982\uff0c\u201c (?<=95|98|NT|2000)Windows \u201d\u80fd\u5339\u914d\u201c 2000Windows \u201d\u4e2d\u7684\u201c Windows \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c 3.1Windows \u201d\u4e2d\u7684\u201c Windows \u201d\u3002 (?<!--pattern) \u53cd\u5411\u5426\u5b9a\u9884\u67e5\uff0c\u4e0e\u6b63\u5411\u5426\u5b9a\u9884\u67e5\u7c7b\u62df\uff0c\u53ea\u662f\u65b9\u5411\u76f8\u53cd\u3002\u4f8b\u5982\u201c (?<!95|98|NT|2000)Windows \u201d\u80fd\u5339\u914d\u201c 3.1Windows \u201d\u4e2d\u7684\u201c Windows \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c 2000Windows \u201d\u4e2d\u7684\u201c Windows \u201d\u3002 x|y \u5339\u914dx\u6216y\u3002\u4f8b\u5982\uff0c\u201c z|food \u201d\u80fd\u5339\u914d\u201c z \u201d\u6216\u201c food \u201d\u3002\u201c (z|f)ood \u201d\u5219\u5339\u914d\u201c zood \u201d\u6216\u201c food \u201d\u3002 [xyz] \u5b57\u7b26\u96c6\u5408\u3002\u5339\u914d\u6240\u5305\u542b\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c [abc] \u201d\u53ef\u4ee5\u5339\u914d\u201c plain \u201d\u4e2d\u7684\u201c a \u201d\u3002 [^xyz] \u8d1f\u503c\u5b57\u7b26\u96c6\u5408\u3002\u5339\u914d\u672a\u5305\u542b\u7684\u4efb\u610f\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c [^abc] \u201d\u53ef\u4ee5\u5339\u914d\u201c plain \u201d\u4e2d\u7684\u201c p \u201d\u3002 [a-z] \u5b57\u7b26\u8303\u56f4\u3002\u5339\u914d\u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c [a-z] \u201d\u53ef\u4ee5\u5339\u914d\u201c a \u201d\u5230\u201c z \u201d\u8303\u56f4\u5185\u7684\u4efb\u610f\u5c0f\u5199\u5b57\u6bcd\u5b57\u7b26\u3002 [^a-z] \u8d1f\u503c\u5b57\u7b26\u8303\u56f4\u3002\u5339\u914d\u4efb\u4f55\u4e0d\u5728\u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u201c [^a-z] \u201d\u53ef\u4ee5\u5339\u914d\u4efb\u4f55\u4e0d\u5728\u201c a \u201d\u5230\u201c z \u201d\u8303\u56f4\u5185\u7684\u4efb\u610f\u5b57\u7b26\u3002 \\b \u5339\u914d\u4e00\u4e2a\u5355\u8bcd\u8fb9\u754c\uff0c\u4e5f\u5c31\u662f\u6307\u5355\u8bcd\u548c\u7a7a\u683c\u95f4\u7684\u4f4d\u7f6e\u3002\u4f8b\u5982\uff0c\u201c er\\b \u201d\u53ef\u4ee5\u5339\u914d\u201c never \u201d\u4e2d\u7684\u201c er \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c verb \u201d\u4e2d\u7684\u201c er \u201d\u3002 \\B \u5339\u914d\u975e\u5355\u8bcd\u8fb9\u754c\u3002\u201c er\\B \u201d\u80fd\u5339\u914d\u201c verb \u201d\u4e2d\u7684\u201c er \u201d\uff0c\u4f46\u4e0d\u80fd\u5339\u914d\u201c never \u201d\u4e2d\u7684\u201c er \u201d\u3002 \\cx \u5339\u914d\u7531x\u6307\u660e\u7684\u63a7\u5236\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\\cM\u5339\u914d\u4e00\u4e2aControl-M\u6216\u56de\u8f66\u7b26\u3002x\u7684\u503c\u5fc5\u987b\u4e3aA-Z\u6216a-z\u4e4b\u4e00\u3002\u5426\u5219\uff0c\u5c06c\u89c6\u4e3a\u4e00\u4e2a\u539f\u4e49\u7684\u201c c \u201d\u5b57\u7b26\u3002 \\d \u5339\u914d\u4e00\u4e2a\u6570\u5b57\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e[0-9]\u3002 \\D \u5339\u914d\u4e00\u4e2a\u975e\u6570\u5b57\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e[^0-9]\u3002 \\f \u5339\u914d\u4e00\u4e2a\u6362\u9875\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0c\u548c\\cL\u3002 \\n \u5339\u914d\u4e00\u4e2a\u6362\u884c\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0a\u548c\\cJ\u3002 \\r \u5339\u914d\u4e00\u4e2a\u56de\u8f66\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0d\u548c\\cM\u3002 \\s \u5339\u914d\u4efb\u4f55\u7a7a\u767d\u5b57\u7b26\uff0c\u5305\u62ec\u7a7a\u683c\u3001\u5236\u8868\u7b26\u3001\u6362\u9875\u7b26\u7b49\u7b49\u3002\u7b49\u4ef7\u4e8e[ \\f\\n\\r\\t\\v]\u3002 \\S \u5339\u914d\u4efb\u4f55\u975e\u7a7a\u767d\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e[^ \\f\\n\\r\\t\\v]\u3002 \\t \u5339\u914d\u4e00\u4e2a\u5236\u8868\u7b26\u3002\u7b49\u4ef7\u4e8e\\x09\u548c\\cI\u3002 \\v \u5339\u914d\u4e00\u4e2a\u5782\u76f4\u5236\u8868\u7b26\u3002\u7b49\u4ef7\u4e8e\\x0b\u548c\\cK\u3002 \\w \u5339\u914d\u5305\u62ec\u4e0b\u5212\u7ebf\u7684\u4efb\u4f55\u5355\u8bcd\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e\u201c [A-Za-z0-9_] \u201d\u3002 \\W \u5339\u914d\u4efb\u4f55\u975e\u5355\u8bcd\u5b57\u7b26\u3002\u7b49\u4ef7\u4e8e\u201c [^A-Za-z0-9_] \u201d\u3002 \\x n \u5339\u914d n \uff0c\u5176\u4e2d n \u4e3a\u5341\u516d\u8fdb\u5236\u8f6c\u4e49\u503c\u3002\u5341\u516d\u8fdb\u5236\u8f6c\u4e49\u503c\u5fc5\u987b\u4e3a\u786e\u5b9a\u7684\u4e24\u4e2a\u6570\u5b57\u957f\u3002\u4f8b\u5982\uff0c\u201c \\x41 \u201d\u5339\u914d\u201c A \u201d\u3002\u201c \\x041 \u201d\u5219\u7b49\u4ef7\u4e8e\u201c \\x04&1 \u201d\u3002\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u53ef\u4ee5\u4f7f\u7528ASCII\u7f16\u7801\u3002. *num* \u5339\u914d num \uff0c\u5176\u4e2d num \u662f\u4e00\u4e2a\u6b63\u6574\u6570\u3002\u5bf9\u6240\u83b7\u53d6\u7684\u5339\u914d\u7684\u5f15\u7528\u3002\u4f8b\u5982\uff0c\u201c (.)\\1 \u201d\u5339\u914d\u4e24\u4e2a\u8fde\u7eed\u7684\u76f8\u540c\u5b57\u7b26\u3002 *n* \u6807\u8bc6\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u503c\u6216\u4e00\u4e2a\u5411\u540e\u5f15\u7528\u3002\u5982\u679c*n \u4e4b\u524d\u81f3\u5c11 n \u4e2a\u83b7\u53d6\u7684\u5b50\u8868\u8fbe\u5f0f\uff0c\u5219 n \u4e3a\u5411\u540e\u5f15\u7528\u3002\u5426\u5219\uff0c\u5982\u679c n \u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-7\uff09\uff0c\u5219 n*\u4e3a\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u503c\u3002 *nm* \u6807\u8bc6\u4e00\u4e2a\u516b\u8fdb\u5236\u8f6c\u4e49\u503c\u6216\u4e00\u4e2a\u5411\u540e\u5f15\u7528\u3002\u5982\u679c*nm \u4e4b\u524d\u81f3\u5c11\u6709 nm \u4e2a\u83b7\u5f97\u5b50\u8868\u8fbe\u5f0f\uff0c\u5219 nm \u4e3a\u5411\u540e\u5f15\u7528\u3002\u5982\u679c*nm \u4e4b\u524d\u81f3\u5c11\u6709 n \u4e2a\u83b7\u53d6\uff0c\u5219 n \u4e3a\u4e00\u4e2a\u540e\u8ddf\u6587\u5b57 m \u7684\u5411\u540e\u5f15\u7528\u3002\u5982\u679c\u524d\u9762\u7684\u6761\u4ef6\u90fd\u4e0d\u6ee1\u8db3\uff0c\u82e5 n \u548c m \u5747\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-7\uff09\uff0c\u5219*nm \u5c06\u5339\u914d\u516b\u8fdb\u5236\u8f6c\u4e49\u503c nm*\u3002 *nml* \u5982\u679c n \u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-3\uff09\uff0c\u4e14 m\u548cl \u5747\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\uff080-7\uff09\uff0c\u5219\u5339\u914d\u516b\u8fdb\u5236\u8f6c\u4e49\u503c nm l\u3002 \\u n \u5339\u914d n \uff0c\u5176\u4e2d n \u662f\u4e00\u4e2a\u7528\u56db\u4e2a\u5341\u516d\u8fdb\u5236\u6570\u5b57\u8868\u793a\u7684Unicode\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\\u00A9\u5339\u914d\u7248\u6743\u7b26\u53f7\uff08\u00a9\uff09\u3002","title":"\u8868\u8fbe\u5f0f\u5168\u96c6"},{"location":"Tools/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_3","text":"\u7528\u6237\u540d /^[a-z0-9_-]{3,16}$/ \u5bc6\u7801 /^[a-z0-9_-]{6,18}$/ \u5341\u516d\u8fdb\u5236\u503c /^#?([a-f0-9]{6}|[a-f0-9]{3})$/ \u7535\u5b50\u90ae\u7bb1 /^([a-z0-9_.-]+)@([\\da-z.-]+).([a-z.]{2,6})$/ /^[a-z\\d]+(.[a-z\\d]+)*@( \\da-z ?)+(.{1,2}[a-z]+)+$/ URL /^(https?:\\/\\/)?([\\da-z.-]+).([a-z.]{2,6})([\\/\\w .-] ) \\/?$/ IP \u5730\u5740 /((2[0-4]\\d|25[0-5]|[01]?\\d\\d?).){3}(2[0-4]\\d|25[0-5]|[01]?\\d\\d?)/ /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/ HTML \u6807\u7b7e /^<([a-z]+)([^<]+) (?:-->(. )<\\/\\1>|\\s+\\/>)$/ \u5220\u9664\u4ee3\u7801\\\u6ce8\u91ca (?<!http:|\\S)//.*$ Unicode\u7f16\u7801\u4e2d\u7684\u6c49\u5b57\u8303\u56f4 /^[\\u2E80-\\u9FFF]+$/","title":"\u5e38\u7528\u6b63\u5219\u8868\u8fbe\u5f0f"}]}